issue_num,datetime,body,login,mention_login
1052,2017-03-27 19:00:41,"@chtrinh I **waited already after click on submit for new element on page**

> or better yet just wait for each field before your type()

Not relevant to the issue
",mymtwcom,chtrinh
1052,2017-03-27 20:38:51,"What @rosshinkley said might be the issue.

> I waited already after click on submit for new element on page

@mymtwcom: Is the form async loaded? That is what i was referring to. DOM elements might not be settled and you need to wait for it. 

",chtrinh,mymtwcom
1052,2017-03-27 20:38:51,"What @rosshinkley said might be the issue.

> I waited already after click on submit for new element on page

@mymtwcom: Is the form async loaded? That is what i was referring to. DOM elements might not be settled and you need to wait for it. 

",chtrinh,rosshinkley
1052,2017-03-27 21:54:50,"@rosshinkley yes, I used `show: true`. I used asserts that to know, that I'm currently on page that I need.
`CAPTCHA`: No there no was captcha, cuz I used `show: true` that to make sure.
read again plz my **problem** from issue:

I'm clicking button continue, after which I should be
 redirected, **this works sometimes, but sometimes I see** next **error**

Maybe my code will help to anybody reproduce the issue, there are used temporary proxy server also(I will disable him if issue will be reproduced).

code: 
",mymtwcom,rosshinkley
1052,2017-03-27 21:56:03,@chtrinh trouble not in registration form. Trouble with waiting for new page DOM loading,mymtwcom,chtrinh
1052,2017-03-27 23:23:36,"@mymtwcom: again... `.wait('#ap_customer_name')` sometimes your form will load before you execute `type()`and since `type()` doesn't raise an exception you'll just hit `.wait('.nav-line-1')` and timeout. Nowhere in the code snippet are you waiting for the `<form>` to be load on the DOM. 

So sometimes you get lucky and sometimes you don't and your test fails.. which is the behavior you are seeing. 
",chtrinh,mymtwcom
1050,2017-03-27 18:50:22,"@sbacic: good find, didn't know about that option",chtrinh,sbacic
1049,2017-03-22 14:59:56,Thanks @iget-master - I got a different direction to solve the issue.,Vineeth-Mohan,iget-master
1045,2017-03-15 19:29:32,@iget-esoares As documented [here](https://github.com/electron/electron/blob/master/docs/api/app.md#appgetpathname) there are both `home` and `appData` valid values for the paths option.  From the error you provided - `Error: Failed to get 'appData' path` - it seems like you might need to set that `appData` value in addition/instead of `home`.,johnferro,iget-esoares
1045,2017-03-15 19:36:39,"@johnferro I've tried both. My current -attempt- script now is:



",iget-esoares,johnferro
1045,2017-03-15 20:42:26,@iget-esoares Here's an [issue](https://github.com/electron/electron/pull/5237) to be aware of. I would think judging by that fix the initialization wouldn't be an issue but not 100% sure about that. Have you tried also explicitly setting the `userData` value to something else?,johnferro,iget-esoares
1042,2017-03-15 10:02:11,"hi  @entrptaher,

Thanks for your reply. Actually, the source code is to simplify the path. The thing is the script is able to load but get some issue with 'nightmare' which is inside the 

Any other idea, thanks.",nquoctuan,entrptaher
1042,2017-03-15 19:19:42,"I'm going to second @entrptaher's solution.  The preload option gets passed as an option to the initialization of electron's browser window.  As documented [here](https://github.com/electron/electron/blob/master/docs/api/browser-window.md#new-browserwindowoptions): ""The value should be the absolute file path to the script.""  While it may appear that the script is loading properly because the error is showing up in the electron console, no script is getting loaded which breaks nightmare since it is requiring those two lines of preload script.",johnferro,entrptaher
1029,2017-03-17 04:22:16,"#1024 is different, for what it's worth: that's talking about a child window.  Popups are, for now, not going to work (unless you create the windows yourself, like with `nightmare-window-manager`).  See #593.

Memory serving, partitioning has never worked particularly reliably, but I _thought_ that in your case @entrptaher that the `browser1` instance had to end to write the session to disk to then consequently get picked up by `browser2`?  Also, what, exactly, would be getting persisted?  The login cookie?",rosshinkley,entrptaher
1021,2017-02-27 01:46:03,"@louisscruz I'm just curious - what happens if you use different partitions? In your code, e.g.:



Would this consume more memory, or will it actually cause some speed up due to a separation of shared storages?",jekku,louisscruz
1021,2017-02-27 06:58:46,@jekku When the partition name doesn't match the partition name of the initial login instance it can't proceed.,louisscruz,jekku
1021,2017-02-28 20:16:33,@LeMoussel Here's my project: https://github.com/louisscruz/hub-crawl,louisscruz,LeMoussel
1021,2017-02-28 20:17:01,@rosshinkley Thanks for that! I'll give that a shot later today.,louisscruz,rosshinkley
1021,2017-03-01 04:37:36,"@rosshinkley Wow, your `nightmare-download-manager` did it! It no longer hangs with the `ignoreDownloads: true`.

There is still a drastic slowdown in performance throughout my crawler's run. With 24 workers, my last run, which was about 10 minutes long, started around 240 links per minute and ended at 110 links per minute. I'm curious how the shared session/partition affects this.

Anyways, my original issue is cleared up. I hope this helps someone else!",louisscruz,rosshinkley
1010,2017-02-24 19:20:27,"@keithkml If you come up with a custom action using the debugger, I'd be _very_ interested in seeing it.

Also, I neglected to mention - if you go this route, you will likely not be able to use the debugger tray (or you'll have to be _very_ judicious about opening and closing it) as Chromium only allows one attachment to the debugger at any given time.  I don't know that you'd hit that, but I thought I'd say it out loud to prevent you from head+desk.

Closing for the moment.",rosshinkley,keithkml
1001,2017-02-15 15:33:31,"@jekku just saw the checks have failed, thanks for noticing. I was a away to an event yesterday :) I'll get on it.",peterwilli,jekku
993,2017-02-10 03:35:27,"Thank you @rosshinkley . 
I'm gonna try it first thing in the morning, have to go right now (2am)

Yes, apparently my government doesn't like spending money on certificates. (go brazil!) 

**It worked!**",tloriato,rosshinkley
988,2017-02-03 07:17:18,@sanbor that is not the only case where test engineers should increase the mocha timeout for nightmare.js. It could also be possible that the operations being done on the browser are intentionally taking long.,jekku,sanbor
988,2017-02-03 17:12:53,@jekku Right. Does that means that you think that it's a good idea to mention this but with a different wording? Thanks.,sanbor,jekku
988,2017-02-13 05:25:14,@sanbor yes,jekku,sanbor
983,2017-02-24 00:57:22,"@jekku Babel inserts a function to handle this for us:

",stephenmathieson,jekku
983,2017-02-24 03:50:18,"@stephenmathieson thanks for teaching me that. :)

For me though, there could be some benefit on the es6 examples change - but it has subtle drawbacks as well. 

For people who need to be convinced to use this open source repository, it should be 'plug and play' as much as possible. Since not all ES6 features are available yet on the native engine without transpiling it from ES6 to ES5, they'd still add a layer of configuration above it to allow this example. I think they could figure out the cosmetic code changes on their own AFTER they are convinced to use nightmare.js.",jekku,stephenmathieson
978,2017-02-06 14:21:03,Thank you @entrptaher I will try this out,ericadamski,entrptaher
978,2017-02-10 03:12:31,@ericadamski how are you running async/await?  Node 7 or Babel or...?,rosshinkley,ericadamski
978,2017-02-10 13:44:51,"@rosshinkley I am using both Node 7, but also babel mostly for jsx and generators",ericadamski,rosshinkley
977,2017-02-07 13:53:51,@urlysses I will give this a try thank you!,ericadamski,urlysses
977,2017-02-07 14:07:30,@urlysses using a plain string data uri works! Thank you for the suggestion!,ericadamski,urlysses
977,2017-02-07 14:08:35,Thanks for checking @ericadamski. Glad I could help :--),urlysses,ericadamski
974,2017-03-24 11:50:30,"+1 I'm also interested in knowing how to set this up. I'm getting `nightmare electron child process exited with code 126: permission problem or command is not an executable - you may not have all the necessary dependencies for electron`

@diit Did you ever figure this out?",sweinertjr,diit
968,2017-02-10 04:16:22,"@navossoc the _unload_ bindings are preventing the page from fully loading?  o_O

That particular chunk was added so if you attempt to navigate away from a page, it prevents an unclickable modal dialog from cropping up, which would cause Nightmare to freeze.  (Same goes for `alert`, `confirm`, etc.)

Under Nightmare 2.9.1, I could not recreate the behavior you're seeing.  Out of curiosity, what are you returning from `.evaluate()`?",rosshinkley,navossoc
968,2017-02-10 11:01:43,"@rosshinkley As far I have tested it, yes...

My script was pretty simple, just a goto(), nothing more than that.

I think @kdgit1 can give you more details about the issue.

[]'s",navossoc,kdgit1
968,2017-02-10 11:01:43,"@rosshinkley As far I have tested it, yes...

My script was pretty simple, just a goto(), nothing more than that.

I think @kdgit1 can give you more details about the issue.

[]'s",navossoc,rosshinkley
967,2017-01-23 01:56:06,@jekku I'm sure it's possible to test for isomorphism -- we'd just need to run the tests under electron in addition to node.,Timer,jekku
967,2017-02-14 17:40:56,"@Timer please, how did you make it work on electron app? do you have some public electron app, that uses your fork?

I tried something like this:

It returns a Promise and it never resolves. I just get 2 outputs:


Do I have to setup something more?",FrantisekGazo,Timer
967,2017-02-14 18:13:49,"@FrantisekGazo it works for me with just that patch, are you running it from the main process? It needs to be on the main process not the renderer.

Alternatively you can try my published version (which I depend on in prod), `eramthgin@2.9.3` and make sure you switch your require from `nightmare` to `eramthgin`.",Timer,FrantisekGazo
967,2017-02-15 18:26:35,"yes, that was the problem - I ran it from a renderer process.
thanks @Timer 

But in the end I managed to do what I needed with [xray](https://github.com/lapwinglabs/x-ray).",FrantisekGazo,Timer
967,2017-02-23 06:38:12,"Hey @Timer 

I'am using your module `eramthgin`, I think I'm in the same case as you... works great.

My question is do you see a flicker on your main window ? Even with `show:false` ... there's clearly a window that show and immediatly hides. Don't know if it's a dev-env problem, if this window is the dev-tools for the nightmare window ... don't know! Do you see something ? Or maybe you use it with show:true ?

",marcelfalliere,Timer
965,2017-03-02 06:51:37,"@novoxudonoser See issue ""Multiple processes: windows open and hang"" #1021 & @louisscruz Project [hub-crawl](https://github.com/louisscruz/hub-crawl)

",LeMoussel,novoxudonoser
963,2017-01-20 20:07:18,@coyotte508 do you have a small example of your problem?,rosshinkley,coyotte508
963,2017-01-20 21:47:25,"@rosshinkley Sorry, not a small one...

https://gist.github.com/coyotte508/7bffdd66e251917c003bebe94ce343e3

It's inside a payment page. `.type` works but not `.insert`. I use the `nightmare-iframe-manager` plugin. The field itself is inside an iframe, maybe it's due to that too.

The selector used for `.type` is the precise selector for the input (`#number`), not a parent.",coyotte508,rosshinkley
959,2017-02-10 03:36:20,"@contobob What you have there will almost certainly not work: `win.webContents.session` does not exist until you navigate away from `default:blank`.  (Why would you try to clear a session cache before it exists?)

If you're having problems with those plugins, i would encourage you to open issues there.",rosshinkley,contobob
959,2017-02-10 14:30:31,Thanks for the reply @rosshinkley. Does that mean the docs in README.md should be updated? My test code was mainly a copy-paste of what can be found [here](https://github.com/segmentio/nightmare#nightmareactionname-electronactionelectronnamespace-actionnamespace) in the `clearCache` example. The doc puts `clearCache` before `goto`.,contobob,rosshinkley
959,2017-02-14 14:36:49,"It's not an issue strictly with the placement of `clearCache` - granted that's probably wrong, even though it's in the readme. If you call `goto` before `clearCache`, it'll never get past `clearCache` - i.e. in this example, it'll print A, but not B or C.



IIRC, I saw the same issue w/ @rosshinkley's nightmare-upload. FWIW, on nightmare 2.9.1 as well.",ysimonson,rosshinkley
959,2017-02-24 03:05:32,"@ysimonson It _does_ print B and C, just not to `stdout` of the node process.  Instead, those get printed (rightfully) to Electron's `stdout`.  Consider your above script, but instead of running with `node example.js` you run with `DEBUG=electron* node example.js`.  You'll see the following output:



... which is precisely what you would expect to see.  `B` when the action is created on the instance, followed by `A` when the action is called, followed by `C` when the action responds to the call.",rosshinkley,ysimonson
959,2017-03-12 17:04:28,"@rosshinkley Have a look into this, its been several months since we've found such issue. Nothing responds to such actions. :/ 

![screenshot from 2017-03-12 22-59-35](https://cloud.githubusercontent.com/assets/8284972/23833958/328e77b4-0778-11e7-8106-fe6d1e8287a6.png)

",entrptaher,rosshinkley
959,2017-03-27 03:09:15,"@rosshinkley If you create custom actions, almost same kind of error happens no matter the callback.",entrptaher,rosshinkley
959,2017-03-27 03:39:41,"**IMPORTANT** I hope I can help - spend some hours on it now.
- the action registration must be **BEFORE** you create your nightmare instance.
- if you access for example the  property you must call the plugin after a page is loaded (means for example **AFTER** the ) - @entrptaher in your code this could be the problem how I see on the screen shot. The problem is that it fails silently because exceptions are not reported which are throwed electron side. (see below to improve this)

To this package to improve:

-  calls in ""children function"" (which run on electron children process) should be redirected also to the main process output - it's hard to debug otherwise if you don't know that  exists, also it depends on the DEBUG var - don't forget it ()
- Exceptions on electron side should be catched and redirected to the client and throwed there again with a note that it happened on electron side. Currently it crashes without infos.
- The  interface to register action is weird because of it's (name[, childFn], parentFn) signature. It must be clarified what the ""child"" and ""parent"" process are - and the optional value should be at the end - I can imagine the reason was the order, whyever - it's really more confusing. I just say:



- The API documentation has following flaws:
   - definitely missing of an overview - a simply TOC could help so much for orientation
   - document the rest of the members of the nightmare object
- I saw that  is currently on version 1.6, older than 2 years. This package has over 11k stars. No TS users here? I wrote the whole definition, very neat and complete. I will spend some time to prepare and publish it on @types if there are people who are interested for it, but if there are 12k js only users its okey.
",aight8,entrptaher
953,2017-01-12 09:07:29,"thanks a lot @ajagnanan I will have a look into that, hope anyway that nightmare can be run somehow inside lambdas and that as solution is already out there :D thanks",riccardo-89,ajagnanan
952,2017-02-14 07:41:50,"@rosshinkley no, it did not.",harso121,rosshinkley
951,2017-01-11 07:46:45,"Thank you @jekku that's a much better API, I didn't realize that was possible!",ianstormtaylor,jekku
951,2017-01-11 08:19:53,@ianstormtaylor please tell me if it worked. You can use babel for es6 and es7. :),jekku,ianstormtaylor
951,2017-01-11 18:12:10,"@jekku yup it worked! Thanks
",ianstormtaylor,jekku
947,2017-03-10 20:27:24,"@entrptaher Isn't that effectively the same thing as using (the admittedly not-well-documented) `.use()`?

Anyway, seems like this issue is resolved for the moment.  Closing.",rosshinkley,entrptaher
946,2017-01-10 01:12:00,"@shhtephe lol we're both noobs but this is what I think - the containers in my Travis CI tests use Ubuntu Server edition. :) I think Xvfb or Xfce will be easier to set up there, so you can use nightmare.js. :grinning: ",jekku,shhtephe
946,2017-01-10 01:33:32,"@jekku So I asked the admins to turn up the ram on the VM box, and they bumped it from 2gb to 8gb, and the issue has been solved. Electron runs speedily and doesn't go past 5%. I don't know why having low memory would tank the CPU usage, but as I said, I'm a n00b. I suppose we can consider this ""solved"" as there's a reasonable workaround?",shhtephe,jekku
946,2017-01-10 01:46:12,"@shhtephe that's awesome :D 

if we look closely, the windows VM might have been using some kind of swap partition. Modern browsers usually take up a lot of memory but I'm not sure how electron is benchmarked.

I tried running chrome on a small box with 3gb and the processor usage is around 50 to 60 percent for 5 tabs. That sounds a bit congruent to your experience.",jekku,shhtephe
945,2017-03-23 10:01:07,"@cscanlin It looks similar to my problem so I would bet it would fix it. Since this PR hasn't been touched in 2 months and as @Mr0grog has previously suggested, we're probably going to be waiting for a while.

I suggest working around it in the meantime by pointing to a fork. This can be done via `git` URLs in your `package.json`:

https://docs.npmjs.com/files/package.json#git-urls-as-dependencies

https://github.com/twolfson/multi-image-mergetool/blob/1.32.1/package.json#L90",twolfson,Mr0grog
945,2017-03-23 10:01:07,"@cscanlin It looks similar to my problem so I would bet it would fix it. Since this PR hasn't been touched in 2 months and as @Mr0grog has previously suggested, we're probably going to be waiting for a while.

I suggest working around it in the meantime by pointing to a fork. This can be done via `git` URLs in your `package.json`:

https://docs.npmjs.com/files/package.json#git-urls-as-dependencies

https://github.com/twolfson/multi-image-mergetool/blob/1.32.1/package.json#L90",twolfson,cscanlin
945,2017-03-23 10:17:41,"@twolfson That did the trick, thanks! On that note, I was also able to merge your branch with the master branch with 0 conflicts. Are there any other major roadblocks in getting this deployed? @Mr0grog, you said that this branch will actually open up the path for even more fixes (in addition to fixing this issue), so it seems like an easy win. Thoughts?",cscanlin,Mr0grog
945,2017-03-23 10:17:41,"@twolfson That did the trick, thanks! On that note, I was also able to merge your branch with the master branch with 0 conflicts. Are there any other major roadblocks in getting this deployed? @Mr0grog, you said that this branch will actually open up the path for even more fixes (in addition to fixing this issue), so it seems like an easy win. Thoughts?",cscanlin,twolfson
945,2017-03-23 16:57:10,"@cscanlin I don’t think anybody who has commented here has any commit rights, so I dunno. It doesn’t seem like there should be any roadblocks here and I would *think* this should be high priority since it’s really easy to trigger it and hang Nightmare.

_Paging @rosshinkley…_",Mr0grog,cscanlin
944,2017-01-06 04:48:06,"@anthnyprschka the return of document.querySelector and document.querySelectorAll are not serializable.

You have to do seomthing like


recommended for closing @rosshinkley ",jekku,anthnyprschka
944,2017-01-06 05:04:49,"Wow thanks @jekku !! The serialization was the problem. The '#id' was just for illustration, was actually selecting for a class. Sorry its late in Berlin. Thanks again for the quick help!
PS. Wasn't really an issue of nightmare.js was it",anthnyprschka,jekku
944,2017-01-06 16:29:49,"@jekku Haha sure you mean a pull request? What exactly? 

And is this the only way to send back data extracted from the site to my script? Seems like a workaround no?

EDIT: Nevermind i think i got it now :) ",anthnyprschka,jekku
942,2017-01-05 03:50:46,"@jekku - @urlysses' answer would only work if the HREF attribute contained the text in question, not the text element under the anchor.  In other words, the answer - while useful - didn't address the question.

From here, @pfftdammitchris, I think you have two options off the top of my head.  One: you could use `.evaluate()` and try to issue clicks directly.  Something like:



This clicks directly on the first element that matches text in the anchor's text, in this case, `information`.  This approach doesn't _always_ work, it depends on the JS framework you're using - in your case it looks like Angular, so your mileage may vary.

Option two: add a class to the anchor you want to click, then use the existing `.click()` machinery to issue your click.  This may work better in your situation, especially if you decide you'd rather use something like [`nightmare-real-mouse`](https://www.npmjs.com/package/nightmare-real-mouse) instead of the internal click events to Nightmare:

",rosshinkley,pfftdammitchris
942,2017-01-05 03:50:46,"@jekku - @urlysses' answer would only work if the HREF attribute contained the text in question, not the text element under the anchor.  In other words, the answer - while useful - didn't address the question.

From here, @pfftdammitchris, I think you have two options off the top of my head.  One: you could use `.evaluate()` and try to issue clicks directly.  Something like:



This clicks directly on the first element that matches text in the anchor's text, in this case, `information`.  This approach doesn't _always_ work, it depends on the JS framework you're using - in your case it looks like Angular, so your mileage may vary.

Option two: add a class to the anchor you want to click, then use the existing `.click()` machinery to issue your click.  This may work better in your situation, especially if you decide you'd rather use something like [`nightmare-real-mouse`](https://www.npmjs.com/package/nightmare-real-mouse) instead of the internal click events to Nightmare:

",rosshinkley,jekku
942,2017-01-06 02:30:47,@pfftdammitchris yes. As long as you are sure that JQuery is always loaded. You can even use all the other functions of JQuery to perform interactions / manipulations within an evaluate call.,jekku,pfftdammitchris
942,2017-01-07 20:20:28,Sorry! Deleted my answer because I re-read the question and saw that I misunderstood the initial question. I should instead have edited with a more appropriate answer or update. Thanks @jekku and @rosshinkley.,urlysses,rosshinkley
942,2017-01-07 20:20:28,Sorry! Deleted my answer because I re-read the question and saw that I misunderstood the initial question. I should instead have edited with a more appropriate answer or update. Thanks @jekku and @rosshinkley.,urlysses,jekku
940,2017-01-02 16:55:07,"@Dnyg `httpResponse` is not defined because the parameters passed to `.then()` will be from the last action executed in the chain (with the exception of `.end()`) - in your case, `.screenshot()` (which doesn't return anything).  If you need the HTTP response, you can break up your chain with another `.then()` to perform logic.  Something like:



@TheTechy your code suffers from the same issue - the additional problem here is you're trying to access `code` off of `httpResponse` which will cause an exception.  From your trace: ` ERROR: TypeError: Cannot read property 'code' of undefined`",rosshinkley,TheTechy
940,2017-01-02 16:55:07,"@Dnyg `httpResponse` is not defined because the parameters passed to `.then()` will be from the last action executed in the chain (with the exception of `.end()`) - in your case, `.screenshot()` (which doesn't return anything).  If you need the HTTP response, you can break up your chain with another `.then()` to perform logic.  Something like:



@TheTechy your code suffers from the same issue - the additional problem here is you're trying to access `code` off of `httpResponse` which will cause an exception.  From your trace: ` ERROR: TypeError: Cannot read property 'code' of undefined`",rosshinkley,Dnyg
940,2017-01-02 21:02:30,"@TheTechy Ah, cool. :)  No problem, happy to help.",rosshinkley,TheTechy
937,2017-01-02 17:07:23,"@R0byn as @jekku mentioned, give #224 a read.

So starting from the top, explaining what you're seeing:

> Result: No errors, but also no console output. 

In the future, try running with `DEBUG=nightmare*,electron*` or `DEBUG=*`.  That will yield more verbose, useful output.

> Then tried the example in a shell on the Ubuntu Desktop - voila! Worked! :-)

This is because when you're under an Ubuntu desktop, you're running an X session of some flavor, meaning there's a framebuffer running.  Electron requires a framebuffer to be running to work properly.

> ... and is being pushed to a CI (Which is similarly, a shell ONLY env).

_Most_ (all?) of the CI solutions I've seen have a framebuffer of some flavor running (usually xvfb).

> Is there a way to get nightmare scripts running with this combination

Yes.  Install `Xvfb`, read through #224 and the suggestions there.  You can either have `Xvfb` always running or use `xvfb-run` to manage starting/stopping the service for you.  Your setup under that scenario should work fine.

I'm going to merge this into #224 and close this issue.

",rosshinkley,jekku
937,2017-01-02 17:07:23,"@R0byn as @jekku mentioned, give #224 a read.

So starting from the top, explaining what you're seeing:

> Result: No errors, but also no console output. 

In the future, try running with `DEBUG=nightmare*,electron*` or `DEBUG=*`.  That will yield more verbose, useful output.

> Then tried the example in a shell on the Ubuntu Desktop - voila! Worked! :-)

This is because when you're under an Ubuntu desktop, you're running an X session of some flavor, meaning there's a framebuffer running.  Electron requires a framebuffer to be running to work properly.

> ... and is being pushed to a CI (Which is similarly, a shell ONLY env).

_Most_ (all?) of the CI solutions I've seen have a framebuffer of some flavor running (usually xvfb).

> Is there a way to get nightmare scripts running with this combination

Yes.  Install `Xvfb`, read through #224 and the suggestions there.  You can either have `Xvfb` always running or use `xvfb-run` to manage starting/stopping the service for you.  Your setup under that scenario should work fine.

I'm going to merge this into #224 and close this issue.

",rosshinkley,R0byn
936,2016-12-29 22:34:58,"@jekku I am confused, I am waiting for it before clicking:

",dfenstermaker,jekku
936,2017-01-02 17:12:02,"@dfenstermaker in your original post, though, you said it was not clicking on `form button#go-button`.  Is that button the problem, or is `tos-accept-button` the issue?  If it's `form button#go-button`, what happens if you have `.wait('form button#go-button')` prior to the click?

_edit:_ missed a closing apostrophe",rosshinkley,dfenstermaker
934,2017-01-02 17:19:25,"`.screenshot()` does not take a function callback (at least, not anymore).  What version of Nightmare are you using, @tlshaheen?",rosshinkley,tlshaheen
934,2017-01-03 07:12:12,"@rosshinkley https://github.com/segmentio/nightmare/blob/master/lib/actions.js#L600

I think the current branch still does. It just isn't documented. The top level callback is bubbled down as a callback to fs.writeFile.",jekku,rosshinkley
934,2017-01-05 03:21:39,"@jekku I don't think that does what you think it does, and now that you've pointed it out, I think I see the problem.  You _can_ pass a function like that, but it will do exactly what @tlshaheen said - it will prevent downstream execution of the Nightmare chain.  What that is looking for is the internal `done` callback as `.screenshot()` has optional parameters.

To make things clearer, an example might be helpful:



This will print `hello from screenshot callback`, but will never advance to the `.end()` because the `done` callback that tells Nightmare to move onto the next step - the one specified in the line you highlighted - is never called.

So while what i said is technically incorrect - `.screenshot()` _does_ take a callback, but it's supposed to be internal to make chaining work - I stand by my original statement.  I don't think `.screenshot()` takes a user-passable function callback as originally posted.

For completeness, if you wanted the buffer, the above example is easily fixed:



I'm still curious what version the original example was written against and/or where the example came from.",rosshinkley,jekku
934,2017-01-05 03:21:39,"@jekku I don't think that does what you think it does, and now that you've pointed it out, I think I see the problem.  You _can_ pass a function like that, but it will do exactly what @tlshaheen said - it will prevent downstream execution of the Nightmare chain.  What that is looking for is the internal `done` callback as `.screenshot()` has optional parameters.

To make things clearer, an example might be helpful:



This will print `hello from screenshot callback`, but will never advance to the `.end()` because the `done` callback that tells Nightmare to move onto the next step - the one specified in the line you highlighted - is never called.

So while what i said is technically incorrect - `.screenshot()` _does_ take a callback, but it's supposed to be internal to make chaining work - I stand by my original statement.  I don't think `.screenshot()` takes a user-passable function callback as originally posted.

For completeness, if you wanted the buffer, the above example is easily fixed:



I'm still curious what version the original example was written against and/or where the example came from.",rosshinkley,tlshaheen
931,2017-01-02 17:33:47,"@yodfz not sure what you're expecting to happen here: if the `.js-alert` element does not exist, that function will never return, and eventually the wait timeout will be hit.  You probably want an `else` statement to call `done()`, if I had to guess.",rosshinkley,yodfz
929,2016-12-30 21:43:06,@reinpk What do you mean by test case? Like a unit-test? Or a codepen that shows the issue?,notVitaliy,reinpk
929,2017-01-05 14:43:37,"@reinpk This issue might be difficult to reproduce in a unit-test since it's an interaction between angular2 and nightmare, afaik. I'll do my best to isolate the underlying cause over the next couple weeks.",notVitaliy,reinpk
927,2016-12-19 01:03:44,"> if you're using the remote debugging protocol, doesn't that mean you can't use the debugger (or have the development tray) open at the same time? If I'm not mistaken, this is the same issue that nightmare-upload has.

😲 I was entirely unaware of that as an issue and hadn’t tested it. The good news is that if a user has opened the local debugger before screenshotting, screenshots still work (see the `catch` clause here: https://github.com/segmentio/nightmare/pull/927/files#diff-bc4eacf94ad1a8e7c9bea8b6b6451251R83). The bad news is that users can’t open the local debugger *after* screenshotting. I’ve added another commit that detaches the debugger as soon as we’re done, which seems to resolve that.

Since you’ve seen this issue before, it’d be great if you give it a go as well, @rosshinkley.",Mr0grog,rosshinkley
922,2016-12-19 11:15:11,"I will try with `DEBUG=nightmare*,electron*`.
I already tried setting a random partition name for each instance (following @Mr0grog advice here : https://github.com/segmentio/nightmare/issues/493#issuecomment-265684086)
But it doesn't change anything. 
I come back to you by the end of the week ! Thanks @rosshinkley 
",GautierT,rosshinkley
921,2016-12-17 03:07:38,"@ewrogers is correct: `session` is not created until after you navigate somewhere.

It might be worth having the discussion: should Nightmare navigate to `about:blank` first?  I can't think of any side effects off the top of my head, but it might be worth sandboxing to see.

Thoughts?",rosshinkley,ewrogers
921,2016-12-18 23:12:34,"@rosshinkley  Navigating to `about:blank` initially would work.

Alternatively, you could have `cookies.set` check if a current `session` exists, and if not just treat it as a `.goto('about:blank').then(() => cookies.set(...))` instead.",ewrogers,rosshinkley
921,2017-01-24 14:23:33,"@tmcleroy 
As a temporary measure, I figured out a way around the issue by subscribing to the 'did-start-loading' event and throwing my cookies. I'm sure there are cleaner solutions. In particular I couldn't figure out how to pass in the url and cookies as params into my custom action so I used the node-persist package to write and the values out:


To use it: 


If someone can help me figure out how to pass the values into the action invocation instead of relying on node-persist to write and pull them out, that would be optimal.. ",thebentern,tmcleroy
921,2017-01-24 23:11:43,"@thebentern
Have you tried this?



I was playing with cookies today and I managed to set they as this:


**Environment:**

> { electron: '1.4.15',
>   chrome: '53.0.2785.143',
>   nightmare: '2.9.1',
>   os: 'win32' }",navossoc,thebentern
921,2017-03-23 04:46:03,"@navossoc This seems to work, just add `url` property.",jasonmorita,navossoc
916,2016-12-05 21:57:45,@jekku Do you mean literally using the name `'nopersist'` as your partition name? I think you can use any name for the same effect but yeah that would work. I don't know of any other way to do it and you can get burned pretty hard if you don't.,justinmchase,jekku
913,2016-12-19 04:09:20,"@rosshinkley when I use element.src it return null, it's seems not work",canhongpoxiao,rosshinkley
913,2016-12-19 04:59:56,"@canhongpoxiao this is not the venue for these kinds of questions. Go to Stackoverflow.

You cannot directly call the property of the DOMElement. You need to something like .getAttribute('src')",jekku,canhongpoxiao
907,2016-11-28 08:18:44,"@yourfavorite nightmare uses electron BrowserWindow:

https://github.com/electron/electron/blob/master/docs/api/browser-window.md

There are 2 functions:

https://github.com/electron/electron/blob/master/docs/api/browser-window.md#winshow
https://github.com/electron/electron/blob/master/docs/api/browser-window.md#winhide



So, if you want to call them, you can extend nightmare:



And then:



There is something wrong, because after the last `.show`, the `end` is ignored. I will fix it later, for now you can start with this, the code works.
",wiliame,yourfavorite
907,2016-11-28 18:50:38,This is great! Thanks @wiliame ,yourfavorite,wiliame
906,2016-12-17 05:07:50,"@jimmaay To be honest, it never got past a doodle in my notebook.  (Ab)Using the viewport size and moving it around was going to be a first pass, but you're right - a fixed (or anchored) element would definitely throw a wrench in that.  There are other rendering problems that could crop up with any sort of responsive layout, too, which is ultimately why I tabled the idea.  Still, as a science experiment to float out, it might be worth doing to see if anyone has ideas or another approach.  Also - spitballing - I know you can hook into the frame rendering buffer directly (that's how the current incarnation of screenshots work) - I wonder if there's some raw frame buffer magic that could be pulled off?",rosshinkley,jimmaay
905,2016-11-25 03:28:03,"@neal1991 

",jekku,neal1991
905,2016-11-25 04:06:22,"@neal1991 you can't say who behaves normally. Even Linus Torvalds, creator and maintainer of git and linux is more of an asshole then me.

http://thenextweb.com/dd/2015/11/02/linux-creator-linus-torvalds-had-a-meltdown-over-a-pull-request-and-it-was-awesome/",jekku,neal1991
905,2016-11-25 04:09:17,@jekku Maybe you are born like this.,neal1991,jekku
904,2016-12-06 17:25:19,"@jamie-pate what do you mean?

Sometimes you don't need to wait for ""Load"" event if you want to use something that is ready at DomReady event.

For all my cases DomReady is the fastest method.",wiliame,jamie-pate
904,2016-12-06 18:02:04,"@jamie-pate google cloud instances works fine with electron. If your machine has 4 cores, sumon only 4 electron and reuse them, don't close them when finish requests so you will be consuming resources to spawn them again.

Working with async.queue (or priority queue) helps.

After crawling a webpage clear cookies, application data and goto ""about:blank"" so the next page don't get the previous referer.

Don't clear cache so next crawling in that domain will be faster.

I'm getting good results with this practices.",wiliame,jamie-pate
904,2016-12-06 22:51:11,"@jamie-pate right, a lot of time is spent in waiting. N maybe must be based on CPU usage.

Look, my crawler is something like this (i haven't tried the code):



So you don't have to call end() and close the instance.",wiliame,jamie-pate
902,2016-12-05 23:12:01,@jekku Maybe you could add a little section in the README for this new function also?,justinmchase,jekku
902,2016-12-07 07:39:13,"@justinmchase added. Thanks for the headsup.

:up: ",jekku,justinmchase
902,2016-12-07 08:08:09,@reinpk @rosshinkley the failing test comes from a different feature.,jekku,reinpk
901,2016-11-30 04:57:32,@reinpk already active :) Just gonna add a test,jekku,reinpk
900,2016-12-17 03:35:33,"@jekku  This probably should have gotten pulled in with the last release.  I'll see to it that it gets pulled in with the next one.

@justinmchase _mostly_ for previous version support/preventing breaking changes.  In the future, support could be dropped.  (This is _tangentially_ related to a conversation about `.run()` in #575.)

",rosshinkley,jekku
900,2016-12-17 03:35:33,"@jekku  This probably should have gotten pulled in with the last release.  I'll see to it that it gets pulled in with the next one.

@justinmchase _mostly_ for previous version support/preventing breaking changes.  In the future, support could be dropped.  (This is _tangentially_ related to a conversation about `.run()` in #575.)

",rosshinkley,justinmchase
892,2016-11-21 06:49:38,"@rosshinkley 

And now when I try again, it just stucks here:
""
DEBUG=nightmare*,electron* xvfb-run --server-args=""-screen 0 1024x768x24 -extension RANDR"" node yahoo_demo.js
nightmare queuing process start +0ms
  nightmare queueing action ""goto"" for http://yahoo.com +4ms
  nightmare queueing action ""type"" +2ms
  nightmare queueing action ""click"" +0ms
  nightmare queueing action ""wait"" +1ms
  nightmare queueing action ""evaluate"" +0ms
  nightmare running +0ms

  (stuck here)
""
And when I press ctrl-c comand, it outputs:
""
...(shown above)
nightmare electron child process exited with code null: undefined +6m
/usr/bin/xvfb-run: line 171: kill: (24823) - No such process
""",albus01,rosshinkley
887,2016-12-28 01:57:28,"I'd also like to be able to access the webContents of the BrowserWindow instance if this is possible? I need it for the same purpose as @zatziky (simulating real keyboard inputs).

And also simulating real pasting (but this also requires access to electron clipboard object):


**Edit:** Ahh, thank you @rosshinkley - I thought `.action()` only allowed javascript evaluation, but taking a proper look at the documentation I see that @zatziky and I should be able to do something like this:

(Haven't tested yet, based it on an example in #379 - thanks @shadowmint!)

**Edit 2:** Hmm, not working. Can anyone spot where I've went wrong? Will update this comment if I find the correct way to do this. I've also tried adding a `setTimeout` with a `keyUp` in it after the `keyDown`, but that doesn't seem to work either.

**Edit 3:** Fixed! Turns out you need to focus a window before you can `sendInputEvent` - so I've added it to the code above (my window wasn't focused because dev tools opens up after it). Reported  this need for `focus` to the [electron repo](https://github.com/electron/electron/issues/8299). Also added `keyUp` after the `keyDown` (in my actual code I put the `keyUp` in an 50ms `setTimeout` to hopefully make the simulation more accurate).",josephrocca,zatziky
887,2016-12-28 01:57:28,"I'd also like to be able to access the webContents of the BrowserWindow instance if this is possible? I need it for the same purpose as @zatziky (simulating real keyboard inputs).

And also simulating real pasting (but this also requires access to electron clipboard object):


**Edit:** Ahh, thank you @rosshinkley - I thought `.action()` only allowed javascript evaluation, but taking a proper look at the documentation I see that @zatziky and I should be able to do something like this:

(Haven't tested yet, based it on an example in #379 - thanks @shadowmint!)

**Edit 2:** Hmm, not working. Can anyone spot where I've went wrong? Will update this comment if I find the correct way to do this. I've also tried adding a `setTimeout` with a `keyUp` in it after the `keyDown`, but that doesn't seem to work either.

**Edit 3:** Fixed! Turns out you need to focus a window before you can `sendInputEvent` - so I've added it to the code above (my window wasn't focused because dev tools opens up after it). Reported  this need for `focus` to the [electron repo](https://github.com/electron/electron/issues/8299). Also added `keyUp` after the `keyDown` (in my actual code I put the `keyUp` in an 50ms `setTimeout` to hopefully make the simulation more accurate).",josephrocca,rosshinkley
887,2017-01-02 17:16:47,"@zatziky upload dialogs are _very_ tricky, requiring tapping into the debugger API.  There is a plugin for that: [`nightmare-upload`](https://github.com/rosshinkley/nightmare-upload).  Sending keyboard events to Electron for upload dialogs won't work.

@josephrocca Glad you got it figured out, and thank you for documenting your process! Highly appreciated. :)

Considering both of the above issues are covered, I'm going to go ahead and close this issue.",rosshinkley,zatziky
887,2017-01-02 17:16:47,"@zatziky upload dialogs are _very_ tricky, requiring tapping into the debugger API.  There is a plugin for that: [`nightmare-upload`](https://github.com/rosshinkley/nightmare-upload).  Sending keyboard events to Electron for upload dialogs won't work.

@josephrocca Glad you got it figured out, and thank you for documenting your process! Highly appreciated. :)

Considering both of the above issues are covered, I'm going to go ahead and close this issue.",rosshinkley,josephrocca
887,2017-01-06 14:47:51,@josephrocca I'm not able to get your action to work. Do you have a complete example? Help would be much appreciated ,ecrmnn,josephrocca
887,2017-01-06 15:04:26,"@ecrmnn Here's the code with a 50ms timeout (not sure if this actually makes a difference, pretty sure it worked for me without the delay):



It works for me with tab and backspace, but not for enter/return (`\u000d`) for some reason. It sort of stumped me so I've moved onto another project for now. If you make any progress, please let me know! Would be really nice if nightmare had a `sendKeys` sort of thing like selenium that abstracted all this stuff away.",josephrocca,ecrmnn
887,2017-01-06 15:36:58,@josephrocca Thanks. I'll try it out. I'm trying to trigger left and right arrow keys. Hopefully I'll get it working,ecrmnn,josephrocca
887,2017-03-16 04:49:12,"@josephrocca hey just wondering have you managed to get arrow keys working?
",export-mike,josephrocca
885,2016-11-18 00:00:49,"It did not work for me. Have you tried @CvX ?
",bertolo1988,CvX
881,2017-03-16 17:40:12,"@nick2012 when you just do `require('./extend.js')`, it comes back as an object with a `login` property. nightmare.use expects a function.

the `.use` function doesn't add the function to the nightmare instance, so the use would be:

    nightmare
      .use(require('./extend').login('my-credentials'))
      .otherstuff",tforbus,nick2012
877,2016-11-08 11:49:39,"@edisch 
Thank you so much for anwser me, but it seems not work. The loop not work: `['then', function(res) { console.log('finish'); }]` not work, and `console.log(current);` also not work.
",albus01,edisch
870,2017-01-20 20:52:04,@anperez78 Did you take a look at `nightmare-download-manager` or `nightmare-inline-download`?,rosshinkley,anperez78
866,2016-11-21 13:47:57,Thx @rosshinkley ,zatziky,rosshinkley
865,2017-01-02 17:37:00,"Yeah I fixed whole merging ;)

On Mon, Jan 2, 2017 at 2:25 AM Rico Sta. Cruz <notifications@github.com>
wrote:

> *@rstacruz* commented on this pull request.
>
>
>
>
> ------------------------------
>
>
>
>
> In Readme.md
> <https://github.com/segmentio/nightmare/pull/865#pullrequestreview-14833628>
> :
>
>
> > @@ -30,16 +30,13 @@ Many thanks to [@matthewmueller](https://github.com/matthewmueller) and [@rosshi
>
>  Let's search on Yahoo:
>
>
>
> oops, haha, this needs to change too
>
>
>
>
> ------------------------------
>
>
>
>
> In Readme.md
> <https://github.com/segmentio/nightmare/pull/865#pullrequestreview-14833628>
> :
>
>
> > @@ -30,16 +30,13 @@ Many thanks to [@matthewmueller](https://github.com/matthewmueller) and [@rosshi
>
>  Let's search on Yahoo:
>
>
>
> but i think someone already edited that
>
>
>
>
> —
> You are receiving this because you modified the open/close state.
> Reply to this email directly, view it on GitHub
> <https://github.com/segmentio/nightmare/pull/865#pullrequestreview-14833628>,
> or mute the thread
> <https://github.com/notifications/unsubscribe-auth/AAoMcSpFOqLKtAFCKH5favWMdstoVwpqks5rONC1gaJpZM4Kmveu>
> .
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
",reinpk,rstacruz
862,2016-11-01 20:54:11,"Quick notes before I have to stop looking at this for now:
1. The problem is in the IPC between the Electron process itself and the browser window process when JS is evaluated (i.e. in `win.webContents.executeJavaScript()`).
2. In @nguyenchr’s example above, the specific issue isn’t in the DOM node but in the jQuery metadata attached to it. Most specifically, it’s an AngularJS `$scope` object attached to the node, which is both very deep and highly recursive.
3. Looks like this was _most likely_ caused by changes to the recursion/uniqueness checking algorithm in Electron’s JS <-> C++ conversion code (which is how values get packaged up for IPC) here: https://github.com/electron/electron/pull/6977
4. There’s an Electron issue tracking it: https://github.com/electron/electron/issues/7286

Not sure if there are also things worth doing in Nightmare ahead of Electron improving on their side:
- Detect recursion and just disallow it? e.g. something like `JSON.parse(JSON.stringify(returnValue))` will throw [quickly] when recursion is encountered, though this could cause other issues :\
- Special case DOM nodes and just send back some particular meaningful properties and NOT metadata attached to them? Or send back an error instead for DOM nodes? (This won’t fix the real issue of sending deep/recursive data structures, but would make it less likely to happen.)
",Mr0grog,nguyenchr
862,2016-11-04 02:53:16,"@Mr0grog Would it be worth it to use something like [`json-stringify-safe`](https://www.npmjs.com/package/json-stringify-safe) to handle circular references when serializing data to pass over the IPC boundary?
",rosshinkley,Mr0grog
857,2016-10-29 19:16:31,"@rosshinkley You said that the first `.then()` returns a `Promise`. Can this promise be converted to `bluebird` Promise so to be able to use `.each()` and others from specified library, at a later point in Nightmare chain? Something like this:


",gfot,rosshinkley
856,2016-12-07 17:22:31,"@entrptaher I did something similar to the stuff that you mentioned and it worked. Basically added a `package.json` in resources folder and put electron there, and installed the node module.",mping,entrptaher
856,2017-03-12 00:21:32,"@Overtorment Here is another random issue related to that.
https://github.com/segmentio/nightmare/issues/1018",entrptaher,Overtorment
855,2016-10-27 17:50:37,"Hey @balajmarius, this pretty much the exact same issue as #854; you might want to check there for a better understanding of the issue and possible solutions.
",Mr0grog,balajmarius
854,2016-10-27 13:45:06,"@Mr0grog Thank you for researching this. I think I found another solution, please check it out:



Basically, when you know you need to wait for the page to unload before moving on you would place `.waitforunload()` and nightmare will not move on until it is resolved. I think I should submit a pull request to add this feature natively. Please let me know your thoughts.
",bchr02,Mr0grog
854,2016-10-27 17:46:26,"@Mr0grog Thank for the extra option but did you see my other solution  here https://github.com/segmentio/nightmare/issues/854#issuecomment-256658926 which uses an `.evaluate()` instead of an action? I seem to like this the best because it's the cleanest and clearest solution, in my opinion.
",bchr02,Mr0grog
854,2016-10-27 18:01:15,"@Mr0grog it would be awesome if your non-event listener option within https://github.com/segmentio/nightmare/issues/854#issuecomment-256712828 could be added directly to nightmare. Care to send a pull request? 😄 
",bchr02,Mr0grog
853,2016-10-26 17:36:37,"Hi @saginadir, you can use the `did-get-response-details` event for this:


",Mr0grog,saginadir
846,2016-11-04 03:41:38,"Thanks @rosshinkley. I can nest another `nightmare.goto(url)` call in the outer `then` block it seems and that seems to solve that.
",matthewmichihara,rosshinkley
844,2016-12-17 05:59:47,"@privilio  is right: start with #224.  Closing this for now, feel free to reopen if you are still having an issue.",rosshinkley,privilio
837,2016-10-20 10:02:32,"Thank you very much @rosshinkley. I didn't stumble upon nightmare-examples before. It's true that it's linked within a ToC, but by scrolling and reading through segmentio/nightmare README there was no such section, not even a link to it and I didn't pay attention to the ToC since I assumed I read it all. Also, there is not a single example of a code in a main README that would use `then` at least twice. If either of these were the case - I would have probably solved it by myself before. I'm just describing what was the issue in my case, feel free to disregard my remarks :)

_Even then I am not sure what was I doing wrong before since I used map.reduce (or recursion) to chain promises before and it eludes me what was I previously doing wrong in my code that I did draw all those wrong conclusions about the function of `then`._

In any case - it works like a charm and now that I finally get nightmare mechanics I enjoy the simplicity of the API very much. Fantastic tool.
",kamiltrebunia,rosshinkley
836,2016-10-20 14:54:17,"@jussch @rosshinkley I tried all sorts of acrobatics to make it work on heroku until I emailed their tech support and confirmed that dev/shm is fixed to 5mb on all dynos. 

Even though I couldn't prove that dev/shm was the problem (if you read the chromium issue part of the problem is that you don't get logs about the crash), I tested the same script that was crashing on heroku on the smallest VMs of AWS and DO and worked perfectly. I _think_ (can't remember for sure) monitoring dev/shm at max usage on heroku.

If you _must_ use heroku I guess you could finally ask them to change the allocation ad-hoc (if possible).

Hope it helped.
",rickmed,jussch
836,2016-10-20 14:54:17,"@jussch @rosshinkley I tried all sorts of acrobatics to make it work on heroku until I emailed their tech support and confirmed that dev/shm is fixed to 5mb on all dynos. 

Even though I couldn't prove that dev/shm was the problem (if you read the chromium issue part of the problem is that you don't get logs about the crash), I tested the same script that was crashing on heroku on the smallest VMs of AWS and DO and worked perfectly. I _think_ (can't remember for sure) monitoring dev/shm at max usage on heroku.

If you _must_ use heroku I guess you could finally ask them to change the allocation ad-hoc (if possible).

Hope it helped.
",rickmed,rosshinkley
836,2017-01-25 00:46:24,@jussch I'm running into the same issue. Wondering if you found a solution?,Chris911,jussch
836,2017-01-31 22:50:08,"@jussch Heroku just bumped the size of `/dev/shm/` on their dyno to allow headless browser test.

https://devcenter.heroku.com/changelog-items/1085",Chris911,jussch
836,2017-02-02 19:50:47,"@Chris911 No I never found a solution, but thanks a bunch for the info! I'll give it another try.",jussch,Chris911
836,2017-02-02 19:52:55,"@jussch I managed to get it to run with a few buildpacks but it was crashing after loading 1 webpage. I contacted Heroku and they said they were working on increasing `/dev/shm/` and that it should fix it. Personally decided to deploy on Google Cloud for now but might switch back to Heroku. 

Let me know if it works for you!",Chris911,jussch
835,2016-10-19 18:35:57,"@rosshinkley i want to stop the nightmare by a button 
i want to do a button that start my script contains nightmare then when i want to stop the nightmare with an other button because in the server i can't see the electron to stop it 
did u undertand me now?
",neutron92,rosshinkley
835,2016-10-19 20:01:33,"@rosshinkley do you know maybe when `.halt()` API will be included ?

We need it for project of ours.

If that will not be soon, do you suggest any solutions ?

Peace!
",shtefcs,rosshinkley
835,2016-10-29 19:36:46,"@entrptaher Wow, tnx a lot for trying to help mate, really appreciate!

I will need to wait someone to do this for me, cause current guy who was doing this left the work.

@entrptaher how can I get in contact with you ?  My email is stefan@vanila.io, so you can reach me there or join our internal chat on https://chat.vanila.io
",shtefcs,entrptaher
835,2016-10-29 19:50:51,"Thank you @entrptaher 
",jelenajjo,entrptaher
832,2016-10-30 08:55:41,"@cagataycali, maybe thats not the problem you are trying to solve. If you are trying to use download manager, then probably you should try their example first.



If you want to pass something to evaluate, you have to pass it as @rosshinkley showed above.
But, from your example, it's not exactly clear what are you trying to do.
The actual code might be more helpful.
",entrptaher,cagataycali
832,2016-10-30 08:55:41,"@cagataycali, maybe thats not the problem you are trying to solve. If you are trying to use download manager, then probably you should try their example first.



If you want to pass something to evaluate, you have to pass it as @rosshinkley showed above.
But, from your example, it's not exactly clear what are you trying to do.
The actual code might be more helpful.
",entrptaher,rosshinkley
832,2017-01-02 18:40:29,"@cagataycali In addition, you're not passing values to `.evaluate()` to print.  From the hip, this should work:


You may want to give [variable lifting](https://github.com/rosshinkley/nightmare-examples/blob/master/docs/common-pitfalls/variable-lifting.md) a read.

Going to close this due to age and I think possibly being solved.",rosshinkley,cagataycali
830,2016-10-19 19:53:08,"@rosshinkley Thank you for helping. I am looking to pull the information (html) from the page that excepted, not the URL.
",bchr02,rosshinkley
830,2016-10-24 22:38:46,"@rosshinkley I tried to use your .evaluate() method as you had suggested, but none of the code within the final .then() (where the html should be) executes. 
",bchr02,rosshinkley
830,2016-10-25 16:32:28,"Okay I created another approach that works using evaluate's new Promise support - @rosshinkley thanks for adding that by the way.

So here is what I did. I created a wait function that takes three parameters.
1. The element id to check for
2. waitTimeout (this is optional)
3. pollInterval (this is optional)

Once you declare a wait variable with the new wait function code provided below, when using nightmare instead of using `.wait('#uh-search-box')` you would do this:
`.evaluate(wait, 'uh-search-box')` And since the new wait function returns a promise, it is added to normal queue and we could continue chaining as normal.

Of coarse the solution can be adjusted to ones individual needs. But for me this was perfect. Here is the code:


",bchr02,rosshinkley
830,2016-10-27 07:05:29,"FWIW, @rosshinkley's suggestion should work, _except_ you need to make sure not to call `end()` before your `catch` runs:



So it doesn’t have to be nearly so complicated as your asynchronous `wait` above.
",Mr0grog,rosshinkley
830,2016-10-27 16:33:12,"@Mr0grog Thanks for the thorough explanation and for the corrected code. This is great!
",bchr02,Mr0grog
830,2016-10-27 21:34:06,"@Mr0grog Thanks again for helping me. I wanted you to know that I ended up making some refinement to your code above because I didn't understand:
- why there is a `catch()` immediately followed by another `catch()`
- why the last `catch()` is followed by a `then()`
- what the purpose of `.goto('about:blank')` when this could be captured in a `catch()`

So here is the code structure that I ended up using and achieves the goal of performing a task on a page that timed out (like getting the html off of it):


",bchr02,Mr0grog
830,2016-10-28 01:10:33,"Poking a head in: Thank you @Mr0grog:

> except you need to make sure not to call end() before your catch runs...

Editing mistake on my part.  Thanks for the second set of eyes.
",rosshinkley,Mr0grog
830,2016-10-28 22:23:41,"Heh, no worries @rosshinkley. I made a similar copy/paste error in my first reply too, only saved by the fact that it didn't break the code :P
",Mr0grog,rosshinkley
830,2016-10-29 03:00:54,"@Mr0grog thanks for explaining
",bchr02,Mr0grog
829,2016-12-17 15:42:08,"@rosshinkley I was trying to modify the content of a script served over HTTPs. Still, I don't really have a solution for this, but I found a workaround for my case.

Would be curious how do modify that, tho.",IonicaBizau,rosshinkley
827,2016-10-26 16:46:33,"@bchr02 Sure! Pretty much a proof of concept, not tested (pasting things from my code):


",IonicaBizau,bchr02
827,2016-10-26 18:59:53,"@IonicaBizau Thank you!
",bchr02,IonicaBizau
824,2016-10-19 19:08:23,"@rosshinkley in this case, `window.confirm` isn't the issue, it's the `unload` and `onbeforeunload` handlers. I managed to fix it with a custom `preload.js` script, which I've submitted in a pull request here: https://github.com/segmentio/nightmare/pull/825
",Fauntleroy,rosshinkley
819,2016-10-12 23:41:44,"@rosshinkley this pull request is great! Thank you. It will help me with https://github.com/segmentio/nightmare/issues/830
",bchr02,rosshinkley
813,2016-10-24 15:06:00,"The same with you @ScottHelme . Anyone help?
",albus01,ScottHelme
810,2016-09-28 09:16:52,"@marcelfalliere OK you're right, what works for me is to do:



however it could be handy to have some API way to do that, either some boolean flag for replace, or some clear method.
",typekpb,marcelfalliere
810,2016-09-29 17:43:53,"In addition to sending backspace characters as @marcelfalliere said, you can send empty or falsey values to `.type()` and `.insert()` to clear the selector.

I do have a question:

> ...on script re-run are previously inserted input fields prefilled with old values.

Meaning that the values are there between runs to the same site?
",rosshinkley,marcelfalliere
810,2016-09-29 19:48:17,"@rosshinkley 

> I do have a question:
> 
> >    ...on script re-run are previously inserted input fields prefilled with old values.
> 
> Meaning that the values are there between runs to the same site?

correct
",typekpb,rosshinkley
809,2016-09-29 14:33:11,"@daniel3d is right: `.end()` queues the ending action, it still needs to be executed with a `.then()`.

Setting that aside, and this is kind of offtopic: I'm not certain Nightmare is the best tool for converting SVGs to PNGs.  Have you considered using something like [ImageMagick](http://imagemagick.org/script/index.php)?  `convert` will give you _much_ more flexibility for image manipulation.
",rosshinkley,daniel3d
809,2016-09-29 21:05:09,"@rosshinkley unfortunately not for SVGs :)
",mikeys,rosshinkley
805,2016-10-25 19:44:48,"Thx a lot @rosshinkley 
",jonatasfreitasv,rosshinkley
794,2017-01-05 20:27:10,@rosshinkley yes still seeing this issue. Using electron 1.3.4 and nightmare 2.7.0 work fine. ,ecandino,rosshinkley
793,2016-11-08 15:48:24,"@rosshinkley Sorry about the delay, and thanks for the response! It's added in that evaluate function I pasted above. That's the 'onClick' method that gets called the button is clicked. Still stumped on this.. I will give 619 a read
",shanewignall,rosshinkley
790,2016-09-21 14:29:35,"Im not sure this is clear in the documentation because it states



Maybe providing an example with this basic usage provided in @rosshinkley's comment would make it easier to understand?
",Oted,rosshinkley
790,2016-09-29 14:18:35,"Hm, I think I see what you're saying, @Oted.  The problem here is defining what a ""load success"" is.  Any page that completes the HTTP request - be it an HTTP success (eg, a 200) or an HTTP failure (eg, a 404) - is considered a successful request.  The documentation should be worded more carefully to make that clearer.

_Edit:_ I take back what I said, and shouldn't have fired totally from the hip: this has come up before, and I had forgotten the documentation had already been updated.  The docs are pretty clear, I think:

> Note that any valid response from a server is considered “successful.” That means things like 404 “not found” errors are successful results for goto. Only things that would cause no page to appear in the browser window, such as no server responding at the given address, the server hanging up in the middle of a response, or invalid URLs, are errors.
",rosshinkley,Oted
780,2016-10-20 15:23:02,"Hi @rosshinkley,

Thanks for your response. XPath is the only available option to select elements by the inner text, for instance.

It's widely used on Selenium space, for example.

Thanks,
Gustavo
",gjmveloso,rosshinkley
780,2016-12-30 19:53:34,"@gjmveloso as @rosshinkley mentioned we've decided to keep css lookup for minimal simplicity. if there's a super clean, tested and ready-to-go PR may reconsider!",reinpk,rosshinkley
780,2016-12-30 19:53:34,"@gjmveloso as @rosshinkley mentioned we've decided to keep css lookup for minimal simplicity. if there's a super clean, tested and ready-to-go PR may reconsider!",reinpk,gjmveloso
779,2016-09-06 01:02:08,"@rosshinkley I've got two options:
- Going from a ""Page A"" and filling a form. Once submitted, it leads me to ""Page B"", which is a results page. 
- Or going straight to ""Page B"", but with a 'POST' method, and some Body `form-data` parameters. This will also lead me to the ""Page B"" results.
  Screenshot from Postman: 
  <img width=""905"" alt=""postman"" src=""https://cloud.githubusercontent.com/assets/5517450/18258786/8382a286-741f-11e6-91c9-c4295440a3bb.png"">

The second option would be quicker as I would skip the first page. I wondered is such a thing is possible with Nightmare. Something like:



Hope that's clear enough! Thanks :)
",jgrancher,rosshinkley
769,2016-10-27 04:17:18,"@rosshinkley In regards to your comment https://github.com/segmentio/nightmare/issues/769#issuecomment-244780554:

> Nightmare, by default, will wait for the did-stop-loading event. This event is typically emitted once the page is ""finished"" loading (be it from the original 20x completing or stop being called). At that point, the page should already be in a ready state. (Should. If it isn't, or you have a a countercase, I'd love to hear about it.)

I have opened https://github.com/segmentio/nightmare/issues/854 which provides a test case showing that there in fact is an issue with nightmare not finishing loading before moving on to the next chained method.
",bchr02,rosshinkley
767,2016-09-05 17:40:59,"Sorry for the delay, @scytalezero - yes, I'd go ahead and report it at Electron, which it looks like you've already done. :)

Would you mind linking to it here?
",rosshinkley,scytalezero
766,2016-08-30 08:42:54,"@rosshinkley  Thanks! :) [asynchronous operations and loops](https://github.com/rosshinkley/nightmare-examples/blob/master/docs/common-pitfalls/async-operations-loops.md) explanation helped me understand.

Script above is super basic, just to test this. Not much sense in there. :D

Thanks again!
",jelenajjo,rosshinkley
762,2016-08-19 21:55:32,"@shanewignall Quick update, yup. Just as I thought. In my case, the selector for the field was wrong. the querySelector was not matching anything. 

The interesting part is why it all the way in the blur event, and not in the while trying to put values in the element. Hope this helps you, too.
",jhenriquez,shanewignall
762,2016-08-22 17:20:35,"@jhenriquez Thanks for the info! I'll see if I can find the issue with  the previous field..
",shanewignall,jhenriquez
762,2016-08-22 19:38:26,"@jhenriquez so one of my issues was just having to use a 'wait' in a certain place. This allowed for the button to actually switch back to the parent form.. but then I still get the blur event error. After that happens, again, the script hangs. This is driving me nuts. The button that is clicked makes the form disappear, so the user sees the parent form, which is then focused on again. Why would it not be focusing back on the parent form like it should?
",shanewignall,jhenriquez
762,2016-08-22 20:12:42,"@shanewignall Well, my use case was way simpler I'm afraid :sweat_smile: but then again I believe it seems to be similar in nature. In my case I was only filling a form and clicking submit. Yet, my field selectors where actually incorrect. So, my selectors were not returning any elements so when nightmare tried to move from field one, to let's say field two (calling blur() on field one) the result is this error.

In your case, I believe it might be similar. By disappearing, I suppose we're not talking about only _hiding_, if the markup is being removed this could render all selectors associated with that previous form invalid.

I would suggest you dig a little bit into the libraries code, and do a quick debug to try and identify which selector is being handled that doesn't bring any results at that particular moment in time. I think the stack trace indicates directly where to look in this case.

Hope this helps. 
",jhenriquez,shanewignall
762,2016-08-29 21:17:30,"@rosshinkley Thanks for the response. I added a .wait('body') before and after the button click. Unfortunately, I still get the blur event about a second after the script clicks the button that makes the little inline-dialogue form disappear. I noticed that between clicking the button and the blur event error, a little banner appears and disappears on the page that just tells the user that the form was updated successfully. I wonder if this specific element disappearing and appearing causes a blur event? 

Also

@jhenriquez Looking back on your previous comment, I found that when I say the child form ""disappears"", the elements are actually dynamically removed from the page. This element is an inline-dialogue in the AUI framework. 
The thing is, I'm not trying to do anything with those elements after clicking the button to make the dialogue go away, so I _wouldn't think_ that this causes the issue..any thoughts?
",shanewignall,rosshinkley
762,2016-08-29 21:17:30,"@rosshinkley Thanks for the response. I added a .wait('body') before and after the button click. Unfortunately, I still get the blur event about a second after the script clicks the button that makes the little inline-dialogue form disappear. I noticed that between clicking the button and the blur event error, a little banner appears and disappears on the page that just tells the user that the form was updated successfully. I wonder if this specific element disappearing and appearing causes a blur event? 

Also

@jhenriquez Looking back on your previous comment, I found that when I say the child form ""disappears"", the elements are actually dynamically removed from the page. This element is an inline-dialogue in the AUI framework. 
The thing is, I'm not trying to do anything with those elements after clicking the button to make the dialogue go away, so I _wouldn't think_ that this causes the issue..any thoughts?
",shanewignall,jhenriquez
760,2016-08-17 21:26:23,"Hi @adityabansod.
About [#688](https://github.com/segmentio/nightmare/issues/688): its OK only for orphaned electron processes which really could cause a leak, but my  crawler clears everything between cycles with



This code being wrapped in try...catch cleans everything fine. 
By the way, the proposed solution in #688 isn't OK due to the Nightmare's architecture, cause after `end()` invocation `disconnect` will be invoked too and electron can throw an exception about its repeated invocation of the `disconnect`.

In my case everything is about so called **zombie callback**. It means that if you call `then(fn)` or do something like:



it means that if electron stuck your callback will never be invoked and your script will stuck as well.

But there is also a problem with stuck after `end()` invocation. I've found it recently. 
[Here](https://github.com/sizewhiz/nightmare/commit/e8c2ffefb012596ae13075dcb9ffe9c1d32ed8ce) I try to kill process by force if it wasn't killed yet. It's not good yet, but I do it for experiments only.
",pkantsedalov,adityabansod
759,2016-08-22 18:13:19,"@GWP this ended up solving the problem for me (as a workaround): https://github.com/segmentio/nightmare/issues/688#issuecomment-238473332
",adityabansod,GWP
758,2016-08-29 14:32:18,"I agree with @Mr0grog.  The examples should probably use plain promises to minimize external dependencies.
",rosshinkley,Mr0grog
756,2016-08-30 16:16:59,"@rosshinkley I have added the test for timeout when no element exists, and it passes. Above you mention ""one handling the element existing before the timeout"", this test existed already for the .wait(selector) call, so for the .wait(selector, timeout) call I just added a non-existent selector and 150ms to ensure it still passes, it does not pass if I just wait for the ul.

Is there another specific case you want me to test for?
",noahtkeller,rosshinkley
756,2016-09-05 16:02:09,"@noahtkeller I think this is probably sufficient for now.  Thanks!
",rosshinkley,noahtkeller
752,2016-08-10 13:18:18,"@albinekb: To reproduce, you have to use the instructions in the README, i.e. run it in the environment provided in the Dockerfile. For example, this uses node v5.12.0 if this matters. 
",rrva,albinekb
752,2016-08-17 21:34:59,"Great that you got it working @rrva 😊
",albinekb,rrva
751,2016-08-29 03:27:48,"@Snake4life ,  you may give this code a try - 


",flisky,Snake4life
750,2016-08-08 16:26:23,"@ivan-kleshnin What version of Nightmare are you using?  When I run your second example with 2.6.0, I get the expected behavior of typing in `#email`.
",rosshinkley,ivan-kleshnin
747,2016-08-03 00:53:26,"@Mr0grog hm, that's odd.  I'm curious what changed, but in this case, I _imagine_ fixing it first might be simpler.

And yeah, I think a modification to the circle yaml to run `nvm install` for possibly all three versions in the `pre` would work.  Thoughts? 
",rosshinkley,Mr0grog
746,2016-08-03 05:18:46,"It looks like the `resetChanges` method from    8015fe0 splices the `cookies` namespace out of existence, causing those tests to fail.

Otherwise, +1.  Thanks, @Mr0grog :)
",rosshinkley,Mr0grog
746,2016-08-04 03:37:00,"@rosshinkley Looks like the fix is passing the tests now. A merge and release will be appreciated.
",voidmonk,rosshinkley
744,2016-08-08 15:21:34,"@RichardJECooke Whether or not you have `show: true` when running under Docker does not make it headless or headed.  It makes the rendering on the framebuffer (most likely `Xvfb`) render as though it were visible.

Nightmare isn't _truly_ headless: it requires an Electron instance to work, which in turn requires a framebuffer to render properly (at least, for now).

Setting that aside: if you set `show: true` or `show: false` (the default), it will likely not run out-of-the-box on a Docker instance as Docker instances _are_ intended to be headless, and as such, don't typically have a framebuffer included on the image.  To do that, @voidmonk's suggestion stands: have a look at #224 regarding running with `Xvfb` or `xvfb-run`.  You may also want to have  a look at the test suite for Nightmare as that runs on a headless CircleCI server.
",rosshinkley,voidmonk
744,2016-08-08 15:21:34,"@RichardJECooke Whether or not you have `show: true` when running under Docker does not make it headless or headed.  It makes the rendering on the framebuffer (most likely `Xvfb`) render as though it were visible.

Nightmare isn't _truly_ headless: it requires an Electron instance to work, which in turn requires a framebuffer to render properly (at least, for now).

Setting that aside: if you set `show: true` or `show: false` (the default), it will likely not run out-of-the-box on a Docker instance as Docker instances _are_ intended to be headless, and as such, don't typically have a framebuffer included on the image.  To do that, @voidmonk's suggestion stands: have a look at #224 regarding running with `Xvfb` or `xvfb-run`.  You may also want to have  a look at the test suite for Nightmare as that runs on a headless CircleCI server.
",rosshinkley,RichardJECooke
744,2016-09-01 19:06:44,"@RichardJECooke perhaps this docker image https://hub.docker.com/r/smtx/nightmarejs-webservice/ helps you build your nightmare app inside a docker container.

Here is the Dockerfile: https://hub.docker.com/r/smtx/nightmarejs-webservice/~/dockerfile/
",smtx,RichardJECooke
744,2016-09-10 16:04:50,"> https://github.com/segmentio/nightmare/issues/744#issuecomment-236570644

@RichardJECooke I agree, having that information there would be helpful. I just started using the example and noticed it opened a window, which is great while debugging but when I did a search on README.md for headless or hide, to my surprise I did not get an answer. So, having this would have saved me some time from continuing to dig for an answer or having to read the electron docs.
",bchr02,RichardJECooke
740,2016-07-30 16:26:04,"@voidmonk Out of curiosity, what version of nightmare are you using?

@Mr0grog is right, the provisional load failure is causing an exception.  In your last comment, that exception is handled, and should work fine (although your `.then()` that handles the status code will not be called).
",rosshinkley,Mr0grog
740,2016-07-30 16:26:04,"@voidmonk Out of curiosity, what version of nightmare are you using?

@Mr0grog is right, the provisional load failure is causing an exception.  In your last comment, that exception is handled, and should work fine (although your `.then()` that handles the status code will not be called).
",rosshinkley,voidmonk
740,2016-07-31 00:59:40,"@rosshinkley Using Nightmare 2.5.3 (latest on npm I suppose).

Tested a bit more, but HTTP 304 is still hanging, and it doesn't raise any exception. All other HTTP errors invoke `catch` via `Promise.reject` in the first `then`.
",voidmonk,rosshinkley
740,2016-07-31 18:10:36,"@voidmonk Hmmm, v2.5.3 does not hang for me using the exact same code you pasted above (save substituting `'https://httpbin.org/status/304'` for `url`). Are you sure that’s exactly the code you’re using?
",Mr0grog,voidmonk
740,2016-08-01 00:43:02,"@Mr0grog Yeah, same code. It times-out, but doesn't end gracefully. Try running it verbose: `DEBUG=* node 304test.js`. You'll see that there's no activity after `did-stop-loading` event, until it eventually times-out.

I think the expected behaviour for a 304 response should be for the Nightmare process to be terminated instantly (as Chrome does to the request) rather than wait endlessly & timeout. I was [told by the Electron guys](https://github.com/electron/electron/issues/6657#issuecomment-236465680) that it needs to handled by checking the response code in the `did-get-response-details` event.

Here's the modified full code, but now how do we suspend further events and end the Nightmare process on HTTP 304:


",voidmonk,Mr0grog
740,2016-08-01 06:07:45,"@Mr0grog That's strange. It just hangs for me on HTTP 304 until timeout. I'm using:

Ubuntu 14.04.2 LTS on AWS
Node.js v6.3.0
Electron (electron-prebuilt) v1.3.1
Nightmare v2.5.3
",voidmonk,Mr0grog
740,2016-08-02 23:44:21,"@Mr0grog Ah ok. So it this a bug in Electron or Nightmare? Any workaround to it?
",voidmonk,Mr0grog
740,2016-08-03 00:32:57,"@voidmonk It’s more a bug in Nightmare than anything else, but only caused because Electron changed its behavior ¯\_(ツ)_/¯

No workaround that I can think of, sorry. #746 fixes it, though.
",Mr0grog,voidmonk
740,2016-08-03 00:54:05,"@Mr0grog Thanks for looking into it, and for the quick fix!

Hoping for it to be merged and released to npm soon.
",voidmonk,Mr0grog
740,2016-08-03 05:20:28,"@voidmonk The fix wasn't included as it has a test issue that needs to be addressed. As soon as it's fixed, I'll pull it in and cut another release.
",rosshinkley,voidmonk
740,2016-08-03 05:23:08,"@rosshinkley Oh ok, no worries. Thanks again. I'll await the next release.
",voidmonk,rosshinkley
740,2016-09-05 16:05:01,"@geostant I'd suggest opening a new issue with a minimum repro case.
",rosshinkley,geostant
740,2016-09-06 01:52:08,"@geostant I cannot reproduce with nightmare 2.6.1 or later with electron 1.3.4 or later. Using the @voidmonk's example code from https://github.com/segmentio/nightmare/issues/740#issuecomment-236467461 .

If you can provide a reproducible test case, I’ll look at it. Otherwise I can’t seem to get the behavior you are seeing.
",Mr0grog,geostant
740,2016-09-06 01:52:08,"@geostant I cannot reproduce with nightmare 2.6.1 or later with electron 1.3.4 or later. Using the @voidmonk's example code from https://github.com/segmentio/nightmare/issues/740#issuecomment-236467461 .

If you can provide a reproducible test case, I’ll look at it. Otherwise I can’t seem to get the behavior you are seeing.
",Mr0grog,voidmonk
740,2016-09-06 01:52:52,"And as @rosshinkley noted, better to open a new issue when you have reproducible example :)
",Mr0grog,rosshinkley
737,2016-07-29 01:28:19,"Thanks @johnferro. An internal chain of steps worked, but it doesn't seem right (`wait` won't be queued etc):



Hopefully @rosshinkley or someone with a better understanding of Nightmare can confirm the validity and object disposal.
",voidmonk,johnferro
737,2016-07-29 23:16:45,"Thanks @Mr0grog, that looks much cleaner.

On a related note, the process hangs if response code is HTTP 304: issue #740. Any clues on that one?!
",voidmonk,Mr0grog
735,2016-08-29 15:01:31,"@Snake4life The proxy server is set up for every request from Electron.  Are you not seeing that behavior?
",rosshinkley,Snake4life
731,2016-08-21 16:58:41,"@vshvydky How did you do it? I tried:



but images are still loaded... (unless they are cached?)
Thanks
",sebastienbarre,vshvydky
730,2016-07-24 21:42:09,"@Stankye: @vshvydky's answer is on the right track, but unfortunately won't work: `document.querySelectorAll` returns a DOM element collection, which like `arguments` isn't actually an array.  

From the hip, something like:



...might work.

If I'm reading the [spec](https://www.w3.org/TR/DOM-Level-2-HTML/html.html#ID-2651361) right, though (and it is _entirely_ possible I'm not), that will only work for `input`s.  If you want to use it on a generic element, you'll want to emit the click event yourself:



Do either of those work for you?
",rosshinkley,vshvydky
730,2016-07-24 21:42:09,"@Stankye: @vshvydky's answer is on the right track, but unfortunately won't work: `document.querySelectorAll` returns a DOM element collection, which like `arguments` isn't actually an array.  

From the hip, something like:



...might work.

If I'm reading the [spec](https://www.w3.org/TR/DOM-Level-2-HTML/html.html#ID-2651361) right, though (and it is _entirely_ possible I'm not), that will only work for `input`s.  If you want to use it on a generic element, you'll want to emit the click event yourself:



Do either of those work for you?
",rosshinkley,Stankye
728,2017-01-26 06:20:34,"Ah, so this is why everything is blowing up! `nightmare` doesn't support concurrency. 👎
@cchamplin do you plan on reviving this PR or should I pick up the torch? 😄 

edit: https://github.com/Timer/nightmare/commit/803732b1b33936500b1a6918efc1f067b5253bad",Timer,cchamplin
726,2016-09-06 14:06:59,"@rosshinkley They did not auto-size the viewport to the content. Instead I had to do all of this:


",stevenvachon,rosshinkley
725,2016-08-08 15:13:09,"@varsano Upgrade NodeJS.  Nightmare will not work with anything <4.x.
",rosshinkley,varsano
725,2017-01-28 10:07:42,"Hey,
First of all thanks allot for you answer, it got lost in my tons of emails
and i already managed by my self.
Now that i see you answer i run into a problem when scrapping a webpage:
i scroll to the bottom of the page and every scroll actually triggers a
request with a response and i want to store this response without any luck
screenshot:
[image: Inline images 1]

[image: Inline images 2]



how can i do it?
The page that i am trying to scrap written in AngularJS and i know that the
response that i am looking for i stored somewhere on
*window.self.$scope.ctrl._ads* but i found it only once and it happen after
a several of events that i can't reproduce.

please help since this a really important project that i have to finish in
a couple of days

Thanks allot for your help and great day


On 8 August 2016 at 17:13, Ross Hinkley <notifications@github.com> wrote:

> @varsano <https://github.com/varsano> Upgrade NodeJS. Nightmare will not
> work with anything <4.x.
>
> —
> You are receiving this because you were mentioned.
> Reply to this email directly, view it on GitHub
> <https://github.com/segmentio/nightmare/issues/725#issuecomment-238268811>,
> or mute the thread
> <https://github.com/notifications/unsubscribe-auth/AOqEzp1fRuYss6T0I4ANBCdgQq1oYxh6ks5qd0eLgaJpZM4JMD6C>
> .
>
",varsano,varsano
723,2016-07-14 18:53:21,"@rosshinkley correct, that is what i'm trying to do. However, i've also tried explicitly doing that, by Object.keys it, however in both cases the return is an empty array [object]. Unless you meant something completely different.
",xmen4u,rosshinkley
723,2016-07-22 21:36:39,"@xmen4u Could you post an example?  I want to be sure we're on the same page.
",rosshinkley,xmen4u
723,2016-07-22 22:16:02,"@rosshinkley: sure:

`nightmare.viewport(800,600).goto(url)wait().evaluate(()=>document.getElementById('selector').getBoundingClientRect()).then(bounds=>console.log(bounds. .... )).catch(...)`

where the console.log can be specific or JSON.stringify, i've tested both. 
",xmen4u,rosshinkley
723,2016-07-24 03:27:05,"@rosshinkley Thank you so much! this seems to work!
",xmen4u,rosshinkley
723,2016-12-17 02:57:38,"@sebastienbarre Memory serving, they're in pixels... you _might_ want to open a new issue (if you haven't already) with an example.",rosshinkley,sebastienbarre
712,2016-07-08 18:34:33,"@AVVS are those files available publicly?  The links you provided all 404.

Maybe you could post the relevant parts here or in a gist?
",rosshinkley,AVVS
712,2016-07-08 18:42:27,"@rosshinkley restored branch so you can see the code, logs are also available again on this same build
",AVVS,rosshinkley
712,2016-07-26 12:42:46,"@AVVS Most crashes in electron in my experience are due to invalid selectors, run electron with the verbose flag, it should reveal invalid selectors (or whatever else is making it crash).
",inakianduaga,AVVS
712,2016-08-08 16:58:27,"@AVVS Is this resolved?
",rosshinkley,AVVS
712,2016-08-09 15:26:18,"@rosshinkley not yet, still playing with this. Please leave this issue opened and I'll let you know
",AVVS,rosshinkley
712,2016-12-07 17:22:42,@inakianduaga : how to run electron with verbose flag ?,GautierT,inakianduaga
712,2016-12-07 17:40:39,@rosshinkley recent versions seem fine & thanks for the tips,AVVS,rosshinkley
712,2016-12-17 03:24:42,"@AVVS No problem, glad you got it sorted.",rosshinkley,AVVS
710,2016-07-09 10:21:40,"@rosshinkley https://www.npmjs.com/package/nightmare-iframe
https://github.com/segmentio/nightmare/issues/203
",div3rse,rosshinkley
709,2016-07-07 12:02:36,"Thanks @icaromh for your information. Actually ajax is just an example, I actually want to know how to handle the async case, because with phantomjs, if you execute a javascript function on the page you open, there is an API called `window.callPhantom` to communicate with the phantom process outside, so the async handler won't be a problem. I just want to ask whether there are corresponding solution in nightmarejs
",goddyZhao,icaromh
709,2016-07-08 18:31:05,"@goddyZhao This is one of the things that #573 was attempting to address.  Currently, there is no way to allow for asynchronous actions in `.evaluate()` out of the box.
",rosshinkley,goddyZhao
708,2016-11-02 21:11:17,"@pinguinoholdings check out this [repo](https://github.com/rosshinkley/nightmare-examples), maybe it can help you.
",alfonsomga,pinguinoholdings
708,2016-11-02 22:29:23,"Thanks @alfonsomga 

My use case was logging into a site, and then clicking through an unknown number of ""OK"" button prompts before I could get to the page I was looking for.  Being an unknown number, I couldn't make it work by nesting .then() statements, not to mention how to exit the check.  This is most likely not the most elegant solution, but it works.

For anyone following along later, hopefully this can provide a start...


",pinguinoholdings,alfonsomga
708,2016-11-02 23:01:43,"@pinguinoholdings I would recommend you to use [vo control flow library](https://github.com/matthewmueller/vo) to achieve it.

Here's an example code:



As you can see it's pretty simple and straightforward.
",alfonsomga,pinguinoholdings
706,2016-07-01 22:00:52,"@rosshinkley Oh man - I totally overlooked the casing being off... that solved it - so sorry to have bugged you for that. Thanks a ton for your excellent help!!!
",bradleygore,rosshinkley
703,2016-07-04 06:47:04,"@rosshinkley Thank you very much for your help.
",felix185,rosshinkley
695,2016-07-08 17:41:15,"@OleVik Specifically, I was referring to the scrollbar/title et al eating into the pixel count.  I think that might be _part_ of the problem.  The buffer height being incorrect is distressing.

I know there is a problem where you cannot create a window larger than the display size on Windows (see electron/electron#4932 and possibly electron/electron#5053), but resetting the viewport (which calls `BrowserWindow.setSize()` under the covers) _should_ work.

Out of curiosity: can you set the height using `.viewport()` to something big but smaller than the size returned?  Something on the order of `.viewport(dimensions.width, 4000)`?  (I wonder if you're possibly hitting a texture limit and Chromium is misbehaving because of it.)
",rosshinkley,OleVik
695,2016-07-30 16:15:03,"@OleVik Out of curiosity, what happens if you try to snap a screenshot of say, `.viewport(4000,4000)`?

A while back, I wrote a quick and dirty [gist](https://gist.github.com/rosshinkley/b5fb5061073756e926b791a66d62b24b) that spit out the max texture size - I wonder if that could be ported to use opengl and freeglut for Windows?
",rosshinkley,OleVik
695,2017-01-12 22:56:34,"@jimmaay/@OleVik, can you try 
var nightmare = new Nightmare({ minHeight:7119, minWidth:1000 });

It worked for me.",BhavinPatel04,jimmaay
695,2017-01-12 22:56:34,"@jimmaay/@OleVik, can you try 
var nightmare = new Nightmare({ minHeight:7119, minWidth:1000 });

It worked for me.",BhavinPatel04,OleVik
695,2017-01-12 23:39:32,"@BhavinPatel04 It is indeed much closer to the expected output than before. Using Nightmare v2.9.1, running the same script as before but with



The returned image is 1914px wide and 7060px high. Apart from the small error margins in dimension, which presumably could be offset with higher `min`-properties, there is a fairly large discrepancy with set `width` and `height`. When I add in `maxHeight:2000` and `maxWidth:2000`, as suggested by @mkmkku, the returned image is 1990px wide and 7060px high.

I should add, the output of `console.dir(dimensions);` is `{ height: 7144, width: 993 }`, so there is also a discrepancy between how big Nightmare measures the target to be, and what the output is, at least with the setup from the initial post updated with the above.",OleVik,BhavinPatel04
695,2017-01-12 23:39:32,"@BhavinPatel04 It is indeed much closer to the expected output than before. Using Nightmare v2.9.1, running the same script as before but with



The returned image is 1914px wide and 7060px high. Apart from the small error margins in dimension, which presumably could be offset with higher `min`-properties, there is a fairly large discrepancy with set `width` and `height`. When I add in `maxHeight:2000` and `maxWidth:2000`, as suggested by @mkmkku, the returned image is 1990px wide and 7060px high.

I should add, the output of `console.dir(dimensions);` is `{ height: 7144, width: 993 }`, so there is also a discrepancy between how big Nightmare measures the target to be, and what the output is, at least with the setup from the initial post updated with the above.",OleVik,mkmkku
694,2016-06-23 09:40:58,"This is fixed with electron `1.2.5` and `electron-prebuilt` is released.
So run `npm install` again and it should work 😄 
close? @oncletom
",albinekb,oncletom
694,2016-07-30 15:53:00,"@trompx `XRANDR` being missing is not that big of a deal; unless you're explicitly loading it with `Xvfb` (or whatever X buffer you're using), that line is going to show up, serving as a warning that you will not be able to resize and rotate your buffer.  The original problem with this thread had to do with how Electron was being started, and on certain flavors of Linux, was crashing, which would cause Nightmare to misbehave.
",rosshinkley,trompx
693,2016-08-08 16:55:48,"@LinusU Bumping this thread - did you either get this resolved or put together a test case?
",rosshinkley,LinusU
688,2016-08-03 05:54:25,"@AaronTrazona or @rosshinkley, it has been about a month since there was activity on this thread. ny further headway made on this? On my end, I have electron processes hanging around when my app is idle and nightmare.end() has been called. 

Was any route cause or solution found?
",mashaalmemon,rosshinkley
688,2016-08-03 05:54:25,"@AaronTrazona or @rosshinkley, it has been about a month since there was activity on this thread. ny further headway made on this? On my end, I have electron processes hanging around when my app is idle and nightmare.end() has been called. 

Was any route cause or solution found?
",mashaalmemon,AaronTrazona
688,2016-08-03 15:05:37,"@TimNZ that makes a whole lot of sense. I've experienced this on MacOSX as well as on linux (specifically running in a docker instance so the flavour of linux is the one that the official ""node:6.2.2"" is based on).

Hopefully there is a solution that can be used cross platform. I am attempting to use nightmare in a production environment but can't until this problem is solved.
",mashaalmemon,TimNZ
688,2016-08-08 15:43:57,"@TimNZ If I'm understanding the problem properly (and it is _thoroughly_ possible I am not), this would mean either that `ChildProcess.kill()` isn't actually killing the child process, meaning Electron isn't honoring `SIGTERM`, or there is some edge case for ending the process that isn't handled properly.  (The latter seems _far_ more likely.)

I am curious to see a reproduction - that would be most informative.
",rosshinkley,TimNZ
688,2016-09-28 13:25:25,"@rafalneves Can you give more info your comment is not really constructive what did you test what is not fixed?
",daniel3d,rafalneves
688,2016-09-28 20:13:10,"I just replied to the previous comment. I tried to run the latest code (that includes #757 commited code) and I run into same problem (electron instances are not destroyed). Right now I'm using the fix proposed by @voidmonk that solved the issue.

I was using debian 8. Was an sporadic need, so I didn't test it anywhere else.
If I can assist you more, let me know.
",rafalneves,voidmonk
688,2016-12-20 21:55:17,"@itomas i'm unable to reproduce the issue

>  Electron instances is not destroyed 

after executing the script you provided. Electron is closed correctly only thing I had to do to make it run was to add `.then()` otherwise the script is not working try running this on your machine and let me know if you still experiencing the same issue.



`os` Microsoft Windows [Version 6.3.9600] - Windows 8.1
`node` 6.9.1
`electron` 1.3.2
`nightmare`  2.9.0

> Note that if you're using promises, `.then()` must be called after `.end()`
[check the above here](https://github.com/segmentio/nightmare#end)
",daniel3d,itomas
687,2016-06-21 13:51:57,"@rosshinkley updated, thanks for the review
",agrberg,rosshinkley
682,2016-06-13 12:50:36,"Thanks @mrjj but I think we still doesn't have a _workaround_ on this, right?
",gjmveloso,mrjj
682,2016-06-13 22:43:48,"@gjmveloso, please, see my answer in related bug #680
",mrjj,gjmveloso
680,2016-06-14 00:06:17,"Thanks for your help @mrjj and @rosshinkley - I'd completed forgot about the _asynchronous_ thing.

But I think I'm still doing something wrong :cry: 

Here is my complete code:



I'm receiving the following error message:

> TypeError: browser.goto(...).title(...).evaluate(...).exists(...).then(...).then
> (...).end is not a function
>     at Object.<anonymous> (C:\Code\test\app.js:16:6)
>     at Module._compile (module.js:541:32)
>     at Object.Module._extensions..js (module.js:550:10)
>     at Module.load (module.js:458:32)
>     at tryModuleLoad (module.js:417:12)
>     at Function.Module._load (module.js:409:3)
>     at Function.Module.runMain (module.js:575:10)
>     at startup (node.js:160:18)
>     at node.js:456:3

**Line 16 is on _end()_ call**

Thanks again, really appreciated your help
",gjmveloso,rosshinkley
680,2016-06-14 00:06:17,"Thanks for your help @mrjj and @rosshinkley - I'd completed forgot about the _asynchronous_ thing.

But I think I'm still doing something wrong :cry: 

Here is my complete code:



I'm receiving the following error message:

> TypeError: browser.goto(...).title(...).evaluate(...).exists(...).then(...).then
> (...).end is not a function
>     at Object.<anonymous> (C:\Code\test\app.js:16:6)
>     at Module._compile (module.js:541:32)
>     at Object.Module._extensions..js (module.js:550:10)
>     at Module.load (module.js:458:32)
>     at tryModuleLoad (module.js:417:12)
>     at Function.Module._load (module.js:409:3)
>     at Function.Module.runMain (module.js:575:10)
>     at startup (node.js:160:18)
>     at node.js:456:3

**Line 16 is on _end()_ call**

Thanks again, really appreciated your help
",gjmveloso,mrjj
679,2016-08-08 16:55:12,"@rluisr Did you get this resolved?
",rosshinkley,rluisr
679,2016-12-17 04:13:49,"Thanks, @Siilwyn.  Going to consider this resolved, closing.",rosshinkley,Siilwyn
674,2016-06-08 15:26:03,"@rosshinkley I just want to open an additional electron window to display the scraped image.
",Nisthar,rosshinkley
669,2016-12-17 04:55:15,@BerlinaLI I have a suspicion you might be hitting #224.  Thoughts?,rosshinkley,BerlinaLI
665,2016-06-10 00:06:55,"@rosshinkley : you need to use authentication() with setting 'proxy-server' (with out user + password)
",xmen4u,rosshinkley
665,2016-06-10 06:43:43,"@xmen4u can you clarify, is this what should work, or something that you have actually effectively worked with? In case it's the latter, can you please provide exact code example and I will test it also.

I got the proxy authentication to work on Electron, but would prefer to use Nightmare if possible. At the moment, given that there are no specific detailed answers to this issue, unless someone provides a working code example, my suggestion is to assume that proxy authentication does not work. 
",mikkokotila,xmen4u
665,2016-06-10 19:12:58,"@mikkokotila:



Works well. Changing the proxy during run-time is an issue i couldn't figure out how.
",xmen4u,mikkokotila
665,2016-06-16 16:24:06,"Thanks @xmen4u for the answer and @mikkokotila for already posting what I needed help with. I've added this information to the Read me for others to find more easily in PR #687.
",agrberg,xmen4u
665,2016-06-16 16:24:06,"Thanks @xmen4u for the answer and @mikkokotila for already posting what I needed help with. I've added this information to the Read me for others to find more easily in PR #687.
",agrberg,mikkokotila
656,2016-05-22 15:50:15,"@kuyoonjo Be sure you're calling `.then()` after `.end()`.  That will run the queued actions (if any) and end Nightmare gracefully.
",rosshinkley,kuyoonjo
656,2016-05-22 15:50:53,"@kuyoonjo also, if you have a more complete example, I'd like to see it.  I might be able to help more that way.
",rosshinkley,kuyoonjo
650,2016-05-20 15:28:18,"@oliviervaillancourt Part one looks great, thanks for fixing that.  Part two I'd _probably_ leave as simply `example.js`.  The example is in the root of the project directory and is (I think) fairly obvious which example we're referring to.  The only remaining thing I can think of is possibly changing the README to say `example.js` instead of `yahoo.js` under the Examples heading on line 55 (which isn't your fault, I think it's been that way for quite a while).

@Mr0grog Thoughts?
",rosshinkley,oliviervaillancourt
650,2016-05-20 15:35:36,"Oh, ha, paths, didn’t even think about how those would be different on Windows when I noted it in #643 :(
Probably agree with @rosshinkley there.
",Mr0grog,rosshinkley
650,2016-05-20 15:54:52,"Sounds good to me.  I can make the change later on today and update the PR
(I guess this is doable, I've never tried to update a PR before)

Thanks

On Fri, May 20, 2016 at 11:35 AM, Rob Brackett notifications@github.com
wrote:

> Oh, ha, paths, didn’t even think about how those would be different on
> Windows when I noted it in #643
> https://github.com/segmentio/nightmare/pull/643 :(
> Probably agree with @rosshinkley https://github.com/rosshinkley there.
> 
> —
> You are receiving this because you were mentioned.
> Reply to this email directly or view it on GitHub
> https://github.com/segmentio/nightmare/pull/650#issuecomment-220639655
",oliviervaillancourt,rosshinkley
650,2016-05-20 15:55:51,"@oliviervaillancourt just make another commit on the same branch and it’ll automatically get picked up :)
",Mr0grog,oliviervaillancourt
650,2016-05-20 17:07:44,"Thanks Rob,

I'll try that tonight.

On Fri, May 20, 2016 at 11:55 AM, Rob Brackett notifications@github.com
wrote:

> @oliviervaillancourt https://github.com/oliviervaillancourt just make
> another commit on the same branch and it’ll automatically get picked up :)
> 
> —
> You are receiving this because you were mentioned.
> Reply to this email directly or view it on GitHub
> https://github.com/segmentio/nightmare/pull/650#issuecomment-220645336
",oliviervaillancourt,oliviervaillancourt
650,2016-05-21 00:38:48,"Hey @rosshinkley and @Mr0grog,

I think I've updated this PR with the outcome of the discussion by simply stating `example.js` on line 55.

Let me know if you feel this should be done otherwise.

Thanks for your help
",oliviervaillancourt,Mr0grog
650,2016-05-21 00:38:48,"Hey @rosshinkley and @Mr0grog,

I think I've updated this PR with the outcome of the discussion by simply stating `example.js` on line 55.

Let me know if you feel this should be done otherwise.

Thanks for your help
",oliviervaillancourt,rosshinkley
650,2016-05-27 16:09:49,"Looks great.  Marking for inclusion.  Thanks for the effort, @oliviervaillancourt!
",rosshinkley,oliviervaillancourt
643,2016-05-18 16:08:16,"Hi @oliviervaillancourt, the selectors in the README were specifically chosen to be more robust against the regular changes Yahoo makes and they do still work: https://github.com/segmentio/nightmare/pull/613

It looks to me like it’s just `example.js` that is out of date (my bad; I completely failed to update it in the above PR.)
",Mr0grog,oliviervaillancourt
643,2016-05-19 00:51:36,"@oliviervaillancourt Right, your issues are with:
- README should say to run `node node_modules/nightmare/example.js`
- The actual content of `example.js` doesn’t match the example in the README

Both of those things totally need to be fixed! :thumbsup: on your PR changing those. I was only trying to say that it probably shouldn’t change the example code (changing the shell command is good) that is currently in the README (and, where it changes `example.js`, it should match the code in the README). Sorry if I worded it poorly!
",Mr0grog,oliviervaillancourt
643,2016-05-19 15:23:37,"@oliviervaillancourt just to +1 what @Mr0grog was saying: _please_, by all means, keep going.  The more contributors, the more people we have involved, the better. :)
",rosshinkley,Mr0grog
643,2016-05-19 15:23:37,"@oliviervaillancourt just to +1 what @Mr0grog was saying: _please_, by all means, keep going.  The more contributors, the more people we have involved, the better. :)
",rosshinkley,oliviervaillancourt
641,2016-05-18 14:36:33,"@Mr0grog Thanks for the comments!
",LinusU,Mr0grog
640,2016-05-20 15:38:33,"@Mr0grog I saw. :)  Doing my best to be thorough.

This looks good.  +1 to you sir.
",rosshinkley,Mr0grog
639,2016-05-18 07:58:37,"@Mr0grog your example works perfectly, but using `realClick` on a React button still doesn't work for some reason. I either get 'parent doesn't respond to .realClick' or just nothing happens. But thank you for the investigation nonetheless 👍 
",timotgl,Mr0grog
638,2016-05-17 19:19:49,"@atomless since you’re using Ava (I think?), you could do something like:


",Mr0grog,atomless
638,2016-05-18 15:32:25,"@Mr0grog nice idea! Thanks.
",atomless,Mr0grog
636,2016-05-18 15:31:16,"Hi @Mr0grog - well, that's a good thought, but the thing is I can run `Object.keys(...)` without error from everywhere in my test scripts with no error at all. I only get the error when it's run from within a function in a `wait()` or `evaluate()` call.
",atomless,Mr0grog
636,2016-05-18 17:16:35,"@Mr0grog yep - you must be right. I find it quite surprising that Ava's babel transpiler would mess with Object.keys though!
",atomless,Mr0grog
635,2016-05-22 16:40:43,"@RoryJShevin Can you post a minimum reproduction of this problem?  Also, what version of Nightmare are you using?

I've tried to reproduce this problem with a ~15mb and ~500mb page and cannot.
",rosshinkley,RoryJShevin
632,2016-05-31 15:50:18,"@LinusU It works fine with 1.0.x and (memory serving) 1.1.x, but some of the tests involving `webSecurity` break with 1.2.x.  I believe it's symptoms of electron/electron#5712, which have been fixed but as yet unreleased (at least with `electron-prebuilt`).  

I'm comfortable upgrading to a non-breaking version in the meantime, barring protest.  Thoughts?
",rosshinkley,LinusU
632,2016-06-02 11:11:15,"@rosshinkley @LinusU 
`1.2.1` is now released in `electron-prebuilt` https://www.npmjs.com/package/electron-prebuilt
I ran the tests with `1.2.1` and everything passes 🎉 
",albinekb,rosshinkley
632,2016-06-02 11:11:15,"@rosshinkley @LinusU 
`1.2.1` is now released in `electron-prebuilt` https://www.npmjs.com/package/electron-prebuilt
I ran the tests with `1.2.1` and everything passes 🎉 
",albinekb,LinusU
632,2016-06-07 09:45:28,"ping @rosshinkley @matthewmueller 
",albinekb,rosshinkley
632,2016-06-07 23:42:09,"@albinekb This will get pulled into the next version. :)
",rosshinkley,albinekb
631,2016-05-13 17:22:55,"@Muyv This is an issue in `electron-prebuilt` and I believe it’s already been filed: https://github.com/electron-userland/electron-prebuilt/issues/125 (but you should make sure that bug matches what you’re experiencing)
",Mr0grog,Muyv
631,2016-05-18 17:10:25,"@Muyv Is this resolved?
",rosshinkley,Muyv
631,2016-05-19 03:38:42,"@rosshinkley Nope, maybe this issue is WINDOWS-only, I tried to do it in CentOS, eveything goes well.
",Muyv,rosshinkley
631,2016-05-19 03:53:32,"@Mr0grog Thx, It seems a compatibility problem of `electron-prebuilt`. In fact I've already used another Phantomjs bridge to realize my requirements.
",Muyv,Mr0grog
629,2016-05-10 16:28:32,"Thanks @Mr0grog. I'll go and give it a try again. Thanks for your help.
",chrisgeo,Mr0grog
629,2016-05-11 16:50:06,"Hey @Mr0grog,

Sorry for opening this up again, but looking at the promise example, I'm not positive generators would work inside of it.

Here's an example based on your suggestion:



It's possible for my use-case that using the generator form may be better altogether because I have other actions that need to occur after `.then`, an example building off the original, 
- Login fails, fail and take screenshot
- Login success, go to the next page
  - do a few actions
  - take a screenshot.
",chrisgeo,Mr0grog
628,2016-05-10 13:21:50,"@Mr0grog Thanks. 

Yes, I can see I should have provided more context with my question. Specifically, I am using Nightmare.js with the testing framework [Ava](https://github.com/sindresorhus/ava) - (incidentally Nightmare and Ava almost feel made for each other!).

I am writing a series of functional tests for my app, that run in serial and tend to each perform a small action and/or then test a single part of my app's state. So they tend to look a lot like this:


",atomless,Mr0grog
628,2016-05-11 08:31:20,"I agree with @Mr0grog, and I think that it would be weird API-wise if `wait` returned a `Promise<bool>`.

I've been using Ava with Nightmare as well and a just to `await browser.wait(...)`, it will throw an error if the promise is rejected.
",LinusU,Mr0grog
628,2016-05-11 09:07:14,"@Mr0grog yes, you are correct that you could choose not to use the assertion and it would still work - although I'd still like to attempt to have a descriptive fail message - unfortunately when ava times out the error message is not shown even with the assertion :(
",atomless,Mr0grog
628,2016-05-13 14:49:07,"@LinusU Bingo - set Ava's timeout so that it's longer than the 30s Nightmare.js wait timeout and I now get the proper test failure message when the wait times out. Thanks!
",atomless,LinusU
628,2016-05-13 16:59:48,"@atomless you can also reduce how long `wait` waits if you need:



Would only wait 5 seconds.
",Mr0grog,atomless
628,2016-05-13 17:06:47,"@Mr0grog even better - thanks!
",atomless,Mr0grog
628,2016-05-18 17:06:28,"@atomless Is this issue resolved?
",rosshinkley,atomless
628,2016-06-01 03:56:41,"@atomless 
Is not more easy use `JSDOM` instead `Nightmare` for your test?

But if you really want use `AVA` + `Nightmare` you can use `test.cb`

**Example**


",lagden,atomless
627,2016-05-09 13:10:54,"@rosshinkley Thanks for the answer. Your fork looks awesome, just one thing I cannot get pagination to works. Is there anything special I need to config?
",ivawzh,rosshinkley
620,2016-07-01 16:21:08,"@dcshapiro What version of node and nightmare?
",rosshinkley,dcshapiro
620,2016-07-01 18:14:12,"@dcshapiro [Nightmare requires 4.x or higher.](https://github.com/segmentio/nightmare#node-versions)  See also #621.

I _think_ you might still be able to get away with using 0.12.x and `--harmony`, but your mileage may vary.
",rosshinkley,dcshapiro
619,2016-05-06 18:54:13,"@maiopirata your code above seems perfectly correct. What are you expecting to have happen? Do you have a `click` event listener on the `div` or on an element that contains it? When you dispatch a simulated event this way, an element _inside_ the div at the given position _will not receive the event._ This will also not automatically trigger the relevant `mousedown` and `mouseup` events, so if you are actually listening for those, your listeners will not be triggered.

It is also worth noting that none of the default behaviors that a browser does will be triggered when you dispatch events this way (that’s why you might want to use `webContents.sendInputEvent` as @rosshinkley mentioned—that _will_ cause default browser behaviors).

Side note: you can actually get the position of the element relative to the viewport much more easily than you are doing above:


",Mr0grog,maiopirata
619,2016-05-06 18:54:13,"@maiopirata your code above seems perfectly correct. What are you expecting to have happen? Do you have a `click` event listener on the `div` or on an element that contains it? When you dispatch a simulated event this way, an element _inside_ the div at the given position _will not receive the event._ This will also not automatically trigger the relevant `mousedown` and `mouseup` events, so if you are actually listening for those, your listeners will not be triggered.

It is also worth noting that none of the default behaviors that a browser does will be triggered when you dispatch events this way (that’s why you might want to use `webContents.sendInputEvent` as @rosshinkley mentioned—that _will_ cause default browser behaviors).

Side note: you can actually get the position of the element relative to the viewport much more easily than you are doing above:


",Mr0grog,rosshinkley
619,2016-05-06 21:41:58,"Thank you @Mr0grog for your answer. I will definitely test webContents, it seems that this is the point.
Thank you also that you show me bounds.left, top.. It would have saved me a lot of time knowing it some days before.

I will let you know soon
",maiopirata,Mr0grog
619,2016-05-10 18:42:44,"I'm trying to do similar as well. I want to write automation tests for canvas drawing and need to do mousemove/mousedown/mouseup at a specific coordinate (x,y).

Is there any reason _not_ to attempt to expose a method like sendEvent that PhantomJS has? 
http://phantomjs.org/api/webpage/method/send-event.html

For this specific use case, I was able to get sendEvent working with PhantomJS events, but would prefer Nightmare because it's just a lot nicer/cleaner overall. Initially I just assumed it was an Electron bug/ swallowed event, but figured I'd ask first if it was working as intended. 

@rosshinkley I'm not sure this is fancy, but I'm not sure how to make the driver yet either. :)
",dsowsy,rosshinkley
619,2016-05-10 21:47:48,"@rosshinkley do you have any idea why the `click()` (and `mouseover/mousedown`) action doesn’t use `sendInputEvent`? Assuming no, since according to git, they pretty much appeared out of whole cloth, but asking just in case.

Seems like upgrading them to use `sendInputEvent` would be more “correct,” though it would change behavior slightly. (Maybe a good v3 change?)
",Mr0grog,rosshinkley
619,2016-05-18 06:08:23,"If it helps anyone here, I wrote a little example plugin for how to use `sendEvent` over on #639. @dsowsy for your case, just throw some `mousemove` events in between the `mousedown` and `mouseup`:



It would be good to get a sense if this approach actually works for you and others experiencing issues before spending the effort cleaning it up for adding to core.
",Mr0grog,dsowsy
619,2016-05-18 16:47:23,"> @rosshinkley do you have any idea why the click() (and mouseover/mousedown) action doesn’t use sendInputEvent? Assuming no, since according to git, they pretty much appeared out of whole cloth, but asking just in case.

I _suspect_ it's because `sendInputEvent` wasn't a part of the Electron API when 2.x was initially released.  (The release dates differ by something like 10 days, memory serving.)  I also suspect that it worked Good Enough&trade;, so before now there hasn't been a real reason to change it.

> Seems like upgrading them to use sendInputEvent would be more “correct,” though it would change behavior slightly. (Maybe a good v3 change?)

I'd like to (like you) see more usage before making the change, but I also agree this feels much more in the spirit of ""doing things as an actual user would"", which is in keeping with the spirit of Nightmare.  Given that it seems to be causing enough problems, I'd be open to moving it into core.  Thoughts?
",rosshinkley,rosshinkley
618,2016-05-04 15:10:16,"This is perfect @rosshinkley. Thank you for your clear explanation and your time. I appreciate it. :)
",kud,rosshinkley
617,2016-05-05 11:54:31,"@rosshinkley @mingsterism
Using `Array.from()` is a nicer way to do this ;)


",albinekb,mingsterism
617,2016-05-05 11:54:31,"@rosshinkley @mingsterism
Using `Array.from()` is a nicer way to do this ;)


",albinekb,rosshinkley
617,2016-05-05 13:40:36,"@albinekb Ah, true.  Thanks for pointing that out.
",rosshinkley,albinekb
612,2016-04-29 19:51:40,"@JWMarchant it might be helpful to see the logs with `nightmare:*` instead of just `nightmare:actions` — anything happening in the electron process goes under `nightmare:log`, so there might be some good details missing in your debug output above.

I wouldn’t _think_ this is related to #405 since you are stilling seeing the window just hanging around open, so it’s not crashing.
",Mr0grog,JWMarchant
612,2016-04-29 20:02:32,"@Mr0grog true.  The reason i roped #405 in as a ""maybe"" was because it didn't _always_ crash the process, sometimes it would hang with no useful info.  It's possible that was hitting two different problems.
",rosshinkley,Mr0grog
612,2016-05-03 13:22:55,"@JWMarchant For what its worth, you can specify a file descriptor with `DEBUG_FD`.  Something like: `DEBUG_FD=3 DEBUG=nightmare:* node myNightmareScript.js 3>output.txt`.  For completeness, could you also run with `ELECTRON_ENABLE_LOGGING=true` and `ELECTRON_ENABLE_STACK_DUMPING=true`?

Also, if I'm not mistaken, your source will run up to ten URLs together at the same time - the second parameter to `async.queue` is a concurrency parameter.  For log clarity, it might also help to set it to 1 (or remove it as the default is also 1). 
",rosshinkley,JWMarchant
612,2016-05-03 15:35:56,"@rosshinkley, here's a separate log file this https://drive.google.com/a/conversion.com/file/d/0B5HUOoRm9YUbR1FtaVphZjR6TWc/view - thanks for  that useful tip! Unfortunately I couldn't recreate the issue when running `async.queue` with `1` as the concurrency parameter, so the log file is showing it as `10` so perhaps that may be it? Ideally I'd like to run Nightmare multiple times as I want to scrape thousands of websites everyday and doing it one by one is not really feasible...
",JWMarchant,rosshinkley
612,2016-05-03 23:41:12,"Ok, I’ve only gotten this to reproduce a few times, but it seems like the issue is well below Nightmare or Electron—the HTTP request for the initial HTML content of the page never actually closes and finishes, so we never move on to evaluating the JS that gets `window`. I’m not sure if this is something funky with Treehouse’s server (I _only_ observed this behavior with Treehouse), with Chromium, or deep in the network stack on the OS.

On the Electron side, we get response details for the beginning of the HTML and we get the `dom-ready` event, but we get no finish or failure events. Inside the browser window, `document.readyState` never moves from `interactive` to `complete` and the window’s `load` event never fires. Oddly, though, the `DOMContentLoaded` event _does_ fire.

So… I’m thinking the best way to address this is:
1. Listen for the `dom-ready` event on `webContents`.
2. Add a timeout to `goto` (default it to… 30s? Make it customizable… by goto call? By Nightmare instance?) If the timer runs out and `dom-ready` has happened, consider the load successful. If the event didn’t happen, consider the load a failure.

Alternatively, we could just have the timer and consider it a failure regardless of what events have happened. I can certainly understand that argument given that things inside the browser window are certainly not in a 100% a-ok state (though they do seem 99.999% ok).

@rosshinkley thoughts?
",Mr0grog,rosshinkley
611,2016-05-02 10:08:46,"Thank you @rosshinkley.
",kud,rosshinkley
611,2016-05-04 11:02:00,"@kud Or you can use Nightmare v1.8.2, which does have file upload functionality, but uses PhantomJS instead of Electron. https://github.com/segmentio/nightmare/tree/1.8.2 😉
",lukehorvat,kud
611,2016-05-04 11:03:06,"Interesting. Thanks @lukehorvat.
",kud,lukehorvat
610,2016-04-28 20:10:12,"@mingsterism on wikipedia.org, the CSS selector doesn't find any elements. The space operator in selectors ""a b"" means ""an element b with an element a ancestor"". You might have intended
`.central-featured-lang,lang1`

In the Chrome console you can try `$$(mySelector)` to see what gets returned from a querySelectorAll.

I'm not sure what's going on with the yahoo.com example, because there is no #main that I can find on the page and it waits indefinitely, but if I remove that wait() call then I don't get the same error.
",yoz,mingsterism
610,2016-04-29 01:50:01,"@yoz thanks for the advise. I followed your direction on the wikipedia selectors. Turns out, it was a (dot) i had to put in. `.central-featured-lang.lang1`. 
However, I still cant get the actual href element using CSS selectors. It gives me the entire line. I posted the question on stackoverflow as well. http://stackoverflow.com/questions/36928172/how-to-get-href-text-using-css-selectors 

For .wait(#main) on yahoo, I too had a hang. However, I tried a workaround and it worked. 

Below the whole wait function from actions.js



I took a method of the wait function and implemented that directly in my code instead and it worked for some reason. 
Added `exports` to implement in my code. Implement with `waitms(5000)`



Maybe something for others to check into. 

In regards to the .click() issue, what actually happened was electron was redirecting yahoo to my country specific yahoo. Thus the selectors were wrong. I changed the selectors with my specific yahoo url  `'https://sg.yahoo.com/?p=us'` , and it worked.  
",mingsterism,yoz
607,2016-04-30 00:57:13,"@shesmu no, it doesn’t. Are you referring to #602, or are you seeing that error independently (and do you have a reproducible test case)? I can see, where that error is happening, but can’t see how the conditions that cause it would ever be true. I’d love to know if you have a way to make it reliably happen.
",Mr0grog,shesmu
606,2016-04-28 01:32:06,"@rosshinkley I got the output below. 



Any ideas on the error? 
",mingsterism,rosshinkley
606,2016-04-28 03:37:04,"@rosshinkley I posted a new issue on the followup of the error. Appreciate your help. Thanks very much. 
",mingsterism,rosshinkley
605,2016-04-28 01:21:52,"@rosshinkley Thanks for the clarification. 
",mingsterism,rosshinkley
603,2016-04-26 21:35:53,"Ahh, that actually clarifies things quite a bit. Apparently `:first` [isn't supported](https://developer.mozilla.org/en-US/docs/Web/CSS/:first) and I happened to be testing only that. 😿  Found alternative to it by using `:first-child`. Thanks, @Mr0grog 
",shri3k,Mr0grog
602,2016-04-26 20:13:05,"@Mr0grog Just tried that. Getting this error now:

`electron:stderr /vagrant/code/node_modules/electron-prebuilt/dist/electron: error while loading shared libraries: libgtk-x11-2.0.so.0: cannot open shared object file: No such file or directory +0m`
",jamesaspence,Mr0grog
602,2016-04-26 21:52:10,"@Mr0grog Do I need to? I was working under the assumption that nightmare would start the virtual display itself. Maybe that was my problem.
",jamesaspence,Mr0grog
602,2016-04-27 16:30:19,"@Mr0grog It literally just sits, printing nothing. Switching to `DEBUG=nightmare node workbench.js` shows me the nightmare log, which looks something like this:



I also get this error now:



EDIT: Never mind, now the original debug command is returning errors as well. Following output:



EDIT 2: We're back to nothing after I tweaked my code again. No output, process just hangs forever.



This outputs nothing again. Changing to `DEBUG=nightmare` outputs:


",jamesaspence,Mr0grog
602,2016-04-27 17:30:38,"That's .... baffling.  @yoz might have been on the right track, but the suggestion there looks like it would work for npm2, not npm3.  If you look at `node_modules/electron-prebuilt/dist`, does `electron` exist there?

I'd also be curious if you explicitly installed `electron-prebuilt` and/or explicitly set [`electronPath`](https://github.com/segmentio/nightmare#electronpath) if that might have any effect.
",rosshinkley,yoz
602,2016-05-19 11:04:28,"I have the same issue, the weird thing is it works perfectly on my laptop, but within my vps I got the `general error - you may need xvfb` error. I am not using `xvfb` in my code, as I did not use it on my laptop and it worked. Is the use of `xvfb` needed on virtual servers ? If yes, could you explain why?

Thanks a lot :-)

EDIT: I ran the code provided by @jamesaspence and it's working, but i'm still willing not to use `xvfb` if I don't understand the need to use it - it worked without it before...
",paulintrognon,jamesaspence
602,2016-05-19 15:11:31,"@paulintrognon You might want to take a look at #224.  The short version is that Electron requires a framebuffer to render, and when you're running headlessly on Linux, running `Xvfb` satisfies that requirement.
",rosshinkley,paulintrognon
596,2016-04-25 19:03:24,"There’s no super-easy way, but, as @rosshinkley noted, I wrote a short description of what you can do to counterract this [at the bottom of #498](https://github.com/segmentio/nightmare/issues/498#issuecomment-210710684). You could use a similar mechanism to [set the window’s content area](http://electron.atom.io/docs/v0.37.7/api/browser-window/#winsetcontentsizewidth-height-animate) instead of using Nightmare’s `viewport()` method.
",Mr0grog,rosshinkley
595,2016-05-04 14:43:55,"@yotamlaufer Awesome, thank you.
",rosshinkley,yotamlaufer
593,2017-03-17 03:41:27,"@overflowz The main holdup right now is that `preload` is not honored by windows not created by instantiating a new `BrowserWindow` internal to Electron, specifically with `window.open()`.  See electron/electron#2605.

I haven't dug into it, but it _might_ be skirted with some `preload` magic on the main Electron window.  At the time, it felt like an _awful_ lot of work for something that might end up getting fixed.",rosshinkley,overflowz
592,2016-05-27 20:02:38,"@trusktr did @Mr0grog's suggestions work for you?
",rosshinkley,trusktr
592,2016-05-27 20:02:38,"@trusktr did @Mr0grog's suggestions work for you?
",rosshinkley,Mr0grog
592,2016-05-27 21:02:44,"@rosshinkley I haven't tried it yet. Seems like it will though. I'll re-open if I get around to it (or if anyone reading tries and it doesn't work, they can re-open too).
",trusktr,rosshinkley
587,2016-12-14 23:59:20,"@yoz, that answer was right on the money. I was troubleshooting very unpredictable behaviour in a docker vs on my Mac and traced it to exactly this issue. Many thanks.",mashaalmemon,yoz
586,2016-04-21 01:22:08,"> I'm wondering now is if instead of exiting, the Nightmare instance should be put into an error state where any further calls would cause exceptions as the IPC parts are no longer reliable.

I definitely think this would be great. But some thoughts: there are two different kinds of `uncaughtException` handlers and I think the story is a little different for each.
1. Exceptions in the child (electron) process. This is what #558 was about. I think the reality here is that when this happens, we pretty much have to assume everything in the process (and therefore in the Nightmare instance controlling it) is hosed. I think you’re on the right track here, @rosshinkley:
   1. Treat this like an error in any action, stopping all running queues, and calling the callback/rejecting the promise for each of them with information about the exception.
   2. Marking the instance as dead so any later calls to `run/then/end` either throw or reject (I’d lean towards reject, but throwing might make sense, too). The same goes for when the Electron process crashes, which is currently totally silent. 😱 Arguably, we should be doing this when the instance is explicitly ended, too (IIRC, you can currently call `run/then` again after the process is ended and have unclear problems).
2. Exceptions in the parent (user) process (the handler @demongloom cited). As I’m thinking about this one more critically now, **I’m not sure we should be handling this event at all:**
   - Handling it is not great practice for library code (as opposed to user code) because it changes the behavior of the process. We “fixed” this in #554, but this gets in the user’s way if they want to not crash on an exception (rarely ever a good idea, but _sometimes_ there are legitimate reasons). In hindsight, the better fix for #554 might have been to just remove the handler altogether.
   - Handling it in order to clean up the electron process is unnecessary because we already trap all the possible close/exit/signal events and cleanup there. Whether the system exits because of an uncaught exception or the user explicitly does so in their own code, we’re still covered without trapping this event.
   - Presumably the handler was originally added to ease debugging, but what about cases where Electron is a useful additional piece of functionality in a larger app, rather than the central purpose of someone’s app? It’s not great to just be spewing stack traces to the console if they’re trying to redirect errors somewhere else (logs, a remote service, etc). (If we really like this functionality, maybe send it to `debug` and then only exit the process if there are no other uncaught exception handlers?)
   
   To some extent, I simply did wrong by adding the `endInstance` call to the existing uncaught exception handler on the parent in #487. We don’t have to assume, unlike with the child process, that Nightmare’s internals are hosed here. It’s plenty likely that the exception came from code that didn’t have anything to do with Nightmare.
",Mr0grog,demongloom
586,2016-04-21 01:22:08,"> I'm wondering now is if instead of exiting, the Nightmare instance should be put into an error state where any further calls would cause exceptions as the IPC parts are no longer reliable.

I definitely think this would be great. But some thoughts: there are two different kinds of `uncaughtException` handlers and I think the story is a little different for each.
1. Exceptions in the child (electron) process. This is what #558 was about. I think the reality here is that when this happens, we pretty much have to assume everything in the process (and therefore in the Nightmare instance controlling it) is hosed. I think you’re on the right track here, @rosshinkley:
   1. Treat this like an error in any action, stopping all running queues, and calling the callback/rejecting the promise for each of them with information about the exception.
   2. Marking the instance as dead so any later calls to `run/then/end` either throw or reject (I’d lean towards reject, but throwing might make sense, too). The same goes for when the Electron process crashes, which is currently totally silent. 😱 Arguably, we should be doing this when the instance is explicitly ended, too (IIRC, you can currently call `run/then` again after the process is ended and have unclear problems).
2. Exceptions in the parent (user) process (the handler @demongloom cited). As I’m thinking about this one more critically now, **I’m not sure we should be handling this event at all:**
   - Handling it is not great practice for library code (as opposed to user code) because it changes the behavior of the process. We “fixed” this in #554, but this gets in the user’s way if they want to not crash on an exception (rarely ever a good idea, but _sometimes_ there are legitimate reasons). In hindsight, the better fix for #554 might have been to just remove the handler altogether.
   - Handling it in order to clean up the electron process is unnecessary because we already trap all the possible close/exit/signal events and cleanup there. Whether the system exits because of an uncaught exception or the user explicitly does so in their own code, we’re still covered without trapping this event.
   - Presumably the handler was originally added to ease debugging, but what about cases where Electron is a useful additional piece of functionality in a larger app, rather than the central purpose of someone’s app? It’s not great to just be spewing stack traces to the console if they’re trying to redirect errors somewhere else (logs, a remote service, etc). (If we really like this functionality, maybe send it to `debug` and then only exit the process if there are no other uncaught exception handlers?)
   
   To some extent, I simply did wrong by adding the `endInstance` call to the existing uncaught exception handler on the parent in #487. We don’t have to assume, unlike with the child process, that Nightmare’s internals are hosed here. It’s plenty likely that the exception came from code that didn’t have anything to do with Nightmare.
",Mr0grog,rosshinkley
579,2016-04-26 13:37:55,"@Mr0grog Good.

I'm considering opening a branch off of master for v3 parts.  Would you be willing to complete this PR and put it against that branch?  Thoughts on doing such a thing?
",rosshinkley,Mr0grog
579,2016-04-29 18:55:48,"@rosshinkley do you want a new PR pointing to another branch, or should this still be going to master? (per discussion the other day about whether this is v2.4 or v3 feature)
",Mr0grog,rosshinkley
575,2017-02-11 05:28:52,"@rosshinkley writes in #979 

> TL;DR: don't use .run(). It's a holdover from Nightmare 1.x. Use .then() instead.

If that's indeed the case, let's decide this & close this issue.

My 2 cents, without getting into the whole history here, is the syntax of `run()` is nice, and I don't really understand why it can't/shouldn't be a wrapper. But whether it is supported or isn't supported, a decision one way or another would be nice :)",ripper234,rosshinkley
574,2017-01-02 21:19:34,"Closing as this as like @Mr0grog said, that isn't _really_ what Nightmare is intended for.  There may be a future where this is doable, but not for now.",rosshinkley,Mr0grog
573,2016-04-23 21:02:39,"@lzrski Off the cuff, I'd say have the Nightmare process to wait for the promise to be settled, yes.

If it's rejected, I'd think it should handle it like `.evaluate()`: bubble the rejection all the way up.  A failure is a failure.  Thoughts?

As for the fulfillment value, I think it should work like how `.wait(fn)` works - the waited-for value should resolve to `true` to stop waiting.  Fortunately, you've already written the plumbing to do this.  All you _should_ need to do is write the test.
",rosshinkley,lzrski
573,2016-06-24 11:14:29,"Hey, sorry for abandoning this conversation. It's because my first child was recently born and I was quite occupied with this wonderful if somewhat difficult change in my life :)

@carebdayrvis thanks for asking. Any help is appreciated.

Back to the topic. It seams that `waitFn()` calculates the time elapsed by just adding 250ms after every tick. This way it ignores the time that the evaluation on page took. With async evaluation this can be significant. Am I understanding correctly?

This could be improved by storing the start timestamp and comparing it with current time on every tick, like that:



but still wouldn't work for very long running evaluations - it will only timeout after the job is done, and only if the result if negative (`false` is returned). The commit that I've just pushed demonstrates this by introducing a (failing) test case.
",lzrski,carebdayrvis
572,2016-04-15 18:30:47,"@lzrski I have also been having problems with Nightmare + devtools options spontaneously flaking.  It looks like a segfault internal to Electron, just like #563.  I'll have to carve out some time to see what the details are.
",rosshinkley,lzrski
572,2016-04-16 15:26:35,"@Mr0grog Thank you for putting in the legwork.  Hopefully that electron issue will be resolved soon.
",rosshinkley,Mr0grog
568,2016-04-14 15:43:28,"@fritx As I understand it, the internal projects at Segment are all kind of lumped together under the `segmentio` account.  To prevent possible security problems, and to avoid [permission issues](https://gitter.zendesk.com/hc/en-us/articles/200178971-You-want-write-access-on-my-private-repos-Are-you-insane-), we'll be using the room for my fork for the time being.  There is work being done at Segment to get the public and private repositories separated.  When that is complete, I'll have the account owner create the gitter room for this repository and transfer the history.  That way we won't lose anything.

Make sense?
",rosshinkley,fritx
568,2016-04-18 02:30:20,"@rosshinkley sounds great! Awesome! :+1:
",fritx,rosshinkley
565,2016-04-15 00:19:21,"Extra minor note here (sorry I completely missed you posting this PR, @rosshinkley): it might be nice if the two new scripts got sequestered into their own directory since they aren’t really part of the tests per se. Maybe `/scripts` or `/test/scripts`?
",Mr0grog,rosshinkley
565,2016-04-15 00:28:26,"@Mr0grog Ah, that's no problem.  I pulled it in because I was getting frustrated with documentation-only PRs failing in CircleCI.  Irritation-driven acceptance is a thing, right?

Kidding aside, that's not a bad call.  I'll put it on the list. :)
",rosshinkley,Mr0grog
564,2016-04-23 23:03:44,"@silenceisgolden Can you upgrade to 2.3.4 and see if you're still getting this issue?  I wonder if it has to do with #375 or possibly #553.
",rosshinkley,silenceisgolden
564,2016-05-20 03:52:57,"@JWMarchant Have you found a solution? I'm seeing the same problem. It has something to do with the foreach loop. If you run the loop once you don't see the error.
",misbach,JWMarchant
564,2016-05-20 09:03:15,"Hi @misbach. Not yet, no, but in my other issue (#612) @rosshinkley and @Mr0grog seemed to be onto something and there is a pull request (#640) that might solve this.
",JWMarchant,rosshinkley
564,2016-05-20 09:03:15,"Hi @misbach. Not yet, no, but in my other issue (#612) @rosshinkley and @Mr0grog seemed to be onto something and there is a pull request (#640) that might solve this.
",JWMarchant,misbach
564,2016-05-21 02:02:52,"@JWMarchant @misbach does using the branch for #640 alleviate this issue for you?
",Mr0grog,misbach
564,2016-05-21 02:02:52,"@JWMarchant @misbach does using the branch for #640 alleviate this issue for you?
",Mr0grog,JWMarchant
564,2016-05-27 19:58:58,"@JWMarchant @misbach @Mr0grog for what it's worth, #640 has been released with 2.5.0.
",rosshinkley,Mr0grog
564,2016-05-27 19:58:58,"@JWMarchant @misbach @Mr0grog for what it's worth, #640 has been released with 2.5.0.
",rosshinkley,misbach
564,2016-05-27 19:58:58,"@JWMarchant @misbach @Mr0grog for what it's worth, #640 has been released with 2.5.0.
",rosshinkley,JWMarchant
564,2016-05-31 16:29:27,"Hi @rosshinkley & @Mr0grog,

Unfortunately it seems I'm still getting the error.

Here is my code:



The command I ran was: `DEBUG_FD=3 DEBUG=nightmare:* ELECTRON_ENABLE_LOGGING=true ELECTRON_ENABLE_STACK_DUMPING=true node nightmare.js 3>debug.log`.

My package.json:



And the log file: [https://drive.google.com/file/d/0B_3Tmwogoca7eWRYQWo5cFhfVXc/view?usp=sharing](https://drive.google.com/file/d/0B_3Tmwogoca7eWRYQWo5cFhfVXc/view?usp=sharing)
",JWMarchant,Mr0grog
564,2016-05-31 16:29:27,"Hi @rosshinkley & @Mr0grog,

Unfortunately it seems I'm still getting the error.

Here is my code:



The command I ran was: `DEBUG_FD=3 DEBUG=nightmare:* ELECTRON_ENABLE_LOGGING=true ELECTRON_ENABLE_STACK_DUMPING=true node nightmare.js 3>debug.log`.

My package.json:



And the log file: [https://drive.google.com/file/d/0B_3Tmwogoca7eWRYQWo5cFhfVXc/view?usp=sharing](https://drive.google.com/file/d/0B_3Tmwogoca7eWRYQWo5cFhfVXc/view?usp=sharing)
",JWMarchant,rosshinkley
564,2016-06-10 18:48:28,"@JWMarchant as noted over on #640, does using memory partitions and/or randomly named partitions for each instance solve the problem for you? If not, we at least know you are likely experiencing a different issue than the one on #640.

To use memory partitions, construct a Nightmare instance like:



To get a unique partition every time, do something like:


",Mr0grog,JWMarchant
564,2016-06-14 16:28:20,"Thank you @Mr0grog.  This is amazingly helpful in helping me make sure I'm properly cleaning everything up.  I've glazed through the nightmare code, but methinks I need to spend a good while staring at it as it is non-trivial code.

Partitions did not fix it.

BUT when I inspect the .running flag on the nightmares, it is sometimes still true.  I'm doing each goto with something like this code snippet:



So currently I'm just punting on the nightmare pool request until it is no longer running (and making a new nightmare in cases where I try to reach it too many times while it is still running).  

Do the promises or the .then not force the nightmare to finish running?  Is there a way to do so without ending the instance?  When I refuse to use a nightmare instance when I get a true for ""running"", it ceases to crash, so I suspect the .then is a lie?  Is there some other way I'm unaware of to force the goto to finish?
",catblade,Mr0grog
564,2016-06-14 17:47:43,"> Do the promises or the .then not force the nightmare to finish running?

They do, but not synchronously. If you code is something like:



Then you’ll probably wind up with your full pool used up and in a `running` state halfway through the loop—the loop is synchronous, but the running of the nightmare queues is not. Instead, you might do something like:



That way, you’re not trying to grab an instance from the pool until one of the instances has completed. There are definitely more elegant ways to write the above, but hopefully it gets the general idea across. Incidentally, this is basically the same thing @JWMarchant was doing above by using:



(Where `50` would be the pool size. That param in `async` is the maximum number of simultaneous runs, which you’d want to be the size of your pool.)
",Mr0grog,JWMarchant
564,2016-07-08 17:24:59,"#640 is merged, #612 is closed, and it seems like @catblade's issue is resolved, so I'm going to go ahead and close this issue.
",rosshinkley,catblade
563,2016-04-14 17:02:29,"@lunow if that's true, it's likely got a different cause.  Could you open a new issue with a minimal reproduction case?
",rosshinkley,lunow
559,2016-04-08 21:38:33,"@djdavidi I'd be open to including a bit about unicode characters.
",rosshinkley,djdavidi
559,2016-04-12 17:31:41,"@Mr0grog I meant to do that yesterday after 2.3.1 and got sidetracked.  Closing.
",rosshinkley,Mr0grog
558,2016-04-18 17:51:26,"@yoz ah, that’s frustrating. It sounds like the issues in Electron are fairly thorny.

I get wanting to be able to continue on after Nightmare fails, but I’m pretty sure Nightmare really does not handle the underlying Electron process failing very gracefully. A lot more would need to be done to fix that if you want it to be safe to not just exit the process when Electron fails. It would probably be a good improvement if you want to work on it, though!
",Mr0grog,yoz
558,2016-04-18 18:01:08,"@Mr0grog yes, unfortunately it's a pretty difficult bug to reproduce. I would look into it if I had an easier time with that. But I think the easiest for me is to downgrade my version of electron-prebuilt to 0.36.8.
",yoz,Mr0grog
558,2016-04-23 22:59:00,"@yoz electron/electron#4733 was fixed/reclosed in electron/electron#5233, which should be in the release of `electron-prebuilt` Nightmare is on as of 2.3.4.  Can you upgrade and see if this issue still exists?
",rosshinkley,yoz
558,2017-03-10 20:14:37,"@GautierT I think this is in reference to rosshinkley/nightmare-download-manager#14, picking up this conversation there.",rosshinkley,GautierT
557,2016-04-23 22:52:38,"@AaronTrazona Are you still having this problem?
",rosshinkley,AaronTrazona
557,2016-04-28 01:12:15,"@rosshinkley  sorry, im busy lately thanks im good.
",AaronTrazona,rosshinkley
557,2016-12-23 10:12:32,"@AaronTrazona: how do you do, in order to make it work?",flexbrane,AaronTrazona
555,2016-04-11 05:34:26,"@bahlo I had some time today and attempted to reproduce your issue, but could not. Here’s what I tried:



(Also, upon looking at this again, I realize you haven’t stumbled over the looping problem at all because you don’t call `then()` in the loop. Sorry for my not-so-careful reading there.)

Anyway, in my very simple and generalized case, everything seems to work. The main reason screenshotting might hang in the way you describe is that when `screenshot` attempts to trigger a new frame render in chromium, it fails to actually change the render tree in the browser window. The `triggerRender` function is what does that—mainly by moving around a little 1x1 transparent `div` on screen. It could be that something in your page is causing that div to wind up offscreen somehow.

**The first thing I’d try is setting `position: fixed` instead of `absolute` on line 78 of `frame-manager.js`.**

If that doesn’t help, I imagine it’s going to be something particular with the page you are attempting to render (maybe something your `nextView` function does). If that doesn’t help, maybe you could share the code you’re working with personally via private repo, private gist, or sending a zip?

Otherwise, I’m not sure what to tell you other than to answer any question you have about how and why the screenshotting code works the way it does (which I’m happy to do; it just means I can’t really help you investigate directly).
",Mr0grog,bahlo
555,2016-04-11 09:11:50,"@Mr0grog Thank you so much for this. I will try and report back :+1:
",bahlo,Mr0grog
555,2016-12-06 11:13:33,@bahlo : Hi ! What was your config for Docker ? I have the same issue and i would like to resolve it for docker. Thanks,GautierT,bahlo
555,2016-12-07 11:10:46,"@GautierT As I said before, I moved away from Docker since it wouldn't work (I found a bug in chromium with some value not high enough in Docker, but don't know which anymore). 

Works fine in the VM though 👍 ",bahlo,GautierT
555,2016-12-07 18:24:06,@bahlo i tried in VM and have the same problem that in docker. When i launch the same script 4-5 times at the same time some of them finish successfully and some of them crash or timeout or  get stuck in `nightmare:log altering page to force rendering`...,GautierT,bahlo
555,2016-12-15 18:09:26,@bahlo : I'm running into this same issue. Can you provide an example of how you manually triggered the callback for `requestFrame` ?,mackermedia,bahlo
555,2016-12-16 16:05:52,@bahlo : Nevermind. I found it in your fork ;) https://github.com/bahlo/nightmare/commit/31b17abdf53931cec87cca27b5e2d1f226b611df#diff-bc4eacf94ad1a8e7c9bea8b6b6451251R53,mackermedia,bahlo
555,2016-12-16 17:19:44,"Update: The solution that worked for @bahlo (in his fork above) doesn't work for me. In my case, I'm wanting to take a screenshot of a particular rectangle on the page. It appears that manually calling that callback doesn't allow nightmare enough time to move the page to the specified rectangle before taking the screenshot. Still digging for a solution.",mackermedia,bahlo
555,2016-12-19 21:37:16,"@Mr0grog : thanks a ton for your effort! 
It looks like your commit using the debugger highlighting has solved this hanging process issue for me. 
I did notice that once in awhile it seems like the rectangle that I'm passing in (for size & location of screenshot to be captured) is sometimes off. Perhaps that's related to the Electron window size bug you mentioned there?",mackermedia,Mr0grog
555,2016-12-19 22:27:17,"@mackermedia Awesome!

> I did notice that once in awhile it seems like the rectangle that I'm passing in (for size & location of screenshot to be captured) is sometimes off. Perhaps that's related to the Electron window size bug you mentioned there?

That sounds like a problem. It shouldn’t be related to the window size bug; that was a problem with my experimental `screenshot-with-offscreen-rendering` branch, not the PR I submitted. (Sorry if the explanation over there wasn’t clear. I probably shouldn’t have mentioned the other branch at all.)

If you can come up with a way to reproduce it reliably, would you please post it on that PR or as an issue (if the PR gets merged in the mean time)?",Mr0grog,mackermedia
554,2016-04-06 07:58:48,"Hi @Mr0grog, that's for the feedback. I thought about adding a test, but didn't as you're not meant to do anything after an uncaughtException in user space. However I've looked through some of your tests and seen you have some (rather nice!) tests using child processes so I'll have a go at encapsulating a test.
",pci,Mr0grog
554,2016-04-11 08:12:10,"@Mr0grog No problem, it was only because we introduced an error into our test framework that we found this bug, so you're in good company! Do you want this rebased into one commit?
",pci,Mr0grog
554,2016-04-11 14:54:20,"I'd leave it as-is, I like having the history, and this isn't all that noisy.  I don't see a real need for a rebase.  (I also don't _really_ know what would be considered ""most correct,"" but that's the stand I'm taking, at least for now.)

I do have commit rights on github and publish rights on npm.  (Hooray!)  I'll be putting together a milestone + release ... soonish.  At a minimum, I'd like to get this + #553 in.  The underlying Electron PRs (thank you, @Mr0grog) have all been accepted, but I don't think they've all been released (at least at the time of this comment).
",rosshinkley,Mr0grog
554,2016-04-11 16:05:14,"@Mr0grog fair enough.  Can always cut another patch when #553 is done.  Will do as time permits.
",rosshinkley,Mr0grog
553,2016-04-07 14:18:07,"@Mr0grog re your previous comment: like I said, my knowledge there was limited.  Thanks for setting me straight.  :)

I _really_ like `.goto()` returning information about the request.  One question about that, and this may be silly: I see in your tests that [valid redirects are okay](https://github.com/segmentio/nightmare/pull/553/files#diff-910eb6f57886ca16c136101fb1699231R233), but it doesn't check the internal information bubbled up from `.goto()`.  Based on the changes you've put in, would that show the 3xx?  At first blush, I don't think it would - wouldn't it show the 2xx (assuming success) for the final destination (after `did-finish-load`)?

To be clear: I'm not sure `.goto()` should track all of the redirect information from a given request, but I do want to clarify what to expect.  Thoughts?

It looks like atom/electron#5029 has been accepted and as such atom/electron#5013 has been fixed.  I don't know what kind of release schedule Electron is on, but they cut releases often enough that I think I'm willing to wait as it reduces the complexity of your solution (seemingly by quite a bit).  What do you think?

Onto the test issues: I can't get the test suite from your fork to run consistently.  The ""should fail properly if request handler is present"" test fails intermittently.  It looks like once in a while, `did-fail-load` gets emitted after `did-finish-load`.  (That's the difference in debug output anyway.  I'm not clear on the underlying cause yet.)  Coincidentally, that appears to be one of the problems in build 662.  I don't have time to dig into this right this moment, but as time permits today, I'm going to dig into this and the other CircleCI issues.
",rosshinkley,Mr0grog
553,2016-04-07 17:07:04,"9cfef7c should mitigate one of the issues I saw repeated on Circle last night: trying to load an unknown protocol seems to hang. It doesn’t do so locally, nor does it if I SSH into the Circle box and manually run the tests from the command line. Not sure what’s different when Circle does its test run, but  ¯\_(ツ)_/¯

This doesn’t fix the intermittent ""should fail properly if request handler is present” issue you found, @rosshinkley. I noticed that sometimes on Circle, too, but wasn’t able to repro locally and haven’t dug into it yet, so if you’ve got ideas, awesome. 

> It looks like once in a while, did-fail-load gets emitted after did-finish-load. (That's the difference in debug output anyway. I'm not clear on the underlying cause yet.)

_Sigh._ Hope this is not what’s really happening, but that would definitely cause this sort of problem :(

> I see in your tests that valid redirects are okay, but it doesn't check the internal information bubbled up from .goto(). Based on the changes you've put in, would that show the 3xx? At first blush, I don't think it would - wouldn't it show the 2xx (assuming success) for the final destination (after did-finish-load)?

Oh, that’s a good question. I’m pretty sure it would show the 2xx for the final destination, but haven’t tested that case. I’m also not sure I’ve tested the case of invalid redirects.

> I'm not sure .goto() should track all of the redirect information from a given request, but I do want to clarify what to expect.

I actually hadn’t thought about this case _at all!_ It would be interesting to report on all the redirects involved, but I hadn’t really planned to. So yes, no reason to expect that.

> I don't know what kind of release schedule Electron is on, but they cut releases often enough that I think I'm willing to wait as it reduces the complexity of your solution (seemingly by quite a bit). What do you think?

Yeah, I’m not sure either, though they do certainly release often. Buuuuuuut gathering the response details also relies on the URL check, so https://github.com/electron/electron/pull/5029 no longer removes the need for the `onBeforeRequest` madness. I’ve just filed https://github.com/electron/electron/issues/5074, which would fix this for us.
",Mr0grog,rosshinkley
553,2016-04-12 14:24:54,"@Mr0grog Thank you for all of the work you've done for this. :)
",rosshinkley,Mr0grog
553,2016-04-15 17:34:18,"@rosshinkley I think this is good to go. All green and no webRequest stuff.
",Mr0grog,rosshinkley
553,2016-04-15 18:58:50,"@Mr0grog _Awesome._  I'll put this out as soon as I can carve the time out.
",rosshinkley,Mr0grog
550,2016-04-23 22:51:53,"@khafan246 Are you still having this issue?
",rosshinkley,khafan246
549,2016-04-08 17:32:48,"@rosshinkley  thank you
",suhaotian,rosshinkley
549,2016-04-08 21:35:00,"@suhaotian Turns out I was wrong.

Sending `\u54c8` _will_ send the correct character.  So either using `.insert()` or `.type()` with unicode encodings should work.
",rosshinkley,suhaotian
548,2016-04-15 20:02:31,"@yoz Any updates?

By the by, the tests were fixed with a makefile/shell script stopgap in #565.
",rosshinkley,yoz
548,2016-04-15 20:06:48,"@rosshinkley Sorry, got caught up in other work - I think it makes sense to add focus/blur events when clearing inputs, too. Will hopefully get to that later today.
",yoz,rosshinkley
548,2016-04-16 15:34:14,"@yoz I understand.  Thanks for putting it together!
",rosshinkley,yoz
546,2016-04-07 21:30:39,"I know this has been sitting for a bit but wanted to make a minor note here. @wyqydsyq you should be able to make your final `then()` to end the test work by simply _returning_ `t.end()`, like so:



As @rosshinkley noted, “`.end()` puts another action in the action queue, same as anything else,” so just calling `.end()` at the end queues up the end action, but never executes it. Returning a thennable from a promise handler causes that thennable to be run automatically, so the above code is _kind of_ like:



…but either way, yeah, this is definitely a little confusing :\
",Mr0grog,wyqydsyq
546,2016-04-07 21:30:39,"I know this has been sitting for a bit but wanted to make a minor note here. @wyqydsyq you should be able to make your final `then()` to end the test work by simply _returning_ `t.end()`, like so:



As @rosshinkley noted, “`.end()` puts another action in the action queue, same as anything else,” so just calling `.end()` at the end queues up the end action, but never executes it. Returning a thennable from a promise handler causes that thennable to be run automatically, so the above code is _kind of_ like:



…but either way, yeah, this is definitely a little confusing :\
",Mr0grog,rosshinkley
546,2016-04-09 10:17:01,"@rosshinkley @Mr0grog your explanations are very helpful but you confuse `t.end()` and `window.end()`. I won't check your code snippets but this works, @wcjohnson11 :


",kuraga,Mr0grog
546,2016-04-09 10:17:01,"@rosshinkley @Mr0grog your explanations are very helpful but you confuse `t.end()` and `window.end()`. I won't check your code snippets but this works, @wcjohnson11 :


",kuraga,rosshinkley
546,2016-04-09 10:23:19,"P.S. @rosshinkley , Add `queue` argument to callbacks, maybe? And why result of `nightmare.then(cb)` isn't chainable? Is it good that `TypeError: nightmare.goto(...).wait(...).exists(...).then(...).end is not a function`?
",kuraga,rosshinkley
546,2016-04-11 00:37:56,"@kuraga Augh, sorry. Did not read carefully :(

Either way, `.then(function() { return nightmare.end(); })` (or `.then(() => nightmare.end())` if you have fat arrow support) will do what you want. Hopefully that, at least, was clear!

As an even more concise bonus, since `tape.end()` takes a potential error as its first argument, you can _probably_ (I haven’t tested this) do `nightmare.end(t.end)` at any point to end your tests, too.
",Mr0grog,kuraga
546,2016-04-11 05:50:23,"Oh boy, I didn't read carefully either.  I apologize.  Good catch, @kuraga.

> P.S. @rosshinkley , Add queue argument to callbacks, maybe? And why result of nightmare.then(cb) isn't chainable?

It is... insofar as `.then()` returns a native promise, and can chain promise methods off of it (eg, another `.then()`).

> Is it good that TypeError: nightmare.goto(...).wait(...).exists(...).then(...).end is not a function?

Promises don't expose `.end()`, Nightmare does.  Once you call `.then()`, you're not dealing with a Nightmare instance anymore, you're dealing with a native promise.  If you wanted `.then()` to execute (and clear the queue) _before_ calling `.end()`, something like:



... should work.
",rosshinkley,kuraga
546,2016-04-11 05:50:23,"Oh boy, I didn't read carefully either.  I apologize.  Good catch, @kuraga.

> P.S. @rosshinkley , Add queue argument to callbacks, maybe? And why result of nightmare.then(cb) isn't chainable?

It is... insofar as `.then()` returns a native promise, and can chain promise methods off of it (eg, another `.then()`).

> Is it good that TypeError: nightmare.goto(...).wait(...).exists(...).then(...).end is not a function?

Promises don't expose `.end()`, Nightmare does.  Once you call `.then()`, you're not dealing with a Nightmare instance anymore, you're dealing with a native promise.  If you wanted `.then()` to execute (and clear the queue) _before_ calling `.end()`, something like:



... should work.
",rosshinkley,rosshinkley
546,2016-04-11 18:26:35,"@rosshinkley @Mr0grog @wyqydsyq 
Hm, but for `.evaluate` it really doesn't work!


",kuraga,Mr0grog
546,2016-04-11 18:26:35,"@rosshinkley @Mr0grog @wyqydsyq 
Hm, but for `.evaluate` it really doesn't work!


",kuraga,wyqydsyq
546,2016-04-11 18:26:35,"@rosshinkley @Mr0grog @wyqydsyq 
Hm, but for `.evaluate` it really doesn't work!


",kuraga,rosshinkley
546,2016-04-11 18:40:56,"@kuraga Does your expectation (`expect(text).to.match(/Информация об узле 1:/)`) fail? If so, `console.log(3)` _shouldn’t_ be called, because that’s in a success handler. The failed expectation will throw an exception, which will cause the promise returned by the `then` that it’s in to _reject_ instead of resolve.

So if that’s your problem, you should probably:



or


",Mr0grog,kuraga
546,2016-04-11 19:23:39,"@wyqydsyq you also can use [`t.plan()`](https://github.com/substack/tape#tplann)
",kuraga,wyqydsyq
546,2016-04-13 04:47:25,"@wyqydsyq I'm considering this issue resolved.  If you have any more questions, feel free to reopen/open a new issue.
",rosshinkley,wyqydsyq
545,2016-04-23 22:51:04,"Not sure that it matters, but you might want to also override [the Electron path](https://github.com/segmentio/nightmare#electronpath).  I don't _think_ the paths changed from 0.36.x to 0.37.x, so @Mr0grog's directions should work, but it can't hurt to be sure.  You may also want to run your application with `ELECTRON_ENABLE_LOGGING` in tandem with `DEBUG=nightmare:*,electron:*`.  That might give you a little more information.

What bothers me about the original log text is that the error is a page error from `.onClick()`, so I'm not certain it's because of the screenshot.  If I had to guess, I'd guess that there's a problem in PayPal's client code when you click on `#loadLogin`.  If you run the steps by hand in Chrome with the devtools open, do you get the same error?
",rosshinkley,Mr0grog
545,2016-04-25 19:55:49,"Regardless, since it’s a crash in Electron, getting the crash report would help a lot. It’s extremely hard to know what’s causing the crash without either a reproducible test case or knowledge of what Electron is actually doing when it crashes (from the crash report).

If you can’t get the crash report from the system, you can also try setting `ELECTRON_ENABLE_STACK_DUMPING` (not just `ELECTRON_ENABLE_LOGGING`) alongside `DEBUG=electron:*` as @rosshinkley suggested. That’ll at least get you something similar to the system report.
",Mr0grog,rosshinkley
545,2016-04-25 20:09:08,"@Mr0grog This is about a thousand miles offtopic, but would it be worth implementing a crash report server internal to Nightmare so the child Electron instance submits crash reports directly to the parent process? 
",rosshinkley,Mr0grog
544,2016-03-27 23:15:33,"@rosshinkley Ok will do!
",justinmchase,rosshinkley
544,2016-04-02 22:22:28,"Thanks, @justinmchase.  Merging.
",rosshinkley,justinmchase
543,2016-03-25 14:01:53,"Thanks @rosshinkley, it's all clearer now. I still have some doubts about the general behaviour of the framework: when I try to do some action after an evaluate-then couple, I get an error. So what if I want to do some stuff, then evaluate something on the page, then continue the navigation (i.e. go to a second link of the site with goto)? This is useful if I want to use always the same Electron window to retain the logon credentials.
",johncornell,rosshinkley
543,2016-03-30 03:43:49,"@johncornell No problem.  Closing.
",rosshinkley,johncornell
542,2016-05-24 16:56:34,"@xpiqu With #548 included, can you give this another try?
",rosshinkley,xpiqu
541,2016-04-08 21:43:46,"@sanathko I think so.

A little more research (and some later issues, notably #549 and #559) shows that you could also include a unicode character.  Something like `.type('#demobox', 'typing text line 1\u000d')`.
",rosshinkley,sanathko
541,2016-04-13 04:48:18,"@sanathko I'm considering this issue closed.  If you have more problems with this, feel free to reopen/open a new issue.
",rosshinkley,sanathko
538,2016-03-30 03:57:34,"@brrd I'm sorry, I must have missed #475.

@justinmchase Agreed, closing as duplicate.
",rosshinkley,brrd
538,2016-03-30 03:57:34,"@brrd I'm sorry, I must have missed #475.

@justinmchase Agreed, closing as duplicate.
",rosshinkley,justinmchase
537,2016-03-17 10:43:21,"@rosshinkley big thanks about explanation!

> > if I can use Nightmare with vanilla NodeJS and without Mocha.
> 
> Of course! As of Node 4.x, promises are natively supported.

I meant ""without `mocha-generators`, `mocha`, `co` and `vo`"".

> Please note that the examples are using the `mocha-generators` package for Mocha, which enables the support for generators.

Is this description wrong here? Do you mean ""which wraps generator function with `co`/`vo`"" instead of ""enables the support for generators""? NodeJS 4.2 does support generators (so they are already ""enabled"") but seems like code doesn't work without `mocha-generators`.
",kuraga,rosshinkley
537,2016-03-17 19:43:39,"@kuraga No problem.

> I meant ""without mocha-generators, mocha, co and vo"".

You don't need `co` or `vo` to run Nightmare.  ES6 promises are native - meaning no library is required - and work fine.  You _can_ run [Nightmare with callbacks](https://github.com/rosshinkley/nightmare-examples/blob/master/docs/beginner/callbacks.md), but it's not directly supported.  Maybe I don't understand what the problem is?

> Is this description wrong here? Do you mean ""which wraps generator function with co/vo"" instead of ""enables the support for generators""? NodeJS 4.2 does support generators (so they are already ""enabled"") but seems like code doesn't work without mocha-generators.

I think it's a little misleading.  Generators are native to Node 4.x.  I think the point the documentation is trying to make is that the tests are written using generators and run using `mocha-generators` which I believe works like `co` or `vo`.
",rosshinkley,kuraga
537,2016-03-18 18:08:25,"> No, it does not. If you use vo or co or mocha-generators, it takes care of that for you. If you wanted to use `yield` and `.then()` in vanilla JS with no dependencies, you'd have to manage the promise chain yourself. 

That's exactly I wanted to hear. Remember my words:

> > Please note that the examples are using the `mocha-generators` package for Mocha, which enables the support for generators.
> 
> Is this description wrong here? Do you mean ""which wraps generator function with `co`/`vo`"" instead of ""enables the support for generators""?

Let's precise documentation?

Thanks, @rosshinkley !
",kuraga,rosshinkley
535,2016-03-16 20:19:29,"Hey @rosshinkley,

Thank you, yeah sorry I removed my SO question should have updated here I actually did not have my `.dev` domain added to me ehosts and Chromes `.dev` magic was working for me but electron obviously does not do that.

Sorry for the question felt like a fool when I figured it out.

Cheers,
Otis.
",CrashyBang,rosshinkley
535,2016-03-16 20:21:45,"@CrashyBang Ahhh, okay.  That makes sense.  Glad you got it sorted out.
",rosshinkley,CrashyBang
534,2016-03-14 03:22:18,"Xvfb is how we use Nightmare in-house. it's not nearly as complicated as its been made out to be either. I can help you get it setup if you like @mwiegant 
",stephenmathieson,mwiegant
533,2016-06-15 03:31:24,"@rmoriz There is _some_ of that in [`nightmare-examples`](https://github.com/rosshinkley/nightmare-examples).  The Nightmare documentation is lean, to be sure, but much of that is intentional.
",rosshinkley,rmoriz
532,2016-03-16 21:22:17,"@nick2012 At a glance, the linked article should work fine.  Glad you got that sorted.

For your source, you're trying to write the file inside of an `.evaluate()` call, which runs in the Electron instance, not in your source.  Evaluated functions are stringified, transmitted to the wrapped Electron instance, and rebuilt using the `Function` constructor.  The variable lifting you're doing with `fs` won't work as the function is constructed and run in an entirely separate context, and `fs` is not included in the context object.  (Off the top of my head, I don't think `require` is even on the context object that is applied against `.evaluate()`.  Even if you wanted to include it there, I don't think you could.)

Fixing it should be straightfoward: rather than trying to write the file interior to `.evaluate()`, move the write out to `.then()`.  Something like:



... should get you headed in the right direction.
",rosshinkley,nick2012
531,2016-03-16 18:54:09,"I don't think you can transfer cookies across domains.  The [current specification](http://tools.ietf.org/html/rfc6265) that most browsers honor says the domain requested from the browser must match the cookie's origin domain or be a subdomain.  I'm paraphrasing, of course, but that's the spirit.  [This article on the current state of cookie domains](http://bayou.io/draft/cookie.domain.html) does a much more comprehensive job explaining how this works than I could do here.

@Velissel's example appears to be trying to put cookies from one domain onto another, which is forbidden to the best of my knowledge.

@rclai _might_ be talking about something different: are you trying to reuse cookies from the same domain across Nightmare instances?
",rosshinkley,rclai
531,2016-03-16 18:54:09,"I don't think you can transfer cookies across domains.  The [current specification](http://tools.ietf.org/html/rfc6265) that most browsers honor says the domain requested from the browser must match the cookie's origin domain or be a subdomain.  I'm paraphrasing, of course, but that's the spirit.  [This article on the current state of cookie domains](http://bayou.io/draft/cookie.domain.html) does a much more comprehensive job explaining how this works than I could do here.

@Velissel's example appears to be trying to put cookies from one domain onto another, which is forbidden to the best of my knowledge.

@rclai _might_ be talking about something different: are you trying to reuse cookies from the same domain across Nightmare instances?
",rosshinkley,Velissel
531,2016-03-16 18:58:26,"@rosshinkley I figured it out, this issue is not relevant to me anymore. I used the persistence options.
",rclai,rosshinkley
531,2016-03-16 19:09:30,"@rclai Ah, okay.  Good to know.  Thanks for the response. :)
",rosshinkley,rclai
531,2016-03-16 23:26:45,"@rosshinkley, problem is even with .something.abc.com, it does not work. What I wanted to do is as simple as set cookies before I start anything, but still can not find out a way
",Velissel,rosshinkley
531,2016-03-17 02:16:45,"@rosshinkley, the procedure is like this, I firstly go to google, then try to set cookies of a session I extracted from something.abc.com so that multiple newly opened instances will have the same session when I change those instances to something.abc.com, but it fails all the time no matter if domain is .something.abc.com or something.abc.com.

I tried it with phantomJS, it works with dot prefixed. Maybe it is the implementation of electron preventing it?

As far as I know, cookies without dot as prefix is usually set through set-cookie header section of a server's response, but most modern browsers consider cookies with or without dot at beginning the same now, so I was expecting electron to act the same...

BTW, using persist:somthing does not work for the website I am working on
",Velissel,rosshinkley
531,2016-03-17 21:05:32,"> ...  I firstly go to google, then try to set cookies of a session I extracted from something.abc.com so that multiple newly opened instances will have the same session when I change those instances to something.abc.com...

@Velissel I understand you want to preload the cookies before navigation, but I don't think Nightmare allows for adding cookies _prior_ to navigation.  I still don't think adding cookies across domains like you're doing is permitted.

With #425, you could probably extend Electron to add a hook to the `'did-start-loading'` event to add cookies prior to the page loading.  If it interests you, I could pull together an experimental plugin to prove feasibility.

> I tried it with phantomJS, it works with dot prefixed. Maybe it is the implementation of electron preventing it?

I'm skeptical it works in exactly the manner you're describing under Phantom.  I'd have to put together an experiment to see for myself.

> As far as I know, cookies without dot as prefix is usually set through set-cookie header section of a server's response, but most modern browsers consider cookies with or without dot at beginning the same now, so I was expecting electron to act the same...

This is correct - with or without is considered equivalent, at least to the best of my knowledge.

> BTW, using persist:somthing does not work for the website I am working on

Could you expand on this?  What exactly isn't working?
",rosshinkley,Velissel
531,2016-04-04 01:02:23,"> Could you expand on this? What exactly isn't working?

If I get purpose of persist partition correct, the scenario I am having is like this:
1. start an instance with partition set as 'persist:SAHRED_SESSION'
2. open www.example.com
3. type credentials to login
4. page is redirected to something.example.com and cookies for session is set at this point
5. start another instance with partition set as 'persist:SHARED_SESSION'
6. open something.example.com
I was expecting new instance will stay at something.example.com, but the fact is it gets redirected back to www.example.com because session in first instance is not shared with new instance

> @Velissel I understand you want to preload the cookies before navigation, but I don't think Nightmare allows for adding cookies prior to navigation. I still don't think adding cookies across domains like you're doing is permitted.
> With #425, you could probably extend Electron to add a hook to the 'did-start-loading' event to add cookies prior to the page loading. If it interests you, I could pull together an experimental plugin to prove feasibility.

If persist partition works then there is no issue on this at all. I know setting cross-domain cookie using javascript is definitely not permitted for safety reason, but when it comes to testing, having a way to preload cookie to keep session status is resonable I feel
",Velissel,Velissel
530,2016-03-17 15:19:06,"No problem. @nubunto, do you mind closing this issue since you’ve got it figured out?
",Mr0grog,nubunto
527,2016-04-18 05:04:37,"> > I'd prefer to err on the side of compliance over not. Thoughts?
> 
> I would generally agree. But since @matthewmueller didn’t write any docs and didn’t invite any discussion or review of the feature, I didn’t want to make an assumption about whether the non-compliant behavior was intended or just a bug.

Since this has sat for more than a month with no feedback from @matthewmueller , I’m going to go ahead and just transform it from a question to a statement and call it a bug:

`then()` **should** act like Promises/A+ `then()` and ES6 Promise `then()`. The second argument should not be called because of an exception while running the first argument.

If that’s cool with you, @rosshinkley. The implications are minor and, I think, an improvement.
",Mr0grog,rosshinkley
527,2016-04-18 20:07:40,"> If that’s cool with you, @rosshinkley. The implications are minor and, I think, an improvement.

👍 Absolutely.  Please, go ahead.
",rosshinkley,rosshinkley
525,2016-04-03 03:53:49,"@antpaw Yeah, there are intermittent failures I haven't gotten to the bottom of.  Have you had any luck?
",rosshinkley,antpaw
525,2016-05-24 16:55:18,"@antpaw Have you given this a try with later versions?  I wonder if you're hitting the `Xvfb` hang from #561.
",rosshinkley,antpaw
525,2016-05-31 14:18:34,"@rosshinkley hey, i've just checked the 2.5.0 version, it still hangs without any logs. the highest version it works for me is 2.1.3
",antpaw,rosshinkley
525,2016-05-31 14:21:56,"@antpaw Do you have `DEBUG` output?  What version of Node are you running?
",rosshinkley,antpaw
524,2016-03-08 14:57:25,"> So the fix is as simple as inserting a newline after the injected file’s source code:

@Mr0grog Ah, thank you.  I haven't had time to double back and take a look at why the versions that are excepting were causing syntax errors.

> So the fix is as simple as inserting a newline after the injected file’s source code:

Simple, yes - this makes me wonder how common a practice it is to _end_ a minified file with a sourcemap or comment.  It's out of scope for this question, but I'm still curious.

At any rate, I'll add the newline into the template .  Changes shortly.

> 1.11.0 beta 1 min and 2.1.0 beta 1 min have the same issue as 1.9.0.min and are fixed by the newline as noted above.

Good to know.  I think 1.9.x is probably the biggest offender.

> 1.1.3 and older expect to be loaded and run in global scope. They just define var $ = ... instead of window.$ = .... Since the injection template wraps all the code in a function, that variable never escapes the function’s scope and gets attached to the global object. That’s a more fundamental incompatibility; “fixing” older jQuery (and other scripts that behave like it) would necessarily break other features.

I'm unsurprised.  I vote leaving <1.1.x broken until compelling case to fix it is made.

That said, I wonder what use case exists where one would be purposefully injecting jQuery <1.1.x with Nightmare.  I could understand pages that already have early versions of jQuery included, but I can't think of a good reason to inject an old version other than for an experiment to determine what Nightmare works with.
",rosshinkley,Mr0grog
524,2016-03-22 16:45:47,"@Mr0grog A bit late, but I've added [a first draft](https://github.com/rosshinkley/nightmare-examples/blob/master/docs/known-issues/globally-defined-variables.md) of the globally defined variables example.
",rosshinkley,Mr0grog
522,2016-03-03 15:10:39,"Nice! Thanks for your patience and time @rosshinkley 
",kokujin,rosshinkley
521,2016-03-01 08:58:53,"Thanks @rosshinkley .
The app I'm automating uses jQ for all of the requests so I just added this snippet that forces every XHReq to contain those headers, what is close to what you proposed.



Anyway, is there a chance to have a feature like this in Nigthmare? Or how to achieve this in Electron?
",michalbe,rosshinkley
518,2016-03-03 14:36:05,"Thanks @rosshinkley 
",kokujin,rosshinkley
515,2016-03-05 12:33:38,"Thanks @rosshinkley. Your answers are very helpful!
",moroshko,rosshinkley
514,2016-03-25 08:14:19,"@justinmchase yeah, sorry for this.. this does make a change of the `inject` usage.

They have `result` returned with `func1();func2();result`.
If they want to have a function injected like yours, maybe they could use `evaluate` instead? 
",fritx,justinmchase
509,2016-03-06 13:02:02,"Once again, thanks @rosshinkley.

Actually, I think your firs example was more what I was looking for. May I clarify? I would like to test processes, for example a questionnaire or a wizard: I would like to evaluate the outcome after each step, in most cases a click and log the output to the console.

I am still having problems with the snippet, even with your fork


",kokujin,rosshinkley
509,2016-04-02 23:13:02,"@kokujin #476 has been merged.  Could you upgrade to 2.3.0?
",rosshinkley,kokujin
507,2016-02-26 16:56:38,"@csysmans no problem.  After I walked away, I realized I also hadn't mentioned that this could be pretty readily accomplished using `.evaluate()`.

Anyway, glad you found a solution. :)
",rosshinkley,csysmans
505,2016-02-26 13:05:32,"Thanks @rosshinkley, but the flag is just to open the devTools drawer but not detach it. Correct? 
",kokujin,rosshinkley
505,2016-02-26 15:00:46,"@kokujin No, the latest update will accept either `true` (to show the devtools) or an options hash that gets passed directly to `webContents.openDevTools()`.  For example:



...would detach the devtools window.
",rosshinkley,kokujin
505,2016-02-27 00:07:53,"@rosshinkley Thanks a lot for #506! Let's leave this issue open until #506 is merged. At least, for now, I can patch it in `node_modules` to debug things :)
",moroshko,rosshinkley
505,2016-02-29 16:31:33,"@kokujin #506 hasn't been accepted, and as such, is not a part of Nightmare.

If you absolutely need it, you could use the [branch on my fork](https://github.com/rosshinkley/nightmare/tree/505) instead.  For the nightmare dependency, you could have an entry in your `package.json` like:



Alternatively, you could fork Nightmare yourself and pull the changes in from that branch on my fork.
",rosshinkley,kokujin
505,2016-03-01 22:14:09,"Great! Thanks @rosshinkley 
",kokujin,rosshinkley
503,2016-02-25 22:19:21,"Thanks @rosshinkley! I should have guessed this.

Now, the error has gone, but the action still doesn't work:



This works fine:



What am I missing here?
",moroshko,rosshinkley
503,2016-02-26 05:21:26,"Thanks a lot @rosshinkley. This was very insightful!
",moroshko,rosshinkley
502,2016-04-15 19:09:31,"@Mr0grog Yeah, this may be a case of me trying to do an awful lot of work to save someone (me, if I can be totally selfish) ten seconds of setup grief.

As time permits, I'll throw together a proposal on running Xvfb internally to Nightmare.  Sound good?
",rosshinkley,Mr0grog
502,2016-04-29 20:44:18,"@Mr0grog Yes, at least for the moment.  I should probably go ahead and create a PR for it, but I know there are still some problematic tests.  Anyway!

> Maybe start xvfb separately

Well, it is.  Kind of.  Right now, each new Nightmare instance creates an Xvfb instance as well as an Electron instance (so Xvfb, Electron and Nightmare instances area all 1:1:1).  They are created together, and in my opinion, should end together.

> Electron starting/ending/overlapping at different times. I’m not sure if xvfb-run takes care of all that for you or not.

I don't know that handling a single Xvfb instance is going to work very well, at least not without the single-instance stuff getting done.  I also don't think starting an instance and leaving it running is particularly clean.  I'd prefer Nightmare to clean up after itself when it's finished.

I'm going to lump these together:

> Can you get the PID for Electron somehow? 
> Directly killing Electron is sort of a simple expedient; you could re-write it as an IPC call that asks the Electron process to quit.

Yes - from within Nightmare - but not without a bit of patching to how `.action()` works.  (It doesn't have an ambient reference to `process`.)  With that, you can bubble the Electron PID up to the parent process.  It's ugly.

I don't know you can get the PID from the process tree, either.  Maybe?  I had problems with killing the process tree (that was my first attempt), but this might be worth a second look.

The current incarnation adds another action to have Electron exit internally rather than killing the process from the parent.  This works, but again, breaks the kill test.
",rosshinkley,Mr0grog
501,2016-04-15 00:41:06,"> The only cases I can maybe see this being useful is with .screenshot(), .pdf() or .html(). Even at that, it's only the most trivial of cases of each.

On the one hand, even the most trivial cases should arguably be accompanied by a callback—you want to handle, or at least be notified of, failures.

However, I think it's useful to make things super simple for someone just getting started with Nightmare and trying things. I also think simply loading a page and taking a screenshot or saving a PDF is a Big Deal of a use case (that’s all I was trying to do when I discovered Nightmare and wound up writing all the frame manager stuff).

I like allowing no callback to be passed to `run`—with one tweak: the default callback should probably `console.error()` when errors occur. Otherwise I’d agree with @rosshinkley. Bottom-line, either solution would be _much_ better than the current situation.
",Mr0grog,rosshinkley
501,2016-04-15 19:44:24,"@h2non this patch would be awesome if you want to add some logging of errors to the default `fn` (unless you disagree with that notion). Thanks for writing it!
",Mr0grog,h2non
501,2016-05-31 04:29:54,"> that's how all the bundled libs with Node.js work (e.g. fs)

Maybe they used to and no longer do? Or I'm misunderstanding what you meant, @LinusU. I just tried the following in Node 4.4, 5.11, and 6.2; none of them threw an error:


",Mr0grog,LinusU
501,2016-05-31 14:11:43,"@LinusU Are you referring to `*sync` methods and when they except, maybe?
",rosshinkley,LinusU
499,2016-04-03 03:51:41,"@the-t-in-rtf Any progress on the PR suggestion?
",rosshinkley,the-t-in-rtf
499,2016-04-23 22:37:28,"I agree with @yoz.  I think #548 fixes this, and as such, I'm closing this issue.
",rosshinkley,yoz
498,2016-02-24 05:10:28,"@rosshinkley Thanks a lot for this! 
Just wondering, why `.wait(1000)` is required before taking the screenshot?
",moroshko,rosshinkley
498,2016-02-25 11:37:07,"@rosshinkley Ah! So, once #479 is merged, we'll no longer need the `.wait(1000)`?
",moroshko,rosshinkley
498,2016-02-25 19:53:41,"@moroshko That's right.  Once #479 is fixed, no more ""magic"" wait calls.

@mousemke #272 was opened to petition for a gitter room, you might want to go give that some support. :)

Addressing your question: that's curious.  Is that the case for _any_ screenshot, or only screenshots taken with getting the body dimensions first?
",rosshinkley,mousemke
498,2016-02-25 19:53:41,"@moroshko That's right.  Once #479 is fixed, no more ""magic"" wait calls.

@mousemke #272 was opened to petition for a gitter room, you might want to go give that some support. :)

Addressing your question: that's curious.  Is that the case for _any_ screenshot, or only screenshots taken with getting the body dimensions first?
",rosshinkley,moroshko
498,2016-04-03 03:51:04,"@mousemke Are you still having this issue?
",rosshinkley,mousemke
498,2016-04-16 01:56:24,"@mousemke sorry if this is obvious and you already thought of it, but are you on a device with a retina or other high-res display, like a Chromebook pixel, Retina MacBook Pro, etc? Electron will definitely give you a screenshot with “double the pixels” (or something else if you have a more than 2x display). The viewport dimensions you set are in “effective pixels” or “CSS pixels,” not device pixels.

I’m not sure there’s any way to explicitly change that, but writing a plugin will give you access to all the relevant modules in Electron: [`screen`](http://electron.atom.io/docs/v0.37.6/api/screen/) will tell you the scale factor for each display; [`WebFrame`](http://electron.atom.io/docs/v0.37.6/api/web-frame/) will let you do zooming, which you could use then use to counteract the scale factor—set the viewport to half your desired size and zoom to 0.5 to get 1:1 pixels, for example.
",Mr0grog,mousemke
498,2016-04-19 15:44:26,"Able to reproduce on a high-dpi device: the screenshot is 2x the height/width set in nightmare. @Mr0grog's  reasoning about the source seems valid.
",pci,Mr0grog
498,2016-04-23 20:31:16,"@Mr0grog @pci Of course! High device resolution!  That makes sense.

With that last mystery solved, I'm closing this issue as I think it has been fully resolved.
",rosshinkley,Mr0grog
498,2016-04-23 20:31:16,"@Mr0grog @pci Of course! High device resolution!  That makes sense.

With that last mystery solved, I'm closing this issue as I think it has been fully resolved.
",rosshinkley,pci
498,2016-12-09 05:17:29,"@Mr0grog  I'm struggling on this one, how do you access WebFrame to do the zooming, from `evaluate()` ? I get a `webFrame is not defined`. Thx",sebastienbarre,Mr0grog
498,2016-12-09 14:25:53,@Mr0grog `force-device-scale-factor` did the trick -- many thanks.,sebastienbarre,Mr0grog
496,2016-03-14 18:51:13,"Me too @erikdonohoo. I guess Segmentio folks are too busy to develop the project further, but they could al least merge PRs...
",tiangolo,erikdonohoo
496,2016-03-14 18:54:42,"In the meantime, maybe you could try it @erikdonohoo and @rclai to see if you find any bug or misbehavior... 

You could clone my fork, checkout to the branch with the fix and copy the code to your project's `node_modules` directory to test it... I guess if someone from the Segmentio team sees that others have tested this PR and agree that it's working it will be easier for them to merge it....
",tiangolo,erikdonohoo
496,2016-03-14 18:54:42,"In the meantime, maybe you could try it @erikdonohoo and @rclai to see if you find any bug or misbehavior... 

You could clone my fork, checkout to the branch with the fix and copy the code to your project's `node_modules` directory to test it... I guess if someone from the Segmentio team sees that others have tested this PR and agree that it's working it will be easier for them to merge it....
",tiangolo,rclai
496,2016-03-15 16:31:54,"It works great @tiangolo, thanks for this. I haven't seen any issues so far.
",rclai,tiangolo
496,2016-03-16 21:00:24,"@rclai I'm glad it's working! And thanks for testing it :smile: 

---

For your issue / suggestion, I guess there are these approaches:
1. The user checks if the IFrame exists before entering in it, maybe using `.exists()`: https://github.com/segmentio/nightmare#existsselector
2. Nightmare checks if the IFrame exists before entering in it, and only proceeds if the IFrame exists.
3. Nightmare checks if the IFrame exists before entering in it and throws an error if it doesn't.

Nevertheless, I think none of the other methods check or throw any error, for example, if you run `nightmare.type('.weird .non .existent .selector', 'some text that never gets typed')` you don't receive any error either.

I think that options 1 or 2 would be the most similar to how the rest of the code works.

---

But now, I'm actually worried that no one from Segmentio has even entered the conversation, and it has been quite some time... :disappointed:  

...even though this seems a useful feature (at least for the three of us).
",tiangolo,rclai
496,2016-03-16 21:56:18,"@rclai: It modifies internal stuff (quite ""core"" internal stuff).

It changes the preloaded JS sent to the browser.

I actually first tried creating a plug-in, but it wouldn't work without changing the core, or I would have had to override every method (and every future method) in Nightmare...

BTW, debugging tip (related to the internal stuff): It saves the root document object in `__nightmare.rootDocument` and the current IFrame's document object in `__nightmare.currentDocument`.

So, you can check in your Developer Tools (the console in your Nightmare Chromium window) if your `__nightmare.currentDocument` is pointing to the document that you expect to be in.
",tiangolo,rclai
496,2016-03-18 13:01:11,"Great! Thanks @mbernabeu for testing it!
",tiangolo,mbernabeu
496,2016-04-11 16:11:39,"@tiangolo I think this would be better served as a plugin for Nightmare.  Thoughts?
",rosshinkley,tiangolo
496,2016-04-11 16:16:14,"@rosshinkley, I tried that first but it's impossible as it modifies internal stuff. 

Check the full answer to that same question 4 comments above: https://github.com/segmentio/nightmare/pull/496#issuecomment-197568154
",tiangolo,rosshinkley
496,2016-04-11 16:42:20,"@tiangolo I saw the comment, thanks for the pointer.

I'm not entirely convinced it's not possible to turn this into a plugin.  Unlike, say, popups that make a new `BrowserWindow` which won't have _any_ of the Nightmare sugar baked in, the IFrames you're dealing with should still be in the same context.  I can see with modifying preload this might not be possible.  I'd have to play around with this PR to be sure.

Even if it weren't possible, I would be more inclined to modify the current plugin functionality to allow for functions like this.

Thoughts?
",rosshinkley,tiangolo
496,2016-04-11 19:06:52,"@rosshinkley, I tried at first all the ideas I had to make it a plug-in, but I had to throw all that code away and start from scratch because I found that I had to modify deeper functionality in Nightmare.

If you find a way to get that same behavior with a plug-in I would love to know how.

@Mr0grog that's a good point, not **every** action would work. I think the first approach would be to document which actions wouldn't work.

But at least for some cases, the actions that work seem to be quite useful for some of us.

I'm sure it works with `.type` (that's what I made it for).
I'm pretty sure it would also work for `.insert`, as the code is almost the same and also depends on `document`: https://github.com/segmentio/nightmare/blob/master/lib/actions.js#L175

Could you list all the _caveats_ that you find that _haven’t been talked through here_? How would you like to assess better those caveats so that we all know what would have to be done?
",tiangolo,Mr0grog
496,2016-04-11 19:06:52,"@rosshinkley, I tried at first all the ideas I had to make it a plug-in, but I had to throw all that code away and start from scratch because I found that I had to modify deeper functionality in Nightmare.

If you find a way to get that same behavior with a plug-in I would love to know how.

@Mr0grog that's a good point, not **every** action would work. I think the first approach would be to document which actions wouldn't work.

But at least for some cases, the actions that work seem to be quite useful for some of us.

I'm sure it works with `.type` (that's what I made it for).
I'm pretty sure it would also work for `.insert`, as the code is almost the same and also depends on `document`: https://github.com/segmentio/nightmare/blob/master/lib/actions.js#L175

Could you list all the _caveats_ that you find that _haven’t been talked through here_? How would you like to assess better those caveats so that we all know what would have to be done?
",tiangolo,rosshinkley
496,2016-04-25 00:04:41,"I finally had some time to circle back to this.  The short version is you _can_ do this with a plugin, but  not without overriding the `evaluate_now` method on the prototype.

The `document` (really, `window.top.document`) variable isn't settable (which is I'm guessing why @tiangolo had trouble with the plugin route).  Because of that, you can't set the `document` variable from within a regular plugin method.  This has the consequence of the only place remaining to alias `document` - at least in the current implementation of Nightmare - is in `evaluate_now`.  You _can_ override the Nightmare prototype's `evaluate_now`, and I've thrown together [a (horrifying) sample](https://github.com/rosshinkley/nightmare-iframe-manager).  (Use at your own peril.)

Patching `evaluate_now` to wrap `document` _technically_ works, but suffers from the same issues that implementing frame support directly suffers from.  Off the top of my head:
- `.scrollTo()` only scrolls the window, not the interior selected frame.  Scrolling interior to an `iframe` would have to be written.
- `.screenshot()` will still take a shot of the bounding rectangle if provided, including the parent frame(s).  Not that this is unexpected, but it may catch new users off guard.
- `.html()` and `.pdf()` will still return output for the entire page rather than the selected child frame.  Again, expected behavior, but not what I'd expect as a new user.

There might be other issues with some of the more advanced functions (authentication, for example), but I haven't had a chance to set up testing yet.
",rosshinkley,tiangolo
496,2016-04-25 02:00:39,"I should have reread the _entire_ thread before posting: [@Mr0grog covers issues](https://github.com/segmentio/nightmare/pull/496#issuecomment-208445167) more comprehensively than I did.  (Price of being in a hurry, apologies.)  I still think there are almost certainly other corner cases, though.  As time permits, I'll set up some test cases to verify what @Mr0grog outlined.

Setting that aside, it frames need to be a first-order citizen in Nightmare (along with `BrowserWindow`s).  I think this should make it onto the list for vNext.
",rosshinkley,Mr0grog
496,2016-04-25 17:11:22,"> Could you list all the caveats that you find that haven’t been talked through here?
- Globals variables (both built-ins and ones from scripts in the page in the frame). I think this is, far and away, the biggest thing. If people are expecting `evaluate` to execute code in the iframe, which is exactly the expectation this sets up, they would very reasonably expect to be able to access all the globals in that frame. They’d also expect to be able to be able to do things like compare constructors (e.g. `someFunctionInFrameThatReturnsArray().constructor !== Array`). There are an infinitely ridiculous number of use cases and ways people could trip over this.
- I think there’s a reasonable argument that it should probably work with `inject`. There are several issues related to users `inject`-ing jQuery (or a helper library of their choice) so they can use it when calling `evaluate`, so we know it’s something people are doing. On a cursory reading, it looks like it should _sort of_ work with JS (caveat the global issues above), but won’t work with CSS.
- Obviously, a discussion of all the Nightmare methods that are/aren’t affected. @rosshinkley listed a few. If you’re going to address possible caveats, you should list them all out. Ross also noted “there might be other issues with some of the more advanced functions (authentication, for example), but I haven't had a chance to set up testing yet.” No offense to anyone here, but… testing and validating that shouldn’t be on Ross. There are _a lot_ of issues and PRs here that need attention and Ross appears to be the only active maintainer.
- I think the issue of security is kind of a big deal here. The patch adds documentation that suggests setting `{'webPreferences': {'webSecurity': false}}` without really discussing that someone should at least think twice before doing that. There are a few issues that demonstrate people are using Nightmare to do tasks in very security-sensitive settings (e.g. #545); setting `websecurity: false` while doing something like that is a Really Bad Idea™. It may even be worth fixing https://github.com/electron/electron/issues/5115 upstream first to alleviate this.

Not a caveat, but probably also a good idea to have tests that cover all the other methods that are affected by this. e.g. `can type into elements in iframe`.

Other minor nit: maybe worth renaming to `enterFrame` since this is just as applicable to other kinds of frames? (`<frame>`, `<iframe>`, `<object>`)

And an open question, because there’s been no discussion of it here and I think it’s important for any new API being added to core: is this the best API for working with subframes?
- The original issue (#203) had an API using functions that could have eliminated the need for a second method call to “exit” the frame.
- If this is going into core, would it better to change the methods that take selectors to allow special selectors that reach into frames? e.g. `.click('.some > iframe / #a .button-in-the-frame')`
",Mr0grog,rosshinkley
496,2016-06-09 11:47:41,"Thank you @rosshinkley and @Mr0grog for paying attention to this.

I see that there are several issues that would be hard to deal with in trying to integrate this into Nightmare. And probably the way to go would be a new module as the one @rosshinkley built that patches `evaluate_now`.

Nevertheless, I'm being unable to use @rosshinkley's https://github.com/rosshinkley/nightmare-iframe-manager, its code never gets executed in the current environment. Maybe I'm doing something wrong, but I cloned the repo and tried to run the tests (after installing a couple undeclared packages) but they all seem to fail. Again, I'm probably doing something wrong, but maybe you can guide me on how we should use your package / module to get this feature.
",tiangolo,Mr0grog
496,2016-06-09 11:47:41,"Thank you @rosshinkley and @Mr0grog for paying attention to this.

I see that there are several issues that would be hard to deal with in trying to integrate this into Nightmare. And probably the way to go would be a new module as the one @rosshinkley built that patches `evaluate_now`.

Nevertheless, I'm being unable to use @rosshinkley's https://github.com/rosshinkley/nightmare-iframe-manager, its code never gets executed in the current environment. Maybe I'm doing something wrong, but I cloned the repo and tried to run the tests (after installing a couple undeclared packages) but they all seem to fail. Again, I'm probably doing something wrong, but maybe you can guide me on how we should use your package / module to get this feature.
",tiangolo,rosshinkley
496,2016-06-09 12:34:10,"@tiangolo I'd suggest opening issues at nightmare-iframe-manager.  (Looking at it offhand, I'd bet there's a problem with the Nightmare version.  I put the plugin together more as a proof of concept than anything.)  Time permitting, I'll see if I can fix the glaring problems.  If you could report the issue(s) you had there, that would help tremendously.
",rosshinkley,tiangolo
496,2016-06-09 12:59:03,"OK, get it @rosshinkley. 

Are you planning on uploading it later to NPM? Do you want to keep it just as a proof of concept or do you want to keep developing it?
Or do you want me to fork it, try to fix my issues and then upload to NPM?
",tiangolo,rosshinkley
496,2016-06-12 03:49:01,"For the other Nightmare users in this thread that wanted this functionality (with all the risky security concerns already mentioned), using @rosshinkley's plug-in is working now. 

His plug-in is based on this PR and even improves the functionality.

Check his documentation at: https://github.com/rosshinkley/nightmare-iframe-manager

(Make sure to update your code as the names and meaning of the methods changed a little bit).

As there isn't an NPM package, to install it in your projects you need to run:



NPM will understand that it needs to go for the GitHub repo (but you will need to have git installed).

---

@rosshinkley and @Mr0grog, with that plug-in I have the functionality I (and I think most of us in this thread) wanted (with all the risks / security up to us). For me it's OK if you just reject and close this PR now. Thanks!
",tiangolo,Mr0grog
496,2016-06-12 03:49:01,"For the other Nightmare users in this thread that wanted this functionality (with all the risky security concerns already mentioned), using @rosshinkley's plug-in is working now. 

His plug-in is based on this PR and even improves the functionality.

Check his documentation at: https://github.com/rosshinkley/nightmare-iframe-manager

(Make sure to update your code as the names and meaning of the methods changed a little bit).

As there isn't an NPM package, to install it in your projects you need to run:



NPM will understand that it needs to go for the GitHub repo (but you will need to have git installed).

---

@rosshinkley and @Mr0grog, with that plug-in I have the functionality I (and I think most of us in this thread) wanted (with all the risks / security up to us). For me it's OK if you just reject and close this PR now. Thanks!
",tiangolo,rosshinkley
495,2016-09-28 01:53:23,"@skysilence See https://github.com/kyungw00k/nightmare-webrequest-addon/blob/master/README.md first
",kyungw00k,skysilence
494,2016-03-30 03:27:24,"@Mr0grog Ooh, that's not great.  I'd +1 for a PR.
",rosshinkley,Mr0grog
493,2016-12-08 08:38:51,"@GautierT I think you might be a bit mixed up here—nothing on this issue is about problems running multiple instances of Nightmare at once (in fact doing so *solves* the issues here; this is about doing multiple sets of actions with *one* Nightmare instance).

Your problem sounds a lot like #612. One thing you might want to try is using random partition names or memory partitions, like so:



If that doesn’t help, you might want to make a separate issue, since your problem is definitely off-topic for this thread.",Mr0grog,GautierT
493,2016-12-08 10:01:43,"@Mr0grog : Ok. Sorry for the miss understanding.. !
My current partition setting is 
`webPreferences: {
       partition: 'nopersist'
 },
`
and i haven't set `session`.
I will try with a random partition number !",GautierT,Mr0grog
493,2016-12-08 18:37:39,@GautierT No worries! I hope you get it figured out.,Mr0grog,GautierT
491,2016-02-17 22:14:26,"@Mr0grog no problem.  I apologize if I zapped any of your efforts, but I saw #490 this morning and figured that since I was in there, I may as well patch up the other stuff you pointed out.

As for not including external libraries: I agree.  Adding additional dependencies with their own quirks and learning curve only serves to make the learning process more difficult.  I use `vo` when it's convenient, but I guess the main takeaway here is that you don't _have_ to use any outside libraries to use Nightmare.  Recommending using `.then()`, though?  Always?  That makes me ... uncomfortable.  It's hard for me to articulate why outside of aesthetic reasons.  Right tool for the job, I suppose.

Which brings me to your next point: I think adding examples for common usecases and popular libraries would be wildly helpful - something along the lines of Including an examples directory with documentation for each example.
",rosshinkley,Mr0grog
491,2016-02-17 23:59:25,"@rosshinkley Oh, no, you didn't zap any of my efforts at all; no worries! I held off on making any changes in that area since it sounded like @matthewmueller was making a bunch ideological changes that aren't written down anywhere, so I figured I'd wait to hear back or see what he did before _I_ tried to actually do anything more.

> Recommending using .then(), though? Always? That makes me ... uncomfortable. It's hard for me to articulate why outside of aesthetic reasons.

Well… we could focus on `run` or `end` instead. Then you have the ""callback API"" and the ""promise API."" To be honest, though, I'm not sure I have the same aesthetic concerns with `then`—I kind of like it ;)

The biggest thing I'm concerned with about moving away from generator-based examples is that several things are buggy in Nightmare if you ask it to handle multiple queues at once—and that's easy/inviting to do if you focus on the run/end/then API. See, for example, #465. On the other hand, I'd bet those issues exist because early authors focused on using generators and so rarely tripped over bugs that happen when multiple operations are going on simultaneously. But all that is a big discussion that is somewhat separate from how things are documented! So I'll shut up on that for now.

> I think adding examples for common usecases and popular libraries would be wildly helpful - something along the lines of Including an examples directory with documentation for each example.

Ooh, definitely! I think the documentation, in general, could be vastly improved. Several of the issues and questions in #472 are ones I ran into when I first started looking at Nightmare, too (I also think it would be great if all methods returned a promise or thunk—there's no reason a nightmare instance can't actually be one of those things, but that's _way_ out of scope here).

_[Rant warning:]_ Anyway, I'd _would_ love to volunteer to help with that, but… I'm personally a bit wary of diving into major changes to docs (or other changes of similar scope). There's no documentation here relating to direction or process for the project. I'm not sure whether there are people at Segment (or outside it) who are acting as maintainers other than @matthewmueller. And when he makes a sudden change in project direction and only announces that change in a comment on a random issue/PR, as happened in #482, or makes surprising API changes with nary a PR or even a comment in an issue (like making `then` act more like a promise after much discussion against or not very in favor of it in #256), or even when issues and PRs can sit for months (e.g. #222) with no maintainer feedback at all (even just a ""no thanks""), I don't have much confidence that big contributions will be well respected.

That's especially true for docs. It's hard to do a good job with them when you don't know what direction the project is headed. What parts should be focused on? What things should be downplayed because owners/contributors don't feel great about them? What's deprecated and going away? What are the known gotchas? And so on. #482, again, is a great example here: in previous issues, @matthewmueller talks about `then()` as a private API, only there to make vo behave properly. Now, with no other discussion in between, it's suddenly the primary front-and-center way to use Nightmare.

Anyway, I know you weren't necessarily asking for my help and sorry for the sudden rant there. I hate to heap on a lot of criticism when I've only been observing the goings-on here for a couple weeks. I hope there's not a mailing list or something I'm totally missing out on. It felt like it needed to be said somewhere, though.
",Mr0grog,rosshinkley
491,2016-02-18 03:03:30,"thanks @rosshinkley for the fixes – though i'm a bit surprised about the id change since I tested this two days ago. I wonder if yahoo is doing something weird with rendering.

---

@Mr0grog you mentioned a lot here so let me address a few things:

**1. I apologize about the API change**

I changed my mind about returning a promise, mostly because you can now use Promises natively in latest node, so you don't need to include Bluebird or anything big.

I should have mentioned something, but to be honest I'm not sure it broke anyone's code. Let's be clear, the only API change is: _.then() returns a promise and not a nightmare instance_

The goal of this change was to make it more familiar to newcomers and remove the additional dependency that was confusing in the first place.

**2. I strongly disagree that big contributions aren't welcome**

If you go back in the merged PRs, there are some really big PRs that have been merged. It does take time to go through some of the bigger ones though since a lot of people depend on this library and I have other commitments outside of working on Nightmare.

**3. Direction**

The next two things on my TODO list for nightmare is to get @rosshinkley's #425 merged and create better documentation (a quick how-to video) on how to run Docker on linux.
",matthewmueller,Mr0grog
491,2016-02-18 03:03:30,"thanks @rosshinkley for the fixes – though i'm a bit surprised about the id change since I tested this two days ago. I wonder if yahoo is doing something weird with rendering.

---

@Mr0grog you mentioned a lot here so let me address a few things:

**1. I apologize about the API change**

I changed my mind about returning a promise, mostly because you can now use Promises natively in latest node, so you don't need to include Bluebird or anything big.

I should have mentioned something, but to be honest I'm not sure it broke anyone's code. Let's be clear, the only API change is: _.then() returns a promise and not a nightmare instance_

The goal of this change was to make it more familiar to newcomers and remove the additional dependency that was confusing in the first place.

**2. I strongly disagree that big contributions aren't welcome**

If you go back in the merged PRs, there are some really big PRs that have been merged. It does take time to go through some of the bigger ones though since a lot of people depend on this library and I have other commitments outside of working on Nightmare.

**3. Direction**

The next two things on my TODO list for nightmare is to get @rosshinkley's #425 merged and create better documentation (a quick how-to video) on how to run Docker on linux.
",matthewmueller,rosshinkley
491,2016-02-18 17:28:03,"I realize that this PR is closed, but I feel compelled (and somewhat responsible) to respond to the commentary.  I'm going to _try_ to respond to both of your comments.  (This is going to be a bit of a missive; strap in for a long read.)

> Oh, no, you didn't zap any of my efforts at all; no worries!

I'm relieved. :)  Duplicate work is the worst kind of work.

> Well… we could focus on run or end instead. Then you have the ""callback API"" and the ""promise API."" To be honest, though, I'm not sure I have the same aesthetic concerns with then—I kind of like it ;)

I guess getting back to a point @Mr0grog made: I am biased for using `yield`.  No real reason other than ""it looks nice"" and it has fit in well with what I've done with Nightmare.  And it's not like I'm _losing_ that ability, but I do think it's worth providing a usage sample.

> The biggest thing I'm concerned with about moving away from generator-based examples is that several things are buggy in Nightmare if you ask it to handle multiple queues at once—and that's easy/inviting to do if you focus on the run/end/then API. 

This may be - is? - getting a bit off topic, but while running parallel operations on a single page should Just Work&trade;, running parallel operations across multiple domains with a single Nightmare instance won't work.  It can't work.  At least not in the current incarnation.

That said, I am very interested in the outcome of #465.  I suspect there's other issues in the guts of Nightmare to getting single-page parallel operations to work.  I haven't carved out time to really get into it, though.

While I'm on this tangent, documenting single-domain (well, single URI anyway) parallel operations would be kind of tricky.  They would have to state outright that you cannot perform actions across domains at the same time.  However...

>  But all that is a big discussion that is somewhat separate from how things are documented! So I'll shut up on that for now.

Yeah, I should too.  I propose we move that conversation over to #465.  Hopefully I'll have something constructive to add there soon. :)

> Ooh, definitely! I think the documentation, in general, could be vastly improved.  Several of the issues and questions in #472 are ones I ran into when I first started looking at Nightmare, too 

Same.  I'm not above sandboxing for a bit, and that sort of work doesn't frustrate me.   I can totally understand and relate to where it would be frustrating, especially to someone not terribly familiar with javascript.  Example usage - at least, non-issue, non-test case example usage - to flog this horse I'm pretty sure is already dead, would be great.

> (I also think it would be great if all methods returned a promise or thunk—there's no reason a nightmare instance can't actually be one of those things, but that's way out of scope here).

As you pointed out, this is also kind of out in the weeds, but I just wanted to quickly point out that all of the methods _do_ return a thennable as Nightmare itself (partially) implements promises.  Having Nightmare directly inherit from `Promise` opens a bit of a can of worms.  (I touched on this briefly in #472.)

> [Rant warning:] 

Off topic, but I have to admit, that 1) this gave me a chuckle and 2) thank you.  I'm going to skip around a bit now, as I think the bulk of the ""rant"" should be addressed with @matthewmueller's comment.

> #482, again, is a great example here: in previous issues, @matthewmueller talks about then() as a private API, only there to make vo behave properly. Now, with no other discussion in between, it's suddenly the primary front-and-center way to use Nightmare.

This was what I was getting at with my original question about excising `vo`.  I had seen commentary for both ways and wanted clarification - and perhaps more importantly, justification - written down somewhere for posterity.  I am _certain_ it's going to come up in questions again and I wanted to have a reference to point at.  (The poor, poor souls that get this PR as a reference in the future.  Apologies to future readers everywhere.)

To be honest, even with my self-reported biases, I don't really care what the suggested usage is.  It needs to be documented, and big shifts in usage need to be justified.

Moving on...

> thanks @rosshinkley for the fixes – though i'm a bit surprised about the id change since I tested this two days ago. I wonder if yahoo is doing something weird with rendering.

No problem.  I feel like Yahoo has changed IDs of either the search bar or button or both in the past.  I have this nagging memory of seeing this issue before, but a cursory glance through the issues yielded nothing.  On a related note, I suspect it's not the last time it'll happen.

> I should have mentioned something, but to be honest I'm not sure it broke anyone's code.  The goal of this change was to make it more familiar to newcomers and remove the additional dependency that was confusing in the first place.

I also doubt it broke much, if anything.  It _does_ make usage a bit strange, though.  Calling `.end()` before `.then()` looks kind of odd to me.  It's also worth pointing out that adding something akin to [Underscore's `tap`](http://underscorejs.org/#tap) method so you can interact with values from functions like `.evaluate()` before `.then()` might be handy.  Food for thought, and I'd be willing to work on that if it's something worth including.

Also, thank you for the clarification on the removal.

> @Mr0grog 
> 
> > ... or makes surprising API changes with nary a PR or even a comment in an issue (like making then act more like a promise after much discussion against or not very in favor of it in #256), or even when issues and PRs can sit for months (e.g. #222) with no maintainer feedback at all (even just a ""no thanks""), I don't have much confidence that big contributions will be well respected.
> 
> @matthewmueller
> 
> > If you go back in the merged PRs, there are some really big PRs that have been merged. It does take time to go through some of the bigger ones though since a lot of people depend on this library and I have other commitments outside of working on Nightmare.

Not having the change documented via a PR is a bit frustrating, if for no other reason that there's no real trail to hold up as when and why the change was made.  With respect to the PRs, I understand the bigger ones take time to review.  Especially ones that change the shape and surface of Nightmare, like #425 (not to toot my own horn).  I also understand that Nightmare competes for attention and priority.  Commentary or updates on PRs are nice to have, and help encourage contribution.

> @Mr0grog 
> 
> > That's [being contribution consideration] especially true for docs. It's hard to do a good job with them when you don't know what direction the project is headed. What parts should be focused on? What things should be downplayed because owners/contributors don't feel great about them? What's deprecated and going away? What are the known gotchas? And so on.
> 
> @matthewmueller 
> 
> > The next two things on my TODO list for nightmare is to get @rosshinkley's #425 merged and create better documentation (a quick how-to video) on how to run Docker on linux.

Thank you for the todo list, and I'm thrilled that #425 is on deck.

Based on my observations in this project, the direction (at least since moving off of Phantom and onto Electron) has been ad hoc.  Folks wanting certain functionality ask for it, and in general, that piece is discussed and added or fixed in isolation.

With that in mind, I don't know that a more comprehensive project map is possible.  Again, most of the changes I've seen have been an outgrowth of issues or desired behavior, and that kind of thing is tough to predict.  And if I'm being totally honest, I'm not sure the onus is on the ownership to suss that out.  Iterating based on feedback makes for a better project, in my humble opinion, and has the added benefit of being relatively easy.

And with _that_ in mind, this gets back to a motif:  Documentation.  I very (emphasis on very) strongly agree that deprecation and gotchas should be documented.  I also think - and I know I've made this clear already - that changes should be documented.  While I'm repeating myself, I'll mention again that documenting common use cases with popular libraries should also probably be included.

What would be nice - and I think might go a long way to addressing @Mr0grog's list - would be guidelines for requesting functionality, guidelines for submitting issues, and guidelines for submitting PRs.  Perhaps even some general notes on what to expect with those items.  #425 magnifies the above problems, adding the question of what belongs in the core of Nightmare vs. what should be a plugin.  Thoughts?

---

Finally, thank you both for the commentary and criticism.  I think this discussion is an important one and needed to be had.
",rosshinkley,matthewmueller
491,2016-02-18 17:28:03,"I realize that this PR is closed, but I feel compelled (and somewhat responsible) to respond to the commentary.  I'm going to _try_ to respond to both of your comments.  (This is going to be a bit of a missive; strap in for a long read.)

> Oh, no, you didn't zap any of my efforts at all; no worries!

I'm relieved. :)  Duplicate work is the worst kind of work.

> Well… we could focus on run or end instead. Then you have the ""callback API"" and the ""promise API."" To be honest, though, I'm not sure I have the same aesthetic concerns with then—I kind of like it ;)

I guess getting back to a point @Mr0grog made: I am biased for using `yield`.  No real reason other than ""it looks nice"" and it has fit in well with what I've done with Nightmare.  And it's not like I'm _losing_ that ability, but I do think it's worth providing a usage sample.

> The biggest thing I'm concerned with about moving away from generator-based examples is that several things are buggy in Nightmare if you ask it to handle multiple queues at once—and that's easy/inviting to do if you focus on the run/end/then API. 

This may be - is? - getting a bit off topic, but while running parallel operations on a single page should Just Work&trade;, running parallel operations across multiple domains with a single Nightmare instance won't work.  It can't work.  At least not in the current incarnation.

That said, I am very interested in the outcome of #465.  I suspect there's other issues in the guts of Nightmare to getting single-page parallel operations to work.  I haven't carved out time to really get into it, though.

While I'm on this tangent, documenting single-domain (well, single URI anyway) parallel operations would be kind of tricky.  They would have to state outright that you cannot perform actions across domains at the same time.  However...

>  But all that is a big discussion that is somewhat separate from how things are documented! So I'll shut up on that for now.

Yeah, I should too.  I propose we move that conversation over to #465.  Hopefully I'll have something constructive to add there soon. :)

> Ooh, definitely! I think the documentation, in general, could be vastly improved.  Several of the issues and questions in #472 are ones I ran into when I first started looking at Nightmare, too 

Same.  I'm not above sandboxing for a bit, and that sort of work doesn't frustrate me.   I can totally understand and relate to where it would be frustrating, especially to someone not terribly familiar with javascript.  Example usage - at least, non-issue, non-test case example usage - to flog this horse I'm pretty sure is already dead, would be great.

> (I also think it would be great if all methods returned a promise or thunk—there's no reason a nightmare instance can't actually be one of those things, but that's way out of scope here).

As you pointed out, this is also kind of out in the weeds, but I just wanted to quickly point out that all of the methods _do_ return a thennable as Nightmare itself (partially) implements promises.  Having Nightmare directly inherit from `Promise` opens a bit of a can of worms.  (I touched on this briefly in #472.)

> [Rant warning:] 

Off topic, but I have to admit, that 1) this gave me a chuckle and 2) thank you.  I'm going to skip around a bit now, as I think the bulk of the ""rant"" should be addressed with @matthewmueller's comment.

> #482, again, is a great example here: in previous issues, @matthewmueller talks about then() as a private API, only there to make vo behave properly. Now, with no other discussion in between, it's suddenly the primary front-and-center way to use Nightmare.

This was what I was getting at with my original question about excising `vo`.  I had seen commentary for both ways and wanted clarification - and perhaps more importantly, justification - written down somewhere for posterity.  I am _certain_ it's going to come up in questions again and I wanted to have a reference to point at.  (The poor, poor souls that get this PR as a reference in the future.  Apologies to future readers everywhere.)

To be honest, even with my self-reported biases, I don't really care what the suggested usage is.  It needs to be documented, and big shifts in usage need to be justified.

Moving on...

> thanks @rosshinkley for the fixes – though i'm a bit surprised about the id change since I tested this two days ago. I wonder if yahoo is doing something weird with rendering.

No problem.  I feel like Yahoo has changed IDs of either the search bar or button or both in the past.  I have this nagging memory of seeing this issue before, but a cursory glance through the issues yielded nothing.  On a related note, I suspect it's not the last time it'll happen.

> I should have mentioned something, but to be honest I'm not sure it broke anyone's code.  The goal of this change was to make it more familiar to newcomers and remove the additional dependency that was confusing in the first place.

I also doubt it broke much, if anything.  It _does_ make usage a bit strange, though.  Calling `.end()` before `.then()` looks kind of odd to me.  It's also worth pointing out that adding something akin to [Underscore's `tap`](http://underscorejs.org/#tap) method so you can interact with values from functions like `.evaluate()` before `.then()` might be handy.  Food for thought, and I'd be willing to work on that if it's something worth including.

Also, thank you for the clarification on the removal.

> @Mr0grog 
> 
> > ... or makes surprising API changes with nary a PR or even a comment in an issue (like making then act more like a promise after much discussion against or not very in favor of it in #256), or even when issues and PRs can sit for months (e.g. #222) with no maintainer feedback at all (even just a ""no thanks""), I don't have much confidence that big contributions will be well respected.
> 
> @matthewmueller
> 
> > If you go back in the merged PRs, there are some really big PRs that have been merged. It does take time to go through some of the bigger ones though since a lot of people depend on this library and I have other commitments outside of working on Nightmare.

Not having the change documented via a PR is a bit frustrating, if for no other reason that there's no real trail to hold up as when and why the change was made.  With respect to the PRs, I understand the bigger ones take time to review.  Especially ones that change the shape and surface of Nightmare, like #425 (not to toot my own horn).  I also understand that Nightmare competes for attention and priority.  Commentary or updates on PRs are nice to have, and help encourage contribution.

> @Mr0grog 
> 
> > That's [being contribution consideration] especially true for docs. It's hard to do a good job with them when you don't know what direction the project is headed. What parts should be focused on? What things should be downplayed because owners/contributors don't feel great about them? What's deprecated and going away? What are the known gotchas? And so on.
> 
> @matthewmueller 
> 
> > The next two things on my TODO list for nightmare is to get @rosshinkley's #425 merged and create better documentation (a quick how-to video) on how to run Docker on linux.

Thank you for the todo list, and I'm thrilled that #425 is on deck.

Based on my observations in this project, the direction (at least since moving off of Phantom and onto Electron) has been ad hoc.  Folks wanting certain functionality ask for it, and in general, that piece is discussed and added or fixed in isolation.

With that in mind, I don't know that a more comprehensive project map is possible.  Again, most of the changes I've seen have been an outgrowth of issues or desired behavior, and that kind of thing is tough to predict.  And if I'm being totally honest, I'm not sure the onus is on the ownership to suss that out.  Iterating based on feedback makes for a better project, in my humble opinion, and has the added benefit of being relatively easy.

And with _that_ in mind, this gets back to a motif:  Documentation.  I very (emphasis on very) strongly agree that deprecation and gotchas should be documented.  I also think - and I know I've made this clear already - that changes should be documented.  While I'm repeating myself, I'll mention again that documenting common use cases with popular libraries should also probably be included.

What would be nice - and I think might go a long way to addressing @Mr0grog's list - would be guidelines for requesting functionality, guidelines for submitting issues, and guidelines for submitting PRs.  Perhaps even some general notes on what to expect with those items.  #425 magnifies the above problems, adding the question of what belongs in the core of Nightmare vs. what should be a plugin.  Thoughts?

---

Finally, thank you both for the commentary and criticism.  I think this discussion is an important one and needed to be had.
",rosshinkley,rosshinkley
491,2016-02-18 17:28:03,"I realize that this PR is closed, but I feel compelled (and somewhat responsible) to respond to the commentary.  I'm going to _try_ to respond to both of your comments.  (This is going to be a bit of a missive; strap in for a long read.)

> Oh, no, you didn't zap any of my efforts at all; no worries!

I'm relieved. :)  Duplicate work is the worst kind of work.

> Well… we could focus on run or end instead. Then you have the ""callback API"" and the ""promise API."" To be honest, though, I'm not sure I have the same aesthetic concerns with then—I kind of like it ;)

I guess getting back to a point @Mr0grog made: I am biased for using `yield`.  No real reason other than ""it looks nice"" and it has fit in well with what I've done with Nightmare.  And it's not like I'm _losing_ that ability, but I do think it's worth providing a usage sample.

> The biggest thing I'm concerned with about moving away from generator-based examples is that several things are buggy in Nightmare if you ask it to handle multiple queues at once—and that's easy/inviting to do if you focus on the run/end/then API. 

This may be - is? - getting a bit off topic, but while running parallel operations on a single page should Just Work&trade;, running parallel operations across multiple domains with a single Nightmare instance won't work.  It can't work.  At least not in the current incarnation.

That said, I am very interested in the outcome of #465.  I suspect there's other issues in the guts of Nightmare to getting single-page parallel operations to work.  I haven't carved out time to really get into it, though.

While I'm on this tangent, documenting single-domain (well, single URI anyway) parallel operations would be kind of tricky.  They would have to state outright that you cannot perform actions across domains at the same time.  However...

>  But all that is a big discussion that is somewhat separate from how things are documented! So I'll shut up on that for now.

Yeah, I should too.  I propose we move that conversation over to #465.  Hopefully I'll have something constructive to add there soon. :)

> Ooh, definitely! I think the documentation, in general, could be vastly improved.  Several of the issues and questions in #472 are ones I ran into when I first started looking at Nightmare, too 

Same.  I'm not above sandboxing for a bit, and that sort of work doesn't frustrate me.   I can totally understand and relate to where it would be frustrating, especially to someone not terribly familiar with javascript.  Example usage - at least, non-issue, non-test case example usage - to flog this horse I'm pretty sure is already dead, would be great.

> (I also think it would be great if all methods returned a promise or thunk—there's no reason a nightmare instance can't actually be one of those things, but that's way out of scope here).

As you pointed out, this is also kind of out in the weeds, but I just wanted to quickly point out that all of the methods _do_ return a thennable as Nightmare itself (partially) implements promises.  Having Nightmare directly inherit from `Promise` opens a bit of a can of worms.  (I touched on this briefly in #472.)

> [Rant warning:] 

Off topic, but I have to admit, that 1) this gave me a chuckle and 2) thank you.  I'm going to skip around a bit now, as I think the bulk of the ""rant"" should be addressed with @matthewmueller's comment.

> #482, again, is a great example here: in previous issues, @matthewmueller talks about then() as a private API, only there to make vo behave properly. Now, with no other discussion in between, it's suddenly the primary front-and-center way to use Nightmare.

This was what I was getting at with my original question about excising `vo`.  I had seen commentary for both ways and wanted clarification - and perhaps more importantly, justification - written down somewhere for posterity.  I am _certain_ it's going to come up in questions again and I wanted to have a reference to point at.  (The poor, poor souls that get this PR as a reference in the future.  Apologies to future readers everywhere.)

To be honest, even with my self-reported biases, I don't really care what the suggested usage is.  It needs to be documented, and big shifts in usage need to be justified.

Moving on...

> thanks @rosshinkley for the fixes – though i'm a bit surprised about the id change since I tested this two days ago. I wonder if yahoo is doing something weird with rendering.

No problem.  I feel like Yahoo has changed IDs of either the search bar or button or both in the past.  I have this nagging memory of seeing this issue before, but a cursory glance through the issues yielded nothing.  On a related note, I suspect it's not the last time it'll happen.

> I should have mentioned something, but to be honest I'm not sure it broke anyone's code.  The goal of this change was to make it more familiar to newcomers and remove the additional dependency that was confusing in the first place.

I also doubt it broke much, if anything.  It _does_ make usage a bit strange, though.  Calling `.end()` before `.then()` looks kind of odd to me.  It's also worth pointing out that adding something akin to [Underscore's `tap`](http://underscorejs.org/#tap) method so you can interact with values from functions like `.evaluate()` before `.then()` might be handy.  Food for thought, and I'd be willing to work on that if it's something worth including.

Also, thank you for the clarification on the removal.

> @Mr0grog 
> 
> > ... or makes surprising API changes with nary a PR or even a comment in an issue (like making then act more like a promise after much discussion against or not very in favor of it in #256), or even when issues and PRs can sit for months (e.g. #222) with no maintainer feedback at all (even just a ""no thanks""), I don't have much confidence that big contributions will be well respected.
> 
> @matthewmueller
> 
> > If you go back in the merged PRs, there are some really big PRs that have been merged. It does take time to go through some of the bigger ones though since a lot of people depend on this library and I have other commitments outside of working on Nightmare.

Not having the change documented via a PR is a bit frustrating, if for no other reason that there's no real trail to hold up as when and why the change was made.  With respect to the PRs, I understand the bigger ones take time to review.  Especially ones that change the shape and surface of Nightmare, like #425 (not to toot my own horn).  I also understand that Nightmare competes for attention and priority.  Commentary or updates on PRs are nice to have, and help encourage contribution.

> @Mr0grog 
> 
> > That's [being contribution consideration] especially true for docs. It's hard to do a good job with them when you don't know what direction the project is headed. What parts should be focused on? What things should be downplayed because owners/contributors don't feel great about them? What's deprecated and going away? What are the known gotchas? And so on.
> 
> @matthewmueller 
> 
> > The next two things on my TODO list for nightmare is to get @rosshinkley's #425 merged and create better documentation (a quick how-to video) on how to run Docker on linux.

Thank you for the todo list, and I'm thrilled that #425 is on deck.

Based on my observations in this project, the direction (at least since moving off of Phantom and onto Electron) has been ad hoc.  Folks wanting certain functionality ask for it, and in general, that piece is discussed and added or fixed in isolation.

With that in mind, I don't know that a more comprehensive project map is possible.  Again, most of the changes I've seen have been an outgrowth of issues or desired behavior, and that kind of thing is tough to predict.  And if I'm being totally honest, I'm not sure the onus is on the ownership to suss that out.  Iterating based on feedback makes for a better project, in my humble opinion, and has the added benefit of being relatively easy.

And with _that_ in mind, this gets back to a motif:  Documentation.  I very (emphasis on very) strongly agree that deprecation and gotchas should be documented.  I also think - and I know I've made this clear already - that changes should be documented.  While I'm repeating myself, I'll mention again that documenting common use cases with popular libraries should also probably be included.

What would be nice - and I think might go a long way to addressing @Mr0grog's list - would be guidelines for requesting functionality, guidelines for submitting issues, and guidelines for submitting PRs.  Perhaps even some general notes on what to expect with those items.  #425 magnifies the above problems, adding the question of what belongs in the core of Nightmare vs. what should be a plugin.  Thoughts?

---

Finally, thank you both for the commentary and criticism.  I think this discussion is an important one and needed to be had.
",rosshinkley,Mr0grog
491,2016-02-18 18:49:15,"Technical notes first, feelingsy stuff about how stuff gets done second:

> while running parallel operations on a single page should Just Work™, running parallel operations across multiple domains with a single Nightmare instance won't work.

Exactly! The issues at the end of #465 are all on the same page and should just work, but don’t. The major underlying issue is that communication between Nightmare’s process and the Electron process (and similarly between the Electron browser and renderer processes) doesn’t differentiate between which actual call to do  a given operation they are responding to. That’s not a problem until there are two simultaneous calls to do the same kind of operation (in #465, that was `evaluate`, but really it could be any operation). I’m actually going to go make an issue for that now (I think it’s separate from the actual thing #465 was trying to fix).

(Another note for better docs: it would be good to clarify that you need multiple nightmare instances to work on multiple pages at the same time.)

> Having Nightmare directly inherit from Promise opens a bit of a can of worms. (I touched on this briefly in #472.)

Yep! I think it would require a lot of discussion. There are multiple ways to skin that cat (and, as you say, reasons to not to skin it at all). I haven’t written an issue or PR yet because I haven’t taken the time to really think through and articulate it well.

---

Project process stuffs:

> 1. I apologize about the API change

Oh, you don't need to apologize for the change! It's a good change, too (in my opinion, at least).

> I should have mentioned something, but to be honest I'm not sure it broke anyone's code.

Given the way `then` previously worked (clearing the queue), that's probably true—you'd likely get more confusion than utility out of chaining off of `then`. But it is much easier to be confident in that assertion if you let people know about the change in advance and give them at least a few days for feedback. It may or may not break users' code, but it _is_ a breaking change and certainly has the potential to do so. As you said, “a lot of people depend on this library,” which I think only makes this sort of thing a bigger deal.

Maybe @rosshinkley put this better than me above:

> I had seen commentary for both ways and wanted clarification - and perhaps more importantly, justification - written down somewhere for posterity. I am certain it's going to come up in questions again and I wanted to have a reference to point at. (The poor, poor souls that get this PR as a reference in the future. Apologies to future readers everywhere.)

Again, I think the change itself is great! I hear and agree with your reasoning for it 100%. It's the _manner in which the change was made_ that I'm concerned about.

> there are some really big PRs that have been merged

Definitely! Being accepting and being _welcoming_ (maybe “inviting” or “supportive” would be a better terms for what I’m trying to get at here) are different things though. My point is that I think big and good contributions have been made in spite of an environment that might not be as supportive of them as it could be.

I do want to clarify, too, that I used the word “major” rather than “big” because I’m talking about changes that are highly impactful to how someone uses Nightmare. Mainly, that means things like breaking API changes and adding or removing new classes of behavior. Your change to `then` is a good example—it’s small in terms of lines of code, but potentially major in impact. #479 might be a good counter-example if it’s accepted. It’s big-ish in terms of lines of code (at least relative to most PRs here), but relatively isolated and not particularly impactful to how Nightmare works. Users won’t see it as anything but a slight improvement. (Note that that _doesn’t_ mean it won’t require careful review. It’s still a lot of code.)

> It does take time to go through some of the bigger ones

And it should! This stuff should be (and is, I think) reviewed with a careful eye. I am nothing but :thumbsup: :thumbsup: :thumbsup: on that font. I should say that my personal experience hasn’t been one where I think anything has taken too long. It’s only other issues and PRs that I see sitting for a while.

OSS projects are, by nature, done in most people’s off-hours, so taking a few days to reply doesn’t seem bad to me. Even if it takes longer than a few days to come up with substantive feedback, that’s fine. But in my experience, it _really helps_ people feel better about what’s going on if, after a few days, a maintainer at least says “hey, thanks for issue/PR/whatever; we’re super busy right now, but I should be able to take a closer look in a few days/a week/whenever.”

> The next two things on my TODO list…

Thanks for the info! But this is more-or-less exactly what I’m talking about. Now _I_ know what’s on the docket, but this info is still buried away at the bottom of a closed PR. Who is going to see that besides you, me, and @rosshinkley?

> the direction… has been ad hoc… with that in mind, I don't know that a more comprehensive project map is possible.

Ah, good to know! I haven’t been here long enough to get a sense for whether things are mostly just ad-hoc or whether there is a tacit roadmap that only exists in a few people’s heads. @rosshinkley makes some really good points here and I think I agree on what would really be helpful:
- Guidelines for requesting functionality
- Guidelines for submitting patches
- A commitment that project maintainers will also follow a public process (the same process as other contributors?) for making changes.
- Clear documentation about deprecation, and gotchas, etc.

I don’t think any of these things need to be exceedingly exact or heavy-duty; even a little guidance helps. For me, the biggest one by far is having project maintainers/committers following a public process for proposing/making changes, especially for changes that affect the API surface or intended usage.

> Finally, thank you both for the commentary and criticism. I think this discussion is an important one and needed to be had.

Glad to know I’m not just a crazy man off screaming in the corner! Thanks for your feedback, too, it was probably clearer and more concrete than mine :D
",Mr0grog,rosshinkley
491,2016-03-04 19:50:30,"@Mr0grog I didn't have a _great_ place to put this, but this seems the most logical.

I decided to pull together an external [examples project](https://github.com/rosshinkley/nightmare-examples) as to not pollute the Nightmare package with extraneous libraries.  That said it's (I hope) close to what we had originally discussed.  So far it has basic usage on `vo`, `co`, promises and semantic callbacks, as well as a couple of known problems.  I'll be adding more stuff to it as time permits, and would love to have your and possibly @matthewmueller's feedback, availability permitting.
",rosshinkley,matthewmueller
491,2016-03-04 19:50:30,"@Mr0grog I didn't have a _great_ place to put this, but this seems the most logical.

I decided to pull together an external [examples project](https://github.com/rosshinkley/nightmare-examples) as to not pollute the Nightmare package with extraneous libraries.  That said it's (I hope) close to what we had originally discussed.  So far it has basic usage on `vo`, `co`, promises and semantic callbacks, as well as a couple of known problems.  I'll be adding more stuff to it as time permits, and would love to have your and possibly @matthewmueller's feedback, availability permitting.
",rosshinkley,Mr0grog
491,2016-03-04 21:45:12,"@rosshinkley cool! I’ve been a little busy this week, but will definitely check it out.
",Mr0grog,rosshinkley
488,2016-02-16 20:45:07,"Oh! Thanks a lot @rosshinkley  :+1: 
",icaromh,rosshinkley
487,2016-02-18 03:15:25,"thanks @Mr0grog !
",matthewmueller,Mr0grog
484,2017-03-13 20:32:46,"@matthewmueller You wouldn't happen to have the benchmarking code would you? I did some basic benchmarking on a 2016 Macbook Pro between Nightmare (using Electron) and Capybara with PoltergeistJS (Ruby interface to PhantomJS), and Nightmare is usually around 1.5x - 2.5x slower for me",boxtown,matthewmueller
484,2017-03-17 17:09:36,"@boxtown weird maybe phantom has improved a lot since these were run. Don't have the old code on me, but you can probably just download nightmare 1.x and nightmare 2.x to run them side by side.

@abacaj if you can use a headless browser with a fake DOM implementation, then you should. Last I checked zombie was still using jsdom, you could improve that further with cheerio. Nightmare is built for sites that are javascript heavy and need to be able to run the client-side javascript code.",matthewmueller,abacaj
484,2017-03-17 17:09:36,"@boxtown weird maybe phantom has improved a lot since these were run. Don't have the old code on me, but you can probably just download nightmare 1.x and nightmare 2.x to run them side by side.

@abacaj if you can use a headless browser with a fake DOM implementation, then you should. Last I checked zombie was still using jsdom, you could improve that further with cheerio. Nightmare is built for sites that are javascript heavy and need to be able to run the client-side javascript code.",matthewmueller,boxtown
481,2017-01-16 10:07:56,"Just a quick fix for https://github.com/segmentio/nightmare/issues/481#issuecomment-184709699 on @sintanial code
`self.optionWaitTimeout` should be `self.options.waitTimeout`

See: https://github.com/segmentio/nightmare/pull/716/commits/384b752604ed1450a0bda996feba20566dad736f",navossoc,sintanial
481,2017-03-24 01:01:09,@sintanial  thanks for this code example.  Works fine. :D ,cicerohen,sintanial
479,2016-02-22 23:51:03,"@rosshinkley No reason not to bump the version as far as I'm aware. Figured I'd go for safety first, though, since I didn't know if there was any policy around Electron versions.
",Mr0grog,rosshinkley
479,2016-02-23 00:06:15,"@Mr0grog I can't find it with a cursory search, but I'm almost positive the version has been upped to accommodate changes like this before.  There are plenty of issues surrounding version changes where Electron changed some sort of internal convention (preference names like `web-preferences` to `webPreferences`, for example).  I think I'd still rather manage the version bump fallout over managing version compatibility, though.
",rosshinkley,Mr0grog
479,2016-02-23 05:00:37,"@rosshinkley Makes sense, thanks for the feedback. Bumped the version and eliminated all the `CAN_UNSUBSCRIBE` stuff in f4499d0ff5145a6082c7630dfba51c100a760d1f. :thumbsup:
",Mr0grog,rosshinkley
479,2016-12-11 12:28:21,"@Mr0grog I'm using the `FrameManager` code and from time to time I still experience problems with incomplete/blank captures.
Perhaps it has to do with the fact that we rely on the first `buffer` event, but I've noticed that sometimes I get 2 and more events (depends on the complexity of the item being rendered?)
I've noticed that adding `beginFrameSubscription(debounce(receiveFrame, frameDebounce)` produces more consistent results.",mikeys,Mr0grog
477,2016-02-15 07:57:13,"Hey @max-l, it looks like the problem you're having is actually a change in Vo, not Nightmare. In Vo version 2 (just released yesterday!), it says: ""In the first version return values were passed on to the next function by default. In this version the default uses fixed arguments you pass in when you call vo.""

So, you have to use the `pipeline()` method to get the v1 style behavior:



The docs on Nightmare probably aren't updated yet since the Vo release just happened.
",Mr0grog,max-l
477,2016-02-15 12:56:30,"@Mr0grog thanks for that quick response, it works ! 
",max-l,Mr0grog
472,2016-02-12 08:55:20,"@rosshinkley Oh, I get this https://github.com/segmentio/nightmare/blob/2.1.6/lib/nightmare.js#L309-L319

the Nightmare instance is implicitly using `then` to perform a fake Promise instance. so it can be yield to a flow control tool like co or vo. And this is weird & should be documented.
",magicdawn,rosshinkley
472,2016-02-29 17:13:01,"@kanethal Out of curiosity, what version of `co` are you using?
",rosshinkley,kanethal
472,2016-03-01 02:38:25,"@kanethal yeah, that's a full example, and will log the page title

![image](https://cloud.githubusercontent.com/assets/4067115/13415848/4297e634-df99-11e5-8588-546eb9bcf5a4.png)

maybe you are using an old verison of co(before v4.0 probably)~
",magicdawn,kanethal
472,2016-03-02 20:43:03,"I had grabbed a fresh version I thought... I'll double check when I get
home.
On Feb 29, 2016 7:38 PM, ""Tao"" notifications@github.com wrote:

> @kanethal https://github.com/kanethal yeah, that's a full example, and
> will log the page title
> 
> [image: image]
> https://cloud.githubusercontent.com/assets/4067115/13415848/4297e634-df99-11e5-8588-546eb9bcf5a4.png
> 
> maybe you are using an old verison of co(before v4.0 probably)~
> 
> —
> Reply to this email directly or view it on GitHub
> https://github.com/segmentio/nightmare/issues/472#issuecomment-190504589
> .
",kanethal,kanethal
469,2016-02-11 18:34:45,"@matthewmueller I wanted to speed it up. How much do you think we could increase the speed without compromising the ordering?
",jviotti,matthewmueller
468,2016-02-10 14:03:56,"@Mr0grog Glad to finally have an answer to that question, and good eye for finding that issue!  Especially good to know it's not a framebuffer-dependent issue.

I agree: anything to make the behavior deterministic.  I do have an edge-case question, though - in my read of the documentation, the `beginFrameSubscription` callback is called for any display event.  If the screenshot is taken well after the page is rendered, will the callback still be called?
",rosshinkley,Mr0grog
468,2016-02-10 17:18:52,"@matthewmueller Great, I'll try and put together a PR this week.

@rosshinkley That is a really good question! I will poke around and see what I can see. In the worst case, twiddling with something on the page, such as adding and removing an element, ought to work to trigger it.
",Mr0grog,matthewmueller
468,2016-02-10 17:18:52,"@matthewmueller Great, I'll try and put together a PR this week.

@rosshinkley That is a really good question! I will poke around and see what I can see. In the worst case, twiddling with something on the page, such as adding and removing an element, ought to work to trigger it.
",Mr0grog,rosshinkley
468,2016-02-11 01:52:06,"Spent a little time on this today and discovered:
1. If the page is all settled and idle, the callback won't be fired (as you surmised @rosshinkley), so we do have to do something to the page to trigger it. That something has to affect the render tree—adding comment nodes, empty text nodes, etc. won't do it. Happily, adding a transparent 1x1 div to the top left corner of the page (even if the top/left corner isn't in view!) works.
   
   (Also interesting: even though adding it to the top of the page when the top of the page isn't visible does work adding it where it never _could_ be drawn, e.g. `left: -10000px` does _not_ work. ¯_(ツ)_/¯ )
2. It's easy to crash electron while doing this (see https://github.com/atom/electron/issues/4441), so the whole technique may be a bit problematic in the end. If we stay subscribed to frames for the lifetime of the window, I think we could reliably avoid the crash, but I can imagine that easily getting resource intensive.
",Mr0grog,rosshinkley
468,2016-02-22 23:00:55,"@Mr0grog Would [window.requestAnimationFrame()](https://developer.mozilla.org/en-US/docs/Web/API/window/requestAnimationFrame) trigger the render tree?
",Zn4rK,Mr0grog
465,2016-02-12 04:31:35,"@Mr0grog, thanks for poking your head in here. I can see the use case for the point above but I'm kind of confused on the implementation. When I ran you're example I found tried swapping around the order of the waits and found the second always fired first, probably related to both occuring in the same event loop. In Australia we get a regionalized version of yahoo anyway, so the example might work better on your end.

The behaviour I expected from looking at your code/the source code was that the `.wait()`'s would be placed in a queue and executed in order. For example if we modified your example slightly to use chaining instead it reads as though it would do one before executing the other. I'm still kind of new to async chaining though so if I'm missing something obvious forgive me.



As a sidenote, when I was testing things I found that setting `var _timeoutMs = 1;` could cause strange results. Noteably both would fire in the beneath


",Crazometer,Mr0grog
463,2016-02-03 18:34:25,"Yep, that was it, thanks @rosshinkley. Next time I'll make sure to upgrade before reporting anything.
",raypatterson,rosshinkley
461,2016-02-22 06:33:38,"@yoshi95 I added `nightmare.webRequest.onBeforeRequest` in PR #495 
@matthewmueller In order to make plugin like this, I think some apis are needed which can access electron side api or event message receiver written in `runner.js` just like [this](https://github.com/segmentio/nightmare/pull/495/files#diff-b3b53682a18f203ac8d29b0e277cad26R353) which is the same as the way of cookie api.
",kyungw00k,matthewmueller
461,2016-02-22 06:33:38,"@yoshi95 I added `nightmare.webRequest.onBeforeRequest` in PR #495 
@matthewmueller In order to make plugin like this, I think some apis are needed which can access electron side api or event message receiver written in `runner.js` just like [this](https://github.com/segmentio/nightmare/pull/495/files#diff-b3b53682a18f203ac8d29b0e277cad26R353) which is the same as the way of cookie api.
",kyungw00k,yoshi95
461,2016-02-23 00:10:11,"@kyungw00k the API you're requesting is done.  For more information, read through #391 and #425.
",rosshinkley,kyungw00k
461,2016-02-23 01:45:13,"@rosshinkley the API will be available to use after #391 is completed, right?
",kyungw00k,rosshinkley
461,2016-02-23 01:48:57,"@kyungw00k Correct.
",rosshinkley,kyungw00k
461,2016-04-25 15:31:08,"@yoshi95 now, you can use `webRequest.onBeforeRequest` handler with [nightmare-webrequest-addon](https://github.com/kyungw00k/nightmare-webrequest-addon)
",kyungw00k,yoshi95
460,2016-03-11 08:11:47,"@paranoiq1 can you provide the updates to your above code that allowed you fix this please? I think I have a similar problem
",SantoshSrinivas79,paranoiq1
456,2016-01-27 15:08:24,"@rosshinkley Thank you very much!
",AveVlad,rosshinkley
455,2016-01-28 05:59:16,"thanks @the-t-in-rtf !
",matthewmueller,the-t-in-rtf
452,2016-01-28 16:24:49,"@matthewmueller it works! (I npm installed the current release, so I'm unsure if @emars fix was reflected in that.)

---

Aside:
While testing it I ran the Yahoo! example in the readme and it doesn't work anymore because the class for the submit button isn't present.



`getElementsByClassName` returns an empty list in this case.
",migueloller,matthewmueller
452,2016-01-28 16:24:49,"@matthewmueller it works! (I npm installed the current release, so I'm unsure if @emars fix was reflected in that.)

---

Aside:
While testing it I ran the Yahoo! example in the readme and it doesn't work anymore because the class for the submit button isn't present.



`getElementsByClassName` returns an empty list in this case.
",migueloller,emars
451,2016-01-25 12:24:35,"@chocolait Out of curiosity, what version of node are you using?
",rosshinkley,chocolait
450,2016-07-10 07:34:35,"Hi, @rosshinkley , measuring page load time is the case i can think of currently which matters most for the accuracy to the test numbers.
",joychester,rosshinkley
448,2016-01-21 21:53:14,"@shri3k I have `""nightmare"": ""^2.0.7""` in my package.json file.

@rosshinkley When I run it I never get a response back and the PNG screenshot doesn't get created. 
Do you mean run it like ...
`$ DEBUG=app bin/www`

I want it to run headlessly. I have changed it to `new Nightmare({ show: false })` but it hasn't made any difference.

I know the route is matched and running ok, as I have put `console.log`'s in there and I can see them in Terminal.

I'm just about to go on holiday for a week. So I won't be able to reply to this thread. But when I get back I'll put together a simple(r) demo that I can share with you.

Thanks in advance.
",adrianparr,rosshinkley
448,2016-01-21 21:53:14,"@shri3k I have `""nightmare"": ""^2.0.7""` in my package.json file.

@rosshinkley When I run it I never get a response back and the PNG screenshot doesn't get created. 
Do you mean run it like ...
`$ DEBUG=app bin/www`

I want it to run headlessly. I have changed it to `new Nightmare({ show: false })` but it hasn't made any difference.

I know the route is matched and running ok, as I have put `console.log`'s in there and I can see them in Terminal.

I'm just about to go on holiday for a week. So I won't be able to reply to this thread. But when I get back I'll put together a simple(r) demo that I can share with you.

Thanks in advance.
",adrianparr,shri3k
448,2016-04-03 03:42:36,"@adrianparr Are you still having this issue?
",rosshinkley,adrianparr
448,2016-04-03 06:27:44,"@rosshinkley I think you were right. I am having the same issue as #224. I managed to get it working locally, but I need it to run on Digital Ocean (headlessly. It appears I'm not the only one having problems with this, judging by the thread on #224.
",adrianparr,rosshinkley
448,2016-04-11 13:13:38,"@adrianparr Ah, okay.  Closing and merging with #224.
",rosshinkley,adrianparr
447,2016-04-14 03:57:41,"@inversion I'm definitely in favor of the change, but it needs to be updated to be current.  Would you mind updating this?
",rosshinkley,inversion
447,2016-05-15 09:40:10,"@rosshinkley now updated
",inversion,rosshinkley
447,2016-05-18 17:21:56,"Thanks, @inversion!
",rosshinkley,inversion
445,2016-04-06 07:31:48,"@inversion I think the issue you were trying to solve here was fixed when @matthewmueller changed `.then()` to return a promise: https://github.com/segmentio/nightmare/commit/54f81d3dd9e6e4dad861f749a4a3064e2ce98dd0

If so, it would probably help to close this PR.
",Mr0grog,matthewmueller
445,2016-04-06 07:31:48,"@inversion I think the issue you were trying to solve here was fixed when @matthewmueller changed `.then()` to return a promise: https://github.com/segmentio/nightmare/commit/54f81d3dd9e6e4dad861f749a4a3064e2ce98dd0

If so, it would probably help to close this PR.
",Mr0grog,inversion
441,2016-01-19 12:25:39,"@matthewmueller Renamed `showDock` to `dock`!
",jviotti,matthewmueller
438,2016-01-18 21:50:23,"looks great. thanks @emars !
",matthewmueller,emars
438,2016-01-19 10:57:38,"@squirmy , yep it is kind a negative case to have timeout wait value >= the option WaitTimeout i tested :)
currently it has an issue without setting it as you mentioned(hanging from my side with 2.1.3 release). 
I would suggest that we can have a default value of option WaitTimeout(30000ms for example), or user can overwrite it in options explicitly.
",joychester,squirmy
438,2016-01-20 02:58:50,"@emars Thank you for fixing this! :+1: 
",joychester,emars
435,2016-01-14 17:13:49,"awesome, thanks @emars !
",matthewmueller,emars
432,2016-07-08 17:14:22,"@rehael I'd be curious if NTLM causes the [`login` event](https://github.com/electron/electron/blob/master/docs/api/web-contents.md#event-login) to be fired.  I suspect the answer is no - which would explain why `.authenticate()` doesn't work - but I'd appreciate it if you (or someone else) would double-check.
",rosshinkley,rehael
432,2016-07-08 17:58:59,"@rosshinkley I'm fairly sure I've tried `.on('login', …)` but let's wait until Monday when I check this at work. Nb. I've had exactly the same problem with Casper/Phantom.
",rehael,rosshinkley
426,2016-01-07 12:20:21,"@matthewmueller I'm shipping an electron app which uses Nightmare under the hood, and thus a new electron icon is shown in the dock for a while, which looks very awkward.

> i'm just a little apprehensive with hiding it right now just because it's nice to know if you accidentally opened up a ton of processes.

I see, this issue hit me a few times already. What about allowing a custom opt-in option to hide it from the dock (`hideDock`?) on the `Nightmare` constructor, that way users can enable it on demand, knowing the possible implications.
",jviotti,matthewmueller
425,2016-01-06 19:29:47,"@rosshinkley thanks for putting this together! I really have to think about this one a bit. After I get back from holiday vacation, I will take a closer look. My initial thoughts: 

> This amends the instance, not the prototype. I did this largely because Nightmare does not share Electron instances between Nightmare instances. It didn't seem sensible to force the prototype to have Nightmare actions for which there were no Electron actions. This also allows separate instances of Nightmare to use different plugins.

This could be confusing with how `.action` works, but is sort of inline with `.use`. I'm not crazy about having all these sorta different, but obscure ways to extend nightmare. I think it was discussed a bit in https://github.com/segmentio/nightmare/issues/379. 

I'm not sure the best way to fix this atm but I think where we're headed is going to lead to more confusion. It could just be a documentation thing though.

> Adding Nightmare and Electron actions together makes more sense to me than adding Electron actions alone. Thoughts?

Yah, I think you're right, but maybe actions/use could be nightmare-side only and there's an optional electron side.

> I readily acknowledge this sort-of-kind-of steps on .action() (and to a lesser extent, .use()). I considered updating .use() for plugins, but decided not to introduce breaking changes for this proposal. Suggestions for naming conventions or restructuring welcome.

Need to think on this more. But in general, I agree. It needs to be consolidated a bit more.

> Constructed function scoping works a little differently. This is why the constructed function binds to an object that passes in require (it's slightly cleaner than using eval). This allows require calls to be made in the Electron action. I considered stuffing that object with parent, win, etc - this would make the Electron actions look closer to what is in runner.js, but decided to leave them as explicit parameters for the time being. Thoughts?

Explicit params is probably fine if there's not going to need to be any additional params (or different ordering). If not, we should probably just pass a params object in.
",matthewmueller,rosshinkley
425,2016-01-07 17:18:16,"@matthewmueller no problem, happy (at least to try) to help.

> This could be confusing with how .action works, but is sort of inline with .use. I'm not crazy about having all these sorta different, but obscure ways to extend nightmare. I think it was discussed a bit in #379.

I thought something eerily similar, and I actually had a point about that originally that got edited out as I couldn't make it constructive enough.  I opted to go the way I did just to get the gist of the idea on virtual paper and not stomp on stuff that already existed.  I agree that, as it stands, this will be _very_ confusing, even with more/better documentation.

> Need to think on this more. But in general, I agree. It needs to be consolidated a bit more.

I think I'm going to go ahead and update this to put all of this into `action` - that seems to be a logical consolidation step.  I also think it'll help to have a rough cut of what that would look like.  More on that when I finish.

> Explicit params is probably fine if there's not going to need to be any additional params (or different ordering). If not, we should probably just pass a params object in.

I don't _think_ there will be additional parameters, but the required signature is a bit verbose.  I'm also not crazy about wrapping the function in a context - it makes the parameters feel a bit ""magic"", but I thought I'd put it on the table as an option.  

> Some general aestetic thoughts: I'm not crazy about passing an object in with nightmareAction, electronAction.

A parameters hash is a bit... icky?  I'm not enthusiastic about it either.  As an aside, the reason I did it that way with `plugin` was a personal preference: I'll use a hash when I don't know what the final signature will be.  It's a vestige of experimentation. :)
",rosshinkley,matthewmueller
425,2016-01-08 04:48:10,"@matthewmueller This update keeps the additions of the extensions together, as well as consolidates `.action()` and `.plugin()` into a single `.action()` function.  I've also kept the order of parameters similar to `.evaluate()` where the (optional) client method comes before the Nightmare action.

There are a couple of differences (and possible pitfalls?) in this update.  For starters, to keep the current behavior of `.action()` consistent, I decided it made the most sense to have the Electron plugin(s) be added for all instances.  The child actions are cached on the nightmare constructor, similar to how namespacing for `.action()` works.  Consequently, the addition of those child actions are added to the queue in the constructor such that all child action additions are executed prior to the first user-specified action.  (And they're silent, something I've got mixed feelings about.)

Thoughts?
",rosshinkley,matthewmueller
425,2016-01-13 02:40:22,"@matthewmueller When I wrote that sentence about possible pitfalls, I had two things in mind:
1. I was changing how `.plugin()` behaved considerably - originally, you could add Electron functionality piecemeal.  This meant the execution time/complexity to add Electron extensions was only as big as the instance required, whereas now, actions for _every_ plugin are queued for every instance before execution can even start.  On reflection, since the plugin action is uniform (except in what's actually transferred), I'd bet the performance impact is (almost) negligible.  At any rate, it's not anywhere near dealbreaking, only the fringiest (is that a word?) of fringe cases would be using multiple Nightmare instances with different bolt-ons.  TLDR: adding plugins to every instance isn't going to be a problem. :)
2.  I know I mentioned this already: queued plugin actions execute silently before the first user call.  Should they at least make a `debug` call or something?

Finally: anything else I can do to help this PR along?
",rosshinkley,matthewmueller
425,2016-01-18 22:57:23,"@matthewmueller I went ahead and added the debug, and also went ahead and merged in the recent changes.  Special thanks to @emars for fixing the build, something I just hadn't had time to do. :)
",rosshinkley,matthewmueller
425,2016-01-21 21:16:00,"@matthewmueller I've gone ahead and thrown together a couple of proposed plugins: [additional events](https://github.com/rosshinkley/nightmare-custom-event) (from #376) and [download management](https://github.com/rosshinkley/nightmare-download-manager) (from #382).  From that, I got to use this PR for ""real"" applications, and as such, made a couple of touchups to include options in the Electron method, as well as attaching the options hash to the instance.  This allows for making/expecting options in the Nightmare options for plugin use.
",rosshinkley,matthewmueller
424,2016-01-05 19:29:27,"@rosshinkley ,  Yes.. that is very helpful. thank you for pointing it out. It appears multiple instances of Nightmare are fired up, I'm not sure I understand how Nightmare retains it's page scope yet fire up multiple instances. Oddly it is currently returning results of only 12 of the 14 result pages for me at this point.   I attempted searching a different term with greater than 100 page results and was presented with only 33 links, I haven't identified the problem yet. To resolve the EventEmitter errors I used the fix mentioned here: EventEmitter memory leak (https://github.com/segmentio/nightmare/issues/350).  


",designerx2,rosshinkley
424,2016-01-05 20:45:38,"@designerx2 I think there are two problems here.  The first is one I should have thought of and missed in my haste.  The example in #402 - and the one you're showing here - is naive and will miss the last page (if there is a ""last"" page) as the `#pnnext` button won't exist.  The second has to do with how Google shows pages.  I added a `scrollTo` to look at the pages before clicking `#pnnext`, and at page 13, the results fall below the omission threshold.  A picture might be helpful:

![test](https://cloud.githubusercontent.com/assets/1823131/12127088/36b0d5e4-b3c3-11e5-9961-74172bf6b8e6.png)

In short: there are only 13 result pages and the last one is being omitted.
",rosshinkley,designerx2
422,2016-04-03 19:01:05,"Thanks a lot, @rosshinkley, what a great bunch of plugins, that's awesome!
",borisschapira,rosshinkley
421,2016-04-18 19:43:26,"> sending Electron’s stdout/stderr to debug channels like electron:log/election:error

Yep.  I'd agree. :)  Frankly, for now, I think we _should_ keep it simple, routing electron's stdout/stderr through DEBUG.

> I’m somewhat skeptical that a new, heavier logging tool needs to come along for the ride, but can definitely see ways that doing so might be helpful.

I am too, and I apologize if I didn't make that clear.  I wanted to float the idea to see what everyone thought.  I was tinkering with the idea more seriously after you (@Mr0grog) submitted #579: With the progress events, it might be helpful to add logging there, but would make running Nightmare with DEBUG _wildly_ verbose.  There are probably other events - like any of the events that are simply forwarded - that could be dropped to a lower log level.  My main goal was to help manage verbosity, but that may very well be a misguided early optimization.

winston was at the tip of my brain, and I had to go look up loglevel from a previous project to remember that.  I was throwing out possibilities, they certainly aren't the only two solutions out there.  I'm willing to entertain alternatives.
",rosshinkley,Mr0grog
421,2016-04-18 20:18:52,"@Mr0grog Yeah, it's getting a _bit_ into the weeds. :)

> One simpler thing to do might be just having more granular logging channels, e.g. browser events, script execution, runner actions, queueing, process management, etc. One could potentially manage just as well by message type as by severity.

For sure.  It's a little bit more of a hassle to set up DEBUG rules to get exactly what you want, but I'm on board.

To that end... with an eventual PR, would it be helpful to include common(ish) DEBUG setups over at nightmare-examples, especially as the more complicated parts start coming in?
",rosshinkley,Mr0grog
420,2016-01-05 17:37:24,"@antpaw Ah, I see.  I must have misread the original diff.  It looked like in passing it was adding the `page-*` events back.  At any rate, I think you are correct. The parent process should listen to `page`.  +1. :)

One nit: I think the page handler should handle variable arguments.  Something like:



... or if the `page-*` convention should be kept for `debug`, something like:



Re testing, the tests for ensuring `page` is handled are already there ([alert](https://github.com/segmentio/nightmare/blob/master/test/index.js#L688-L694), [prompt](https://github.com/segmentio/nightmare/blob/master/test/index.js#L704-L721), and [confirm](https://github.com/segmentio/nightmare/blob/master/test/index.js#L704-L721) are good examples), but simply test that the events are emitted from the child and not submitted to debug.  Testing debug output would probably require using a mock (like mockery).
",rosshinkley,antpaw
419,2016-04-11 13:12:46,"@kanethal Do you have `ELECTRON_ENABLE_LOGGING` set?  It might be worth to check your environment variables against [the Electron environment variable flags](https://github.com/electron/electron/blob/master/docs/api/environment-variables.md).
",rosshinkley,kanethal
419,2016-04-11 13:19:28,"I hadn't explicitly set any conditions like this. It's possible they are
enabled in the nightmare package? I'm using v2.0.2. Thank you so much for
the link, I had been trying to find these flags.
On Apr 11, 2016 6:12 AM, ""Ross Hinkley"" notifications@github.com wrote:

> @kanethal https://github.com/kanethal Do you have
> ELECTRON_ENABLE_LOGGING set? It might be worth to check your environment
> variables against the Electron environment variable flags
> https://github.com/electron/electron/blob/master/docs/api/environment-variables.md
> .
> 
> —
> You are receiving this because you were mentioned.
> Reply to this email directly or view it on GitHub
> https://github.com/segmentio/nightmare/issues/419#issuecomment-208333064
",kanethal,kanethal
419,2016-04-11 13:29:48,"@kanethal No problem!

As for them being enabled for 2.0.2, I don't think so.  I don't see the same behavior.  I'd be curious if you'd get the same behavior with a different version.  Could you upgrade to 2.3.0 and run it again?
",rosshinkley,kanethal
419,2016-04-11 13:34:33,"I'd be happy to try!
On Apr 11, 2016 6:29 AM, ""Ross Hinkley"" notifications@github.com wrote:

> @kanethal https://github.com/kanethal No problem!
> 
> As for them being enabled for 2.0.2, I don't think so. I don't see the
> same behavior. I'd be curious if you'd get the same behavior with a
> different version. Could you upgrade to 2.3.0 and run it again?
> 
> —
> You are receiving this because you were mentioned.
> Reply to this email directly or view it on GitHub
> https://github.com/segmentio/nightmare/issues/419#issuecomment-208342334
",kanethal,kanethal
419,2016-04-23 22:33:46,"@kanethal Did you have any luck with an upgrade?
",rosshinkley,kanethal
419,2016-04-23 23:34:01,"Hi Ross, I believe there had been some semantic changes between the two
versions, and was going to have to reconfigure the scraping script and
haven't had time to focus on that. I'm sorry, I wish I had time to play
with it some more!
On Apr 23, 2016 5:33 PM, ""Ross Hinkley"" notifications@github.com wrote:

> @kanethal https://github.com/kanethal Did you have any luck with an
> upgrade?
> 
> —
> You are receiving this because you were mentioned.
> Reply to this email directly or view it on GitHub
> https://github.com/segmentio/nightmare/issues/419#issuecomment-213848706
",kanethal,kanethal
417,2016-01-14 22:03:54,"@matthewmueller is there any timeframe on when this fix will be released? I noticed it's not included in the latest NPM release.
",joshgummersall,matthewmueller
416,2016-03-30 03:15:51,"@erch Are you still experiencing this problem?
",rosshinkley,erch
416,2016-03-31 07:21:55,"@rosshinkley : thanks for the inquiry , I switched the project to my linux box and it works on it. I suppose that there was a issue with my windows node js installation.

Eric
",erch,rosshinkley
416,2016-04-03 03:39:45,"@erch Thanks for the response, sounds like it's resolved.  If this crops up again, feel free to reopen/open a new issue.
",rosshinkley,erch
410,2016-11-27 10:55:25,@catblade have you found how to change proxies on the fly? I'm going to open a issue for  that.,wiliame,catblade
410,2016-11-28 17:13:23,@wiliame There is a way.  I'll get you a code snippet this evening.  ,catblade,wiliame
410,2016-11-28 17:31:07," @catblade thanks, I figured it out.

https://github.com/segmentio/nightmare/issues/908

I'm now trying to figure this other one:

https://github.com/electron/electron/issues/8089",wiliame,catblade
409,2016-03-30 03:14:01,"I believe this was fixed in #487.  @contra can you verify?
",rosshinkley,contra
405,2015-12-23 19:42:30,"@contra can you try again, this time with `DEBUG=nightmare*`? That may help with debugging this issue. May also be a memory leak.
",matthewmueller,contra
405,2016-04-13 18:36:14,"@contra Are you still experiencing this problem?
",rosshinkley,contra
405,2016-04-13 18:36:57,"@rosshinkley I don't think it was ever fixed, I'm not using this for anything right now though.
",contra,rosshinkley
405,2016-07-10 04:09:40,"@rosshinkley Did you push a fix for the problem? I don't think it disappeared on its own. You said earlier you were able to reproduce it, is it still happening for you?
",contra,rosshinkley
405,2016-07-22 21:23:17,"@contra I haven't been able to reliably reproduce without a networking issue.  I'll see if I can dig out the test script and try it again against the current version.
",rosshinkley,contra
405,2016-08-08 16:41:02,"@contra To cut out networking issues, I propped up a server locally to issue requests to (responding with plaintext), then issued 100k sequential requests to that service with a single Nightmare instance.  Nightmare did not hang.  I'm thinking about propping up a minimal HTML payload, then adding javascript and/or HTML and running requests against that to see if it's a caching issue or a memory issue or... something.  If you've got ideas, I'd love to hear them.

@LikeJasper I don't think I've ever seen `debug` behave like that... I wonder if it's interpreting a backspace or non-character escape?  If you could put together a minimum case that reproduces that behavior, I'd love to see that too.
",rosshinkley,contra
405,2016-08-08 17:06:18,"@rosshinkley Well, it's probably more than 100k requests total from the instance itself. I opened 10k requests, and each page probably had ~100 resources on it (CSS, JS, Images, etc.). You should try sending 100k requests to a more suitable test that doesn't load instantly to rule out race conditions (https://mail.google.com/ ?)
",contra,rosshinkley
405,2016-08-08 17:14:34,"@contra I'm trying to keep the tests local because I _have_ gotten some aberrant behavior with flaky networks.  (The kind of stuff that is bordering on impossible to reproduce without infrastructure that I just haven't had time to play with yet.)  That's why I was tinkering with the idea of making generated payloads that would simulate multiple assets of varying sizes.  I'd also prefer to keep whatever I'm testing against local as then I'm guaranteed to know what assets are being loaded.  Being able to make assertions about what is being loaded will help narrow what's actually wrong.

It may also be worth introducing an artificial networking bottleneck to simulate poor bandwidth.

At any rate, the biggest problem with these sorts of tests is time: it's going to take some tinkering to figure out a semi-reliable crash condition (if there is one).
",rosshinkley,contra
405,2016-08-08 17:31:56,"@rosshinkley Understandable, try delaying the response from your server by a couple of seconds: `setTimeout(() => res.status(200).end(), 5000)`

I was 99% sure it had something to do with a race condition while waiting for requests to finish.

If you have a repo w/ your test case I can try to modify it to reproduce.
",contra,rosshinkley
405,2016-08-29 14:51:48,"@contra I haven't had time to address this as yet, but I'll post here when I build a working test case. :)
",rosshinkley,contra
405,2016-08-29 15:09:58,"@rosshinkley Don't think I've introduced any backspaces or non-character escapes myself, but I'll see if I can put together a minimal case to reproduce the weird logging.
",willclarktech,rosshinkley
403,2015-12-22 21:43:55,"@sriducati you do realize how OSS works, right? People are donating thousands of their hours to provide a solution to something that they think someone might find useful and instead of you putting the same effort like others to fix an issue are instead completely demeaning the project? I get utterly disgusted when I see these reactions. 
",shri3k,sriducati
402,2015-12-23 17:34:57,"Thank you @rosshinkley 
",SantoshSrinivas79,rosshinkley
401,2015-12-22 18:24:59,"thanks @naturalethic !
",matthewmueller,naturalethic
399,2015-12-21 18:56:17,"awesome, thanks @rosshinkley!
",matthewmueller,rosshinkley
398,2015-12-25 03:04:19,"@rosshinkley Could the second method used to share session between different machines?
",dingziran,rosshinkley
398,2016-01-04 23:00:21,"@dingziran _Great_ question.  I'd suspect the answer to that is not a clear ""yes"" or ""no"" - it'd probably depend on how strict the site-in-question's security policy is and if it does any sort of request origin validation.

I'll put this one on the list, though.  It's probably worth a peek. :)
",rosshinkley,dingziran
398,2016-03-04 06:09:07,"@rosshinkley I am new to nightmare, could you please explain how to use partition to share session between multiple instance of nightmare?
",Velissel,rosshinkley
398,2016-03-04 13:50:28,"@Velissel I took a minute to take another look at this.  Provided your instances share partition information, session information is shared across instances.

However, if you open an instance, log in, and open a second instance with the same persistence data before closing the first, the session information doesn't appear to be shared (or the data from the first session isn't persisted or shareable yet).  I'm still digging into that.
",rosshinkley,Velissel
398,2016-03-27 03:17:28,"@rosshinkley, In my case, persist does not keep session no matter if I start second instance after or before close of first one
",Velissel,rosshinkley
397,2015-12-21 12:13:54,"@yoz The results are the same, a yield is only needed when you want to return the result. You could run the script in this incarnation as well and it will yield the same result:



Output:



Now, when you remove the ending `wait(100)`, it does throw the exception but the process hangs without exiting:


",chrisgeo,yoz
395,2015-12-19 05:21:45,"@matthewmueller 
maybe it is not caused by inject
The below code will stop during the second yield. 
Ans also ""Uncaught ReferenceError: __nightmare is not defined""


",dingziran,matthewmueller
395,2015-12-21 08:13:24,"@dingziran Oh, I think it might be electron renaming it's options, try `webPreferences`.
",matthewmueller,dingziran
395,2015-12-21 17:07:34,"@dingziran @matthewmueller Matt you are right, it wasn't working for me and I renamed the web preferences and it did work. Thanks.
",felixcrive,matthewmueller
395,2015-12-21 17:07:34,"@dingziran @matthewmueller Matt you are right, it wasn't working for me and I renamed the web preferences and it did work. Thanks.
",felixcrive,dingziran
393,2017-01-22 05:18:53,"@bjrmatos hi there!
I just ran across a situation where I am required to have nightmare run inside an already executing electron application, and I noticed you said you might have experimented with this.

I was wondering if you had anything working/WIP that I could use as a base -- otherwise I am going to implement this shortly! Thanks!",Timer,bjrmatos
393,2017-01-22 07:29:59,Nevermind! I managed to get nightmare to use the already running electron instance. Sorry for bugging you @bjrmatos.,Timer,bjrmatos
393,2017-01-22 12:48:05,@Timer Could you share a link to how you managed to do that? I have an idea for a project that will need to do just that. (nightmare using electron instance),yourfavorite,Timer
393,2017-01-22 16:10:43,@yourfavorite I need to do some tweaking and I'll push it to my fork of nightmare. I broke the existing functionality of running within node and always assumed to not launch electron. Once I have the changes working for both use cases I'll drop a line on this thread. :),Timer,yourfavorite
393,2017-01-22 17:24:20,@yourfavorite see https://github.com/segmentio/nightmare/pull/967 👍 ,Timer,yourfavorite
391,2015-12-22 04:55:51,"@rosshinkley i don't see a way you'd be able to pass `parent`, it's transferring over IPC and parent isn't serializable. 

The reason for doing the require is that we could basically tell the electron process to require a file on it's own. I don't like the solution all that much, but I haven't come up with a better one.
",matthewmueller,rosshinkley
391,2015-12-22 05:30:52,"@matthewmueller did I misunderstand?  I thought the intent was passing paths to require over IPC (or possibly, as command-line arguments akin to `paths`) and requiring them in the electron process, not vice-versa.  No IPC serialization required.  Parent should then be passable.

I'll need to take another pass at this when I'm fresh and have coffee.  I'll try to carve out some time.
",rosshinkley,matthewmueller
391,2015-12-23 15:41:55,"@matthewmueller I should have been more specific, and the naming conventions are also probably not helping: in `runner`, `parent` is defined as the IPC process.

Re ideas for implementation (I still need to carve out time to experiment): how do you want them?  Should I make a branch on my fork and link to it, set up a PR with ""proposal"" in the header, or something else?  What would you prefer?

---

@bjrmatos I'm on board for having Nightmare be supported inside of Electron (#393), but I don't think you'd want to discard Nightmare as a node module.  (I would argue it's one of the bigger problems with using Phantom/Casper et al.  Usage from node is certainly possible, but a bigger pain.)  I agree that extensibility is currently an issue, but not an insurmountable one.
",rosshinkley,matthewmueller
391,2015-12-23 15:41:55,"@matthewmueller I should have been more specific, and the naming conventions are also probably not helping: in `runner`, `parent` is defined as the IPC process.

Re ideas for implementation (I still need to carve out time to experiment): how do you want them?  Should I make a branch on my fork and link to it, set up a PR with ""proposal"" in the header, or something else?  What would you prefer?

---

@bjrmatos I'm on board for having Nightmare be supported inside of Electron (#393), but I don't think you'd want to discard Nightmare as a node module.  (I would argue it's one of the bigger problems with using Phantom/Casper et al.  Usage from node is certainly possible, but a bigger pain.)  I agree that extensibility is currently an issue, but not an insurmountable one.
",rosshinkley,bjrmatos
391,2015-12-23 19:31:59,"@rosshinkley yah, terrible names haha, should probably change them to `node_process`, `electron_process`, and ... `render_process` (?). yah, I'd like to see what you have in mind. PR or commenting in this issue seem reasonable. Would be nice to see some example code, like how a dev would extend it.
",matthewmueller,rosshinkley
391,2015-12-23 23:40:35,"@rosshinkley my intention never was to discard using `nigthmare` as a node module :smile: however for tasks in scale the current state of `nigthmare` is not very efficient, i'm just trying to support a way to run `nigthmare` that let me scale in other ways
",bjrmatos,rosshinkley
385,2015-12-18 02:01:32,"@matthewmueller Thanks!
",rhysd,matthewmueller
382,2015-12-18 17:59:05,"@subcontact hmmm.. that's a tough one, have you tried getting it to work with the current PR?
",matthewmueller,subcontact
382,2015-12-21 15:41:45,"@matthewmueller Thank you for your reply, and I'm sorry I couldn't get back to this sooner.  Also, apologies in advance for the missive.  Responding to your feedback:

> By default ignore all downloads

Seems reasonable to me.  I can do that as time permits.

> If someone wants to download something, provide nightmare.download(selector|url) which returns a buffer. if a buffer is not possible, support path in the signature to write to a file.

I don't understand what you're asking, what should the selector provided do?  Click?  As for providing a URL, would that be a simple get?  And with the buffer, no, I don't think that is possible.  Electron supplies the filepath and a method to override the filepath.

> When we are downloading something, wait until that download is complete in order to resume.

Blocking on each download isn't how browsers work.  From a test automation standpoint, I can certainly understand the need, but from a purely automation standpoint, I'm not sure I agree.

> Potentially support progress events via nightmare.on('progress', fn) if that's supported

Yes, that's supported (and can be supported with the reduced API).

Re: getting away with a simple request: no, I don't think you want to do that.  If you're making an authenticated request for a resource (thinking of something like a request to a private link in say, Dropbox), you want to do that from within the context of Electron.  Copying the resource URI and issuing a plain GET will almost certainly result in failure.  This (I think, and I'm sorry if I'm misreading here) gets to what @subcontact's problem - authenticated downloads won't work with simple requests.

Re: keeping at least some form of downloads in core, that's a _great_ question.  My answer to that would be a qualified no.  How downloads are handled is probably going to be dependent on use case.  To that end, I think the blocking `.download()` and the non-blocking methods in this PR should be broken out into at least one (probably two?) plugins.  

The problem with that is binding to `will-download`.  A new method to hook into `will-download` with a custom handler could be exposed, or (with modification to pass a child handler) the custom event bindings in #367 could be used.  Thoughts?

I'm willing to reduce the API as requested, and if you think it's a good idea, I will close this PR and open a fresh one with those changes.
",rosshinkley,matthewmueller
382,2015-12-21 15:41:45,"@matthewmueller Thank you for your reply, and I'm sorry I couldn't get back to this sooner.  Also, apologies in advance for the missive.  Responding to your feedback:

> By default ignore all downloads

Seems reasonable to me.  I can do that as time permits.

> If someone wants to download something, provide nightmare.download(selector|url) which returns a buffer. if a buffer is not possible, support path in the signature to write to a file.

I don't understand what you're asking, what should the selector provided do?  Click?  As for providing a URL, would that be a simple get?  And with the buffer, no, I don't think that is possible.  Electron supplies the filepath and a method to override the filepath.

> When we are downloading something, wait until that download is complete in order to resume.

Blocking on each download isn't how browsers work.  From a test automation standpoint, I can certainly understand the need, but from a purely automation standpoint, I'm not sure I agree.

> Potentially support progress events via nightmare.on('progress', fn) if that's supported

Yes, that's supported (and can be supported with the reduced API).

Re: getting away with a simple request: no, I don't think you want to do that.  If you're making an authenticated request for a resource (thinking of something like a request to a private link in say, Dropbox), you want to do that from within the context of Electron.  Copying the resource URI and issuing a plain GET will almost certainly result in failure.  This (I think, and I'm sorry if I'm misreading here) gets to what @subcontact's problem - authenticated downloads won't work with simple requests.

Re: keeping at least some form of downloads in core, that's a _great_ question.  My answer to that would be a qualified no.  How downloads are handled is probably going to be dependent on use case.  To that end, I think the blocking `.download()` and the non-blocking methods in this PR should be broken out into at least one (probably two?) plugins.  

The problem with that is binding to `will-download`.  A new method to hook into `will-download` with a custom handler could be exposed, or (with modification to pass a child handler) the custom event bindings in #367 could be used.  Thoughts?

I'm willing to reduce the API as requested, and if you think it's a good idea, I will close this PR and open a fresh one with those changes.
",rosshinkley,subcontact
382,2015-12-21 18:55:34,"@rosshinkley thanks for the detailed response!

> I don't understand what you're asking, what should the selector provided do? Click? As for providing a URL, would that be a simple get? And with the buffer, no, I don't think that is possible. Electron supplies the filepath and a method to override the filepath.

Yah, you're right, when I proposed that I was thinking about it in terms of what the click/mouseover/etc methods do, but that's not the same as download. 

> Blocking on each download isn't how browsers work. From a test automation standpoint, I can certainly understand the need, but from a purely automation standpoint, I'm not sure I agree.

I was proposing this to handle `wait('downloads-complete')` piece that you added in this PR. Haven't investigated how that would work internally though.

> Re: getting away with a simple request: no, I don't think you want to do that. If you're making an authenticated request for a resource (thinking of something like a request to a private link in say, Dropbox), you want to do that from within the context of Electron. Copying the resource URI and issuing a plain GET will almost certainly result in failure. This (I think, and I'm sorry if I'm misreading here) gets to what @subcontact's problem - authenticated downloads won't work with simple requests.

From my understanding, a POST request triggers the download, so whether this is a plugin or not, we'd need to at least know how to do that with core.

> Re: keeping at least some form of downloads in core, that's a great question. My answer to that would be a qualified no. How downloads are handled is probably going to be dependent on use case. To that end, I think the blocking .download() and the non-blocking methods in this PR should be broken out into at least one (probably two?) plugins.

Yah, I agree.

> The problem with that is binding to will-download. A new method to hook into will-download with a custom handler could be exposed, or (with modification to pass a child handler) the custom event bindings in #367 could be used. Thoughts?

Yah, I think we should add this regardless, we're already hooking into the other events. Seems like it would be as simple as:

`win.webContents.session.on('will-download', forward('will-download'))`

Then you can hook into it with an action:



Haven't thought through exactly how this would work, but that would be the approach I would investigate.
",matthewmueller,subcontact
382,2015-12-21 18:55:34,"@rosshinkley thanks for the detailed response!

> I don't understand what you're asking, what should the selector provided do? Click? As for providing a URL, would that be a simple get? And with the buffer, no, I don't think that is possible. Electron supplies the filepath and a method to override the filepath.

Yah, you're right, when I proposed that I was thinking about it in terms of what the click/mouseover/etc methods do, but that's not the same as download. 

> Blocking on each download isn't how browsers work. From a test automation standpoint, I can certainly understand the need, but from a purely automation standpoint, I'm not sure I agree.

I was proposing this to handle `wait('downloads-complete')` piece that you added in this PR. Haven't investigated how that would work internally though.

> Re: getting away with a simple request: no, I don't think you want to do that. If you're making an authenticated request for a resource (thinking of something like a request to a private link in say, Dropbox), you want to do that from within the context of Electron. Copying the resource URI and issuing a plain GET will almost certainly result in failure. This (I think, and I'm sorry if I'm misreading here) gets to what @subcontact's problem - authenticated downloads won't work with simple requests.

From my understanding, a POST request triggers the download, so whether this is a plugin or not, we'd need to at least know how to do that with core.

> Re: keeping at least some form of downloads in core, that's a great question. My answer to that would be a qualified no. How downloads are handled is probably going to be dependent on use case. To that end, I think the blocking .download() and the non-blocking methods in this PR should be broken out into at least one (probably two?) plugins.

Yah, I agree.

> The problem with that is binding to will-download. A new method to hook into will-download with a custom handler could be exposed, or (with modification to pass a child handler) the custom event bindings in #367 could be used. Thoughts?

Yah, I think we should add this regardless, we're already hooking into the other events. Seems like it would be as simple as:

`win.webContents.session.on('will-download', forward('will-download'))`

Then you can hook into it with an action:



Haven't thought through exactly how this would work, but that would be the approach I would investigate.
",matthewmueller,rosshinkley
382,2015-12-22 02:00:24,"@matthewmueller no problem. :)  Thanks for yours as well!

Tying up some loose ends:

> I was proposing this to handle `wait('downloads-complete')` piece that you added in this PR. Haven't investigated how that would work internally though.

Yeah, I understand the need, and also buy `.wait('downloads-complete')` is problematic.  Totally off the cuff: I think that enforcing one download per `.download()` call would probably work.  It would consist of (more or less) how it works now, but with an extra wait for `will-download` to be caught, and the internal method using the wait-download function.

> From my understanding, a POST request triggers the download, so whether this is a plugin or not, we'd need to at least know how to do that with core.

I was more concerned with the ""authenticated"" part, not with that it was triggered on POST.  I don't _think_ it should matter.  Electron doesn't seem to care what triggered a download, just that one happens.  That being said, it's probably worth propping up a minimal test case to be certain.

> Yah, I agree [to plugins].

The more I think about this, the more sense it makes, and maybe should redirect my attention to #391.  I was thinking about how to extend the Electron process earlier today, because, well...

> Seems like it would be as simple as: `win.webContents.session.on('will-download', forward('will-download'))`

Handling this appropriately seems to require doing some special steps in the Electron process.  In tinkering with `.on('will-download', fn)`, as soon as the `DownloadItem` fell out of the handler scope, Electron would execute whatever behavior had been defined by synchronous completion (almost like the `on` handler is more like middleware, if that makes sense).  The [Electron docs for `setSavePath`](https://github.com/atom/electron/blob/master/docs/api/download-item.md#downloaditemsetsavepathpath) seem to support what I found by experimentation:

> The API is only available in session's will-download callback function. If user doesn't set the save path via the API, Electron will use the original routine to determine the save path(Usually prompts a save dialog).

In other words, trying to do something via event communication would (almost) certainly result in a blocking download dialog.

I think I'm going to close this PR, backburner the download plugins for the moment, and direct my remaining questions to #391 as I think they're more sensible under that topic.  
",rosshinkley,matthewmueller
382,2015-12-23 12:10:10,"@rosshinkley since the merge of this PR seems to be on hold. would you be able to provide some example to download a file using the internals? Sorry, I am new to both electron and nightmare
",SantoshSrinivas79,rosshinkley
379,2016-01-06 18:43:05,"yah, i agree with @rosshinkley. `use` let you bundle a set of actions together, while `action` defines a new method. let me know if this is unclear and maybe i can clear it up in the docs
",matthewmueller,rosshinkley
379,2016-12-28 02:19:50,"I agree with @shadowmint; there definitely needs to be more documentation for passing parameters to custom actions. There's almost nothing in the documentation that I could find, and the actual way you need to do it is not super intuitive - a bad combination.

**Edit:** Also, I just found this which is helpful for passing parameters with non-electron actions: https://github.com/rosshinkley/nightmare-examples/blob/master/docs/beginner/action.md  (Thanks, Ross!) Should be a link to that from the main docs I reckon.",josephrocca,shadowmint
377,2016-01-18 23:28:51,"@matthewmueller I just implemented a `showDock` option: https://github.com/segmentio/nightmare/pull/441
",jviotti,matthewmueller
377,2016-01-18 23:35:12,"@matthewmueller BTW, is there an existing issue to specifically tackle the open electron processes problem when an error occurs? I'd love to collaborate on that one.
",jviotti,matthewmueller
377,2016-01-19 01:09:19,"@jviotti #409 is _somewhat_ related, is that what you had in mind?
",rosshinkley,jviotti
375,2015-12-22 22:22:49,"@contra ahh, are you seeing it hang forever if the initial page load fails? right now it's only initialized when you call `.wait()` before a click or something. that should be fixed.
",matthewmueller,contra
375,2016-04-14 16:52:52,"@contra Depending on the kind of page load failure, #553 _might_ address your issue.

@joychester I wrote two quick test cases:

**nonexistent element**



**function that never returns true**



Both error out with the appropriate error message after 30s.  Can you provide a minimal example that causes nightmare to hang?
",rosshinkley,joychester
375,2016-04-14 16:52:52,"@contra Depending on the kind of page load failure, #553 _might_ address your issue.

@joychester I wrote two quick test cases:

**nonexistent element**



**function that never returns true**



Both error out with the appropriate error message after 30s.  Can you provide a minimal example that causes nightmare to hang?
",rosshinkley,contra
375,2016-04-15 02:22:52,"Hi, @rosshinkley , your case works fine from my side too, but my test pages is not kind of different with yours :)
my page will load the page content async(like SPA application), so if i write wait method like following, it will hang forever:



however, if i hard-wait for the page loaded complete, then the wait() works fine until it timedout(10 seconds in my case)



Seems, nightmare API does not support SPA properly(wait for a element created after Dom content loaded event). Hope this case helps for your further analysis. just let me know if you need any info.

Thanks!
",joychester,rosshinkley
375,2016-04-15 14:47:49,"@joychester Ah!  Thank you for providing an example.  I can reproduce the behavior you're seeing.  I'll dig into it and see what is going on.
",rosshinkley,joychester
375,2016-04-15 21:26:47,"@joychester A quick look yields that `webBrowser.evaluateJavaScript` is hanging once in a while and not calling back.  Electron doesn't have any errors when it happens.  This problem is not unique to StubHub - it happens with Yahoo and Youtube as well.  I'm not 100% sold that waiting for an element created after DOM content loaded is the cause, or that the site is an SPA.  

(As an aside, I can hack around it by forcing the `javascript` handler to poll if the callback has been called, but that is terrifyingly hacky.) 

Some tinkering shows me that it's not necessarily iframes, slow loads, load failures, or particularly large assets (or any combination).  I'm still hunting for a root cause/minimum reproduction case.
",rosshinkley,joychester
375,2016-04-16 01:01:06,"@rosshinkley , Thanks for your info , is that possible to be an issue with Electron? hack way may not elegant, but once you have more insights, please let us know :)
",joychester,rosshinkley
375,2016-04-17 01:03:02,"Thanks @rosshinkley for all your effort and investigation! then we need to wait for Electron permanent fixes. 
",joychester,rosshinkley
375,2016-04-20 13:52:58,"they are pretty good team to get things resolved fast, and thank you @Mr0grog and @rosshinkley for chasing them :)
",joychester,rosshinkley
375,2016-04-20 13:52:58,"they are pretty good team to get things resolved fast, and thank you @Mr0grog and @rosshinkley for chasing them :)
",joychester,Mr0grog
374,2015-12-09 18:55:56,"@matthewmueller Ah, yeah, grouping them makes a lot of sense.  I'll pull that together as time permits.

As for overwriting the preload: the template-generated preload would be overwritten every time.  The template is internal to Nightmare.  As such, the internal changes to preload should be picked up if any are made.  Ultimately, what I am reaching for is the default exception behavior for prompt and confirm may be (probably is?) undesirable, and there should be a way to override it.  Maybe I'm not following what you're asking?

As for specific use cases: the only one I know of offhand is what @yoz ran into with `alert` - if you have a prompt or confirm an event that fires _before_ an `inject`/`evaluate` can run.  This gets back to overriding the default exception behavior - I'd imagine you'd want to overwrite it to handle dialogs with valid responses.  Does this make sense?
",rosshinkley,matthewmueller
374,2015-12-10 19:56:05,"@matthewmueller I may have gotten a _bit_ overzealous (and these changes almost certainly step on #337's logging changes), but I've grouped all of the page-\* events into one unified event.  I also tried to update the documentation to be clear-ish on what to expect with `on('page', type ...` using the jsdoc-like format.  (Offtopic, is there a documentation standard to follow?  Is this tangentially related to #364?)

Thoughts?
",rosshinkley,matthewmueller
374,2015-12-10 22:01:25,"@matthewmueller thank you. :)  Responding to your questions:
1. Yeah, the other reason I went the templated route was because of precedent, but regardless, this is a good question.  Spitballing an idea off the top of my head: could the internal preload script be in its own file, read off disk, have the `{{!src}}` token spliced in, and have that be used in the place of `exports.preload`?  That would let both the user-defined preload and internal preload be real first-class javascript files, complete with syntax highlighting.  (There are probably less ugly, less fragile variants of this, like having the token in a comment or something.  The chosen solution might be able to be adapted for the other templates.  Would that worth pursuing in a separate PR?)
2. Thinking about this with a little distance, I could have probably simply used `require` to pull in the user-defined preload, and pass the IPC to it that way.  Should the token then be changed to something like `require('{{!userPreloadFilepath}}')(__nightmare.ipc);`?  I'm almost positive the path would _have_ to be absolute, and the documentation should reflect that.  This also may help solve the token issues from your first question if the require had a dummy file to require by default.  Thoughts?
",rosshinkley,matthewmueller
374,2015-12-11 04:19:57,"@matthewmueller This was an itch I had to scratch: I went ahead and pulled together the `require` approach described above.  Is this close to what you had in mind?
",rosshinkley,matthewmueller
373,2015-12-18 10:42:02,"@matthewmueller I expected a more elegant solution, eg blocking scripts loading by domain or hostname, this way works in PhantomJS.
",SerjoPepper,matthewmueller
373,2017-03-13 08:50:29,"Hi @matthewmueller ,

I am not really sure the issue that I create a custom preload script to capture alert message. Actually I follow the site that you provided, but no chance.




",nquoctuan,matthewmueller
373,2017-03-17 03:47:18,@nquoctuan I'm _almost_ positive that the path for `preload` has to be fully qualified.  What happens if you change that to `preload: require('path').resolve('alertMessage.js')`?,rosshinkley,nquoctuan
372,2015-12-27 15:34:16,"@hovosanoyan #410 will let you set proxy settings, etc. through [Chrome's command line switches](https://github.com/segmentio/nightmare#switches). Hope it helps!
",juanpaulo,hovosanoyan
371,2015-12-07 19:50:02,"Thank you for your time @rosshinkley. Unfortunately it means that I will either have to switch to barebone Electron or deal with this issue in forked Nightmare. It would be nice to know if there is some long term plan to support those usecases or if the idea is not even considered to be included in Nightmare's source.
",pkawiak,rosshinkley
371,2015-12-08 04:27:58,"@pkawiak no problem.  I can't imagine this particular issue is going away as there are already a couple of other open download questions akin to this one.  Plus, willfully not supporting a common browser activity would be sort of silly.

As for inclusion, I'm sure a PR to take care of the obvious download cases would be welcome.
",rosshinkley,pkawiak
371,2015-12-11 20:30:26,"@pkawiak I didn't mean to step on your toes, but I've put together (a hopefully reasonable?) PR #382 to handle downloads.  I'd like to get your feedback. :)
",rosshinkley,pkawiak
368,2015-12-05 20:03:46,"thanks @danielstjules! i think the API should be `nightmare.header()` and then support the following:

`header(header, value)`
`header(obj)`

what do you think?

the rest looks good!
",matthewmueller,danielstjules
368,2015-12-07 19:17:36,"@matthewmueller Sounds good, updated!
",danielstjules,matthewmueller
368,2015-12-08 04:26:41,"thanks @danielstjules !
",matthewmueller,danielstjules
367,2015-12-10 15:54:59,"@matthewmueller I have a couple of questions for you.  One, is it acceptable that `.bind()` accepts _only_ a name, and not data (like say, jQuery's bind)?  Two, `.unbind()` removes all of the named event listeners, introducing the (probably wrong) assumption that unbinding a custom event should remove all of the child process listeners for that name.

Is this closer to what you had in mind?  Thoughts?
",rosshinkley,matthewmueller
367,2015-12-10 21:20:40,"@matthewmueller Sure, making the event handler an option in the function call, or having `unbind` remove the parent listener makes sense.  It's also probably worth pointing out that I don't think you can fully wall this off from `.on()` - the ad hoc events will still be listenable. In other words,



... should still be valid, if a bit misleading.  Alternatively, and for completeness,



... would also still call the handler from `.on()` when `some-custom-event` is emitted.

It's also probably worth noting that I don't think you can remove an `.on()` handler, either - is there a helper to remove a listener from `child`?

Are you suggesting making the handler function for `.bind()` mandatory?  I'm not so certain about that, but I can't think of a compelling counterargument.

---

What I was a _bit_ more concerned about - and I'm sorry I wasn't terrifically clear - was what happens when you call `.unbind()` down to the child process (in `runner.js`).  I wrote it such that the Electron `.unbind()` listener would scrub all listeners with that name from the renderer, effectively removing that event from being emittable.  This is owing to the handler in the renderer's `.on('some-custom-event', fn)` not being unique and also not being scoped outside of `bind`.

This also raises another question: can more than one event emitter per name be added and bound?  Is there a use case for having multiple custom event emitters of the same event name?  Would it be worth enforcing a rule that one and only one custom emitter could be added per name?

I'm still not sure I'm being clear.  Let me know if you have questions.
",rosshinkley,matthewmueller
367,2015-12-12 20:29:21,"@matthewmueller I've gone ahead and put in the optional handlers for custom events.  

I've added enforcement of only one child emitter per name.  This prevents situations where custom events can have more than one emitter.  (This also clears up my question from above.)

I've also added some extra logic around how `unbind` works: `.unbind('sample-event')` will remove the event listeners on the parent and the child emitter, where `.unbind('sample-event', handler)` will remove the handler on the parent and the emitter on the child if it is the last handler.  I'm not _real_ confident in the last parent listener removal logic also removing the child emitter.  It's nice the event cleanup is there, but I worry it might be unexpected behavior.  What do you think?
",rosshinkley,matthewmueller
365,2015-12-04 18:23:52,"@yoz I thought about this when I was going through this last night, and decided that I'd address your immediate problem first.  I'm planning to look at confirm and prompt as time permits.
",rosshinkley,yoz
363,2015-12-03 17:09:38,"@Kreozot haha, yah i was thinking about that... not sure how it'd look unless we break the API. I guess we could maybe do:



Almost wondering if it just makes more sense to just use an object, which wouldn't break the API:



---

Also, how does this handle multiple elements on different parts of the page by the way?
",matthewmueller,Kreozot
363,2015-12-05 13:21:04,"@matthewmueller Please take a look.
",Kreozot,matthewmueller
363,2016-09-18 20:01:07,"@highvoltag3  I'm still open to this PR, but the source is well out of date and would need to be updated.  Additionally, I don't think @matthewmueller's comments were ever addressed.
",rosshinkley,highvoltag3
363,2016-09-18 20:01:07,"@highvoltag3  I'm still open to this PR, but the source is well out of date and would need to be updated.  Additionally, I don't think @matthewmueller's comments were ever addressed.
",rosshinkley,matthewmueller
361,2015-12-03 16:27:49,"Hi @matthewmueller - I'm currently using it to implement drag and drop as well. (I've made an action which can drag and drop from/to page pixel positions, and you can also pass DOM selectors or functions to evaluate in the page context for it to determine those positions).

Internally it uses mouseDown/Move/Up and could also use touchStart/Move/End for mobile simulation.

I'd like to contribute that as I think it could be useful generally. Any thoughts? It would be easy to port without a public sendInputEvent action anyway.

Also just on the upgrade side you'll notice some deprecation warnings with the new Electron which I haven't looked into.

Cheers,
Andrew
",inversion,matthewmueller
361,2016-04-27 06:17:27,"Hi @inversion, I stumbled over this issue since I also need some drag and drop functionality. Have you released anything in that direction? Maybe a drag and drop action/plugin?
",maxfriedmann,inversion
361,2016-04-27 08:20:57,"Hi @maxfriedmann - I haven't got anything released for it yet, but the approach I took is basically sending the input events `mouseDown mouseMove (several) mouseUp`. The issues to consider are finding the start and end co-ordinates, choosing where to pick up the element and where to drop it (e.g. if you are trying to drop something that needs to be entirely in a target area, or if there are other target areas adjacent which can be mistakenly dropped into.
",inversion,maxfriedmann
359,2015-12-04 01:03:54,"@yoz ah, I see.  I don't think you'll have great luck with `inject` then, either.  Both `inject` and `evaluate` are (at least in my read) the same under the covers.

Pondering out loud: since alerts are blocking, should they be caught and emitted as alert events to Nightmare, similar to how `console.log` works?
",rosshinkley,yoz
358,2015-11-30 13:50:11,"I was working on the same feature and was about to push it when I saw your PR. This is a much needed feature, I hope it will be merged soon. Thank you @Kreozot for your work!

FYI here's my own implementation: 



But your solution seems at least as good
",yhuard,Kreozot
358,2015-12-02 15:57:16,"@yhuard :+1: 
scrollToSelector PR is coming
",Kreozot,yhuard
358,2015-12-02 17:21:07,"+1 for @sepehrs' suggestion: `screenshotSelector` should not violate the principle of least surprise.  If you ask for a picture of a specific element, you should get a shot of the whole element.  I completely agree with splitting the underlying functionality into their own functions, then having `screenshotSelector` be a wrapper for those functions

That being said, there are corner cases that I have mixed feelings about.  For example, taking a complete screenshot when the body is longer or wider than the viewport rectangle (as with #328) - should `screenshotSelector` take this into account and resize the viewport automatically, putting it back upon screenshot completion?  Thoughts?
",rosshinkley,sepehrs
358,2015-12-02 23:17:27,"@rosshinkley I've already thought of that and ended up thinking that resizing the viewport is dangerous: it can have side effects that the user didn't expect. For example, if an element is too big for, let's say, a medium screen but is hidden on large screen and we apply the resizing, the element may disappear. 

We define the viewport at beginning because we want to test the rendering with that viewport. If the screenshot cuts the element we capture, it's actually a good indicator that something's wrong with our style!
",yhuard,rosshinkley
358,2015-12-03 16:18:33,"@yhuard @sepehrs Like I said, I had mixed (and admittedly, mostly negative) feelings about resizing the viewport.  I agree that it's not a great idea, but mileage may vary with elements that extend beyond the viewport.
",rosshinkley,yhuard
358,2015-12-03 16:18:33,"@yhuard @sepehrs Like I said, I had mixed (and admittedly, mostly negative) feelings about resizing the viewport.  I agree that it's not a great idea, but mileage may vary with elements that extend beyond the viewport.
",rosshinkley,sepehrs
358,2015-12-03 16:57:11,"@rosshinkley the reason i didn't mind to much about the reszing of the viewport is the point @yhuard made about css selector but also a genuine use case could be that you want to see how the element looks on a specific device. if for example you are taking a screenshot of a header on mobile. you can see exactly what the above the fold content is.
",sepehrs,yhuard
358,2015-12-03 16:57:11,"@rosshinkley the reason i didn't mind to much about the reszing of the viewport is the point @yhuard made about css selector but also a genuine use case could be that you want to see how the element looks on a specific device. if for example you are taking a screenshot of a header on mobile. you can see exactly what the above the fold content is.
",sepehrs,rosshinkley
358,2015-12-09 17:53:25,"Oh, That's good news for me! Thanks @matthewmueller !
",felixcrive,matthewmueller
358,2015-12-10 14:49:39,"@matthewmueller I will give it a try this morning and I will let you know. The selector I want to capture is an external iframe. This is great. Thanks!
",felixcrive,matthewmueller
358,2015-12-10 16:19:47,"@matthewmueller It did work, thanks a lot!
",felixcrive,matthewmueller
358,2015-12-10 16:34:29,"@matthewmueller  Is there a way to capture an image if the evaluation of the page returns true?
",felixcrive,matthewmueller
358,2015-12-17 22:05:36,"@felixcrive, sorry i'm not sure what you mean, do you mind showing me what you mean?
",matthewmueller,felixcrive
354,2015-12-02 19:02:05,"Hm. This is not really sutiable for my usecase. I want to be able to trigger a ""log time"" process giving status updates on the go. @rosshinkley Your example only (my perspective) would work (my use case) if I would trigger the process and then check in a certain interval if there is any update. - no ""live data"".

I had a quick look  through the source an found this



Can't I utilize somehow `__nightmare.ipc.send` ? (or I am on the wrong track..)
",fentas,rosshinkley
354,2015-12-02 20:42:47,"@fentas Ah, I see.  Using `yield` and `evaluate` in this manner probably wouldn't work then. :)

I also take it you're trying to go beyond using `console.log` and the `DEBUG` environment variable?

If so, I'm not sure you can set up ad hoc events with `__nightmare.ipc.send`.  My gut instinct is no, as the event from `ipc` needs to be emitted up through the Electron process to Nightmare.  I don't _think_ the plumbing for that exists.  I'll have to play with it to see.
",rosshinkley,fentas
354,2015-12-03 16:58:04,"@matthewmueller I (embarrassingly) missed the `ipc.send`.  That's handy.

I think I'm on the same train of thought - I was tinkering with adding user-customizable events to accomplish what @fentas needed and have at least some of the basic mechanics down.  As time permits, I'll see if I can pull together the changes + documentation required. :)
",rosshinkley,matthewmueller
354,2015-12-03 16:58:04,"@matthewmueller I (embarrassingly) missed the `ipc.send`.  That's handy.

I think I'm on the same train of thought - I was tinkering with adding user-customizable events to accomplish what @fentas needed and have at least some of the basic mechanics down.  As time permits, I'll see if I can pull together the changes + documentation required. :)
",rosshinkley,fentas
354,2016-04-03 01:47:01,"@fentas Custom eventing is now a plugin: [nightmare-custom-event](https://github.com/rosshinkley/nightmare-custom-event).  I'm going to go ahead and close this item.  If you have any more questions, feel free to reopen/open another issue.
",rosshinkley,fentas
350,2015-11-20 16:51:15,"@s0m3on3 You shouldn't have to remove the event listener, that's the purpose of using [`EventEmitter.once`](https://nodejs.org/api/events.html#events_emitter_once_event_listener).  The listener should remove itself when the event handler is called.  Were you able to recreate the original issue?

_EDIT_: I misread your suggestion.  You're suggesting removing the other event listeners when any `javascript` event is called.  I might buy that, but you'd think that problem would exist on all platforms.

@bollywood-coder It looks like you're running on Windows - I don't _think_ it would be Windows-specific, but just to rule it out, what version are you on?  I'd like to make sure this is tested on a similar environment.
",rosshinkley,bollywood-coder
350,2015-11-20 16:51:15,"@s0m3on3 You shouldn't have to remove the event listener, that's the purpose of using [`EventEmitter.once`](https://nodejs.org/api/events.html#events_emitter_once_event_listener).  The listener should remove itself when the event handler is called.  Were you able to recreate the original issue?

_EDIT_: I misread your suggestion.  You're suggesting removing the other event listeners when any `javascript` event is called.  I might buy that, but you'd think that problem would exist on all platforms.

@bollywood-coder It looks like you're running on Windows - I don't _think_ it would be Windows-specific, but just to rule it out, what version are you on?  I'd like to make sure this is tested on a similar environment.
",rosshinkley,s0m3on3
350,2015-11-20 17:07:22,"@rosshinkley yes, i recreated. ""listener should remove itself when the **event handler is called**"". if i will emit only `response` event, handlers for `error` & `log` from every `.evaluate()` will wait for `error` & `log` event
",s0m3on3,rosshinkley
350,2015-11-20 17:22:09,"@s0m3on3 I meant the original issue of having node complain about the EventEmitter leak.  I can't reproduce it locally, even though my event emitter listener limit is also set to 10 (which is the nodejs default).

And yes, see my edit: I misinterpreted what I read the first time.  That is my fault, and I apologize. :)  

@s0m3on3 is correct, and as a quick sanity check, I threw together an emitter watcher.  Sure enough, the counts go up but do not fall back down.  Interestingly, even after a couple dozen address changes, node does complain about extra event listeners.  (Maybe that's an issue with my environment?)

At any rate, your fix should be submitted as a PR as it should address @bollywood-coder's issues.
",rosshinkley,bollywood-coder
350,2015-11-20 17:22:09,"@s0m3on3 I meant the original issue of having node complain about the EventEmitter leak.  I can't reproduce it locally, even though my event emitter listener limit is also set to 10 (which is the nodejs default).

And yes, see my edit: I misinterpreted what I read the first time.  That is my fault, and I apologize. :)  

@s0m3on3 is correct, and as a quick sanity check, I threw together an emitter watcher.  Sure enough, the counts go up but do not fall back down.  Interestingly, even after a couple dozen address changes, node does complain about extra event listeners.  (Maybe that's an issue with my environment?)

At any rate, your fix should be submitted as a PR as it should address @bollywood-coder's issues.
",rosshinkley,s0m3on3
350,2015-11-20 18:52:35,"@s0m3on3 thanks for the fix in the code! those once emitters can be tricky if not all of them are called ;)
glad i could help you guys to find an issue.
",bollywood-coder,s0m3on3
349,2016-07-08 17:16:25,"@yonatanmn Everything passed from Nightmare to Electron is serialized, and functions do not serialize nicely.  If you find that you need methods in `.evaluate()` commonly, you may want to look into defining a custom preload.
",rosshinkley,yonatanmn
348,2015-12-02 17:24:59,"Yup, after updating everything is working. Thanks @rosshinkley!
",ns-jdripps,rosshinkley
346,2015-11-18 23:37:17,"@rosshinkley Thanks! I will try use your fork.
",olegatro,rosshinkley
346,2015-12-03 16:32:29,"@inversion Far and away better than my implementation.  Thanks!
",rosshinkley,inversion
345,2015-11-16 15:43:10,"@alfonsomga seems like the `web-preferences.partition` [option](http://electron.atom.io/docs/v0.34.0/api/browser-window/#new-browserwindow-options) of `BrowserWindow` is what you need
",bjrmatos,alfonsomga
345,2015-11-16 17:32:58,"@alfonsomga I've hit this too, and as a note for others who are headscratching (and me in the future), the @bjrmatos link has the options as being dash separated instead of camel-cased.  This is because the documentation that is linked to in the Nightmare documentation is on the Electron master branch, and as such, is unreleased (see [here](https://github.com/atom/electron/issues/3431)).  The options for the version Nightmare is currently on are dash-separated.

A quickly hacked together example:



... doesn't do what you'd expect: this should start a new electron window with no taskbar icon and a partition called ""foo"" (which you could replace with a unique identifier to get the behavior you want, I used 'foo' for brevity).

However,  if you use the dash-separated options:



... will start you with a fresh session with no taskbar icon, as you'd expect.

All that being said, +1 to #338.  That would be handy to have regardless.

Maybe the Nightmare docs should link to the versioned documentation instead of the master branch.  Thoughts?
",rosshinkley,alfonsomga
345,2015-11-16 17:32:58,"@alfonsomga I've hit this too, and as a note for others who are headscratching (and me in the future), the @bjrmatos link has the options as being dash separated instead of camel-cased.  This is because the documentation that is linked to in the Nightmare documentation is on the Electron master branch, and as such, is unreleased (see [here](https://github.com/atom/electron/issues/3431)).  The options for the version Nightmare is currently on are dash-separated.

A quickly hacked together example:



... doesn't do what you'd expect: this should start a new electron window with no taskbar icon and a partition called ""foo"" (which you could replace with a unique identifier to get the behavior you want, I used 'foo' for brevity).

However,  if you use the dash-separated options:



... will start you with a fresh session with no taskbar icon, as you'd expect.

All that being said, +1 to #338.  That would be handy to have regardless.

Maybe the Nightmare docs should link to the versioned documentation instead of the master branch.  Thoughts?
",rosshinkley,bjrmatos
345,2015-11-16 18:09:49,"Thanks! @bjrmatos @rosshinkley
",alfonsomga,bjrmatos
345,2015-11-16 18:09:49,"Thanks! @bjrmatos @rosshinkley
",alfonsomga,rosshinkley
345,2015-11-16 20:46:16,"@bjrmatos @alfonsomga Have either of you tried using an in-memory or non-default partition?

I tried it on a whim just now, and it looks like as soon as I try to override `web-preferences` evaluate hangs.  The session gets created, and if you set up DEBUG, you can watch everything execute right up until evaluate, but evaluate never finishes.
",rosshinkley,alfonsomga
345,2015-11-16 20:46:16,"@bjrmatos @alfonsomga Have either of you tried using an in-memory or non-default partition?

I tried it on a whim just now, and it looks like as soon as I try to override `web-preferences` evaluate hangs.  The session gets created, and if you set up DEBUG, you can watch everything execute right up until evaluate, but evaluate never finishes.
",rosshinkley,bjrmatos
345,2015-11-16 21:11:58,"@rosshinkley +1 it isn't working at all here, when I added `'web-preferences':{partition: 'persist:foo123'}` some functions like `.type()`, `.click()`stopped working.

![dd](https://i.imgur.com/JUCt5Ij.png)

It didn't type the password & email and also didn't click on the login button...
",alfonsomga,rosshinkley
345,2015-11-17 05:33:16,"@alfonsomga After some tinkering, I figured out what is happening.  The `defaults` library - which is used to merge passed options with default options - does not merge deeply.  When we were passing in options to `web-preferences`, the existing options - the parts that load most of the sugar that allows Nightmare to work - were getting overwritten.

I've gone ahead and submitted a fix, pending approval (#348).
",rosshinkley,alfonsomga
345,2015-11-17 11:23:17,"@rosshinkley Thanks, it works now :+1: 
",alfonsomga,rosshinkley
344,2016-08-11 09:18:37,"@rosshinkley Hi for some reason the partition is not working for me
https://github.com/segmentio/nightmare/issues/754
",daniel3d,rosshinkley
342,2015-12-18 01:07:40,"@ilabvb did you get this resolved?
",matthewmueller,ilabvb
341,2015-11-11 16:55:09,"@fmaruki thanks - yes, adding `require('mocha-generators').install();` resolved it.

Seems like the readme should include that line?
",simonsez,fmaruki
340,2016-04-08 17:41:52,"@nathan-martinez Are you still experiencing this problem?

If so, you might want to take a look at [`.header()`](https://github.com/segmentio/nightmare/blob/master/lib/nightmare.js#L195-L200).  That allows you to set headers directly.  (There isn't documentation for it, I opened #551 for that.)
",rosshinkley,nathan-martinez
339,2016-04-14 03:59:17,"@lexifdev With the additions to `.action()` with #425, this could be implemented as a plugin.  Feel free to open up an issue or join the gitter room if you have questions.

Closing.
",rosshinkley,lexifdev
338,2015-11-25 09:23:07,"@matthewmueller are there any autoformatter settings for the project? If we could standardise them it would help.
",inversion,matthewmueller
338,2015-12-02 16:57:09,"Spacing updated @matthewmueller 
",inversion,matthewmueller
338,2015-12-03 16:13:54,"@inversion yep, good call. planning on adding standard.
",matthewmueller,inversion
338,2015-12-03 16:28:48,"now on master, thanks @inversion !
",matthewmueller,inversion
337,2015-12-03 16:44:05,"Hi @matthewmueller , the use case for us is that our application logs messages to error, warn, info, log depending on severity and these are useful to capture in our tests (we're mainly using nightmare for UI testing). I think a nicer implementation would be a generic `console` event which captures all console output but also adds a `type` or similar field indicating the 'level' (dir, trace, info, error) etc.

The existing page-log event can be kept the same as it is for backwards compatibility and people who are only interested in `console.log` and want simplicity.

Happy to implement that if it sounds like something that would be merged.
",inversion,matthewmueller
336,2015-12-09 20:11:03,"Thanks for the PR @inversion ! I incorporated these changes in #376 
",matthewmueller,inversion
334,2015-11-05 15:28:34,"Hey @inversion, I was trying to use the `page-error` event and it took me a while to realise that while documented in the README, it is not yet available in the last published release. I had to install from GitHub in order to use it: `npm install --save nightmare@segmentio/nightmare#e556285`.

Hope that helps.
",thibaudcolas,inversion
332,2015-11-24 00:25:23,"@darthcloud I agree that it's something that is (in general) missing from headless solutions, and that it is pretty important.

To that end, I spent some time tinkering with `will-download`, and there are a couple of things I'd love to hear your (and others') thoughts on.
1. I know I'm stating the obvious, but this would require an upgrade to `electron-prebuilt`.
2. You have to do what you're going to do with the downloading item synchronously inside of the `will-download` handler.  This means that I don't think you could use events to negotiate on a per-download basis where to put downloads or if an item should be ignored.  I haven't put in an option to globally ignore downloads yet, I wanted to get some feedback (hopefully a correction) on this first.
3. I realize that multiple downloads is a _bit_ of a corner case, but a problem nonetheless.  In my sandbox, I have the `will-download` event emitting a `download-start` event, and when the item is done, emitting a `download-done` event from the DownloadItem's `done` event up to Nightmare.  My sample application simply keeps track of the number of downloads in progress and uses (more or less) the same approach as `wait` until all of the downloads are complete.  In other words, it's hacky and works, but I'm struggling to come up with a less-hacked together approach.
4. If #338 were folded in, we could reuse the override path to dictate where downloads go.  That might make for cleaner options and easier cleanup.
5. If the server doesn't immediately respond to the action that triggers a download (your example in #151 exhibits this behavior), the `will-download` event might be triggered _after_ Nightmare has already moved on.  My current ""fix"" is to simply wait, but I don't think there's a method to expect an outcome from an action, eg clicking on a link and expecting a download to start.

I put the changes up on [a branch in my fork](https://github.com/rosshinkley/nightmare/tree/auto-download).  I put up a hastily thrown together minimal sample [as a gist](https://gist.github.com/rosshinkley/c1873d40e17dd433cc2d) for the curious.
",rosshinkley,darthcloud
332,2016-01-05 08:23:43,"@rosshinkley :+1: for sharing fork and a how-to-gist and +1 for feature
",santeriv,rosshinkley
332,2016-01-05 17:42:35,"@santeriv This is a _bit_ out of date.  I redid the solution for `will-download` and submitted a PR (#382), but it's been closed pending adding Electron extensions (#391).  If you want to use a fork to handle `will-download`, I'd suggest using that one for the time being.  There are examples in the test suite to show how to use it. :)
",rosshinkley,santeriv
328,2015-12-18 01:04:00,"thanks @rosshinkley for the example :-)
",matthewmueller,rosshinkley
324,2015-11-02 06:42:00,"thanks @Zn4rK, that's 100% correct!
",reinpk,Zn4rK
323,2016-04-03 03:32:09,"@chentsulin @TonyWang031 Depending on the version of jQuery being injected, they could end with sourcemap comments, which would cause the end of the calling function that encapsulates the injected script to be commented out, causing a runtime error.  I would be willing to bet this is what you were hitting, given the unminified version worked but the minified version wouldn't.

The template was fixed in #524, so I am going to go ahead and close this issue.  If you still have problems, feel free to reopen/submit a new one.
",rosshinkley,chentsulin
323,2016-04-03 03:32:09,"@chentsulin @TonyWang031 Depending on the version of jQuery being injected, they could end with sourcemap comments, which would cause the end of the calling function that encapsulates the injected script to be commented out, causing a runtime error.  I would be willing to bet this is what you were hitting, given the unminified version worked but the minified version wouldn't.

The template was fixed in #524, so I am going to go ahead and close this issue.  If you still have problems, feel free to reopen/submit a new one.
",rosshinkley,TonyWang031
322,2016-04-08 17:34:05,"Upon further investigation, I can't recreate this behavior.  Doing something like:



@edasque @smallcar88 @davis Are you still experiencing problems with `.evaluate()` and fat-arrow functions?
",rosshinkley,davis
322,2016-04-08 17:34:05,"Upon further investigation, I can't recreate this behavior.  Doing something like:



@edasque @smallcar88 @davis Are you still experiencing problems with `.evaluate()` and fat-arrow functions?
",rosshinkley,edasque
322,2016-04-08 17:34:05,"Upon further investigation, I can't recreate this behavior.  Doing something like:



@edasque @smallcar88 @davis Are you still experiencing problems with `.evaluate()` and fat-arrow functions?
",rosshinkley,smallcar88
322,2016-04-08 18:34:48,"@rosshinkley i haven't used nightmare in a long time, but yes it was with fat arrow functions, thought it shouldn't have mattered either way because I was transpiling down to es5 before running...
",davis,rosshinkley
322,2016-04-13 01:53:58,"@davis Hm, I'd be curious what transpiler you were using - it _should_ have worked.  At any rate, the ES6 features you needed are now supported out of the box with Node 4+, so I'm going to consider this issue closed.  If you continue to have this problem, feel free to reopen/open a new issue.
",rosshinkley,davis
321,2015-10-30 14:14:07,"That's it! Thanks @chrisgeo.
",thibaudcolas,chrisgeo
320,2015-11-11 00:45:29,"@reinpk it's just one line!
",Namek,reinpk
320,2015-11-25 00:16:59,"Okay going to merge this as it seems like it's helping out a lot of folks. Haven't dug into the internals yet, but I'm sure we can make changes if issues crop up.

Great work @fr- !
",matthewmueller,fr-
319,2016-04-03 01:43:51,"@Zn4rK #425 is in as of 2.3.0.  Are you planning on publishing a `.waitForUrl()` plugin?
",rosshinkley,Zn4rK
319,2016-04-03 01:47:23,"@rosshinkley Yes! I'll get on it tomorrow or monday - and closing this with a link when I'm done.
",Zn4rK,rosshinkley
319,2016-04-08 17:42:18,"@Zn4rK Awesome!! Thanks!
",rosshinkley,Zn4rK
314,2016-04-11 13:37:32,"@emgould Everything there looks fine to me.  Are you still having this problem with later versions of Nightmare?
",rosshinkley,emgould
313,2015-10-29 18:48:49,"Aha, thanks @juliangruber!
",dbkaplun,juliangruber
313,2015-10-29 23:11:49,"@juliangruber nice!
",matthewmueller,juliangruber
312,2015-12-05 16:09:56,"@reinpk I've try to capture `did-get-response-details` event, but I got EVERY response of the resources(js, css, images...) in the page. I only want the main page's response info.

Is there any way to do this?
",scarletsky,reinpk
312,2015-12-05 19:47:27,"@scarletsky as far as i know you'd need to filter for the resource you are looking for yourself
",matthewmueller,scarletsky
309,2016-04-03 01:36:00,"@kevinprotoss @fr- Could you use `.header()` to accomplish this?
",rosshinkley,fr-
309,2016-04-03 01:36:00,"@kevinprotoss @fr- Could you use `.header()` to accomplish this?
",rosshinkley,kevinprotoss
306,2015-12-03 22:34:06,"thanks @antpaw !
",matthewmueller,antpaw
304,2015-10-21 16:57:34,"Oh jeez, of course, thanks @LarryBattle. 

I added the `require('mocha-generators').install();` line and the tests are now failing. I've tried to get an example that passes, pulling in updated selectors from the yahoo search, but I'm not able to get anything to work. Are there updated examples using Mocha that pass?
",nkanderson,LarryBattle
304,2016-04-08 17:16:09,"@nicolekanderson Did you get this sorted out?  If not, have a look at [Nightmare's test suite](https://github.com/segmentio/nightmare/blob/master/test/index.js).

@miaomi Hm, the errors look like `electron-prebuilt` is either not installed or didn't install properly.  Try wiping `node_modules` and running `npm install` again.

@WMeldon It's best practice to end the Nightmare instance when you're done.  Otherwise, the child process will remain running forever and you will (rightfully) get Mocha timeouts.
",rosshinkley,WMeldon
304,2016-04-08 17:16:09,"@nicolekanderson Did you get this sorted out?  If not, have a look at [Nightmare's test suite](https://github.com/segmentio/nightmare/blob/master/test/index.js).

@miaomi Hm, the errors look like `electron-prebuilt` is either not installed or didn't install properly.  Try wiping `node_modules` and running `npm install` again.

@WMeldon It's best practice to end the Nightmare instance when you're done.  Otherwise, the child process will remain running forever and you will (rightfully) get Mocha timeouts.
",rosshinkley,miaomi
301,2015-12-04 02:21:21,"@matthewmueller FWIW, there's a decent looking [jsperf](https://jsperf.com/bind-vs-closure-setup/49).  According to that, it looks like the `bind` method is significantly slower.  Is that close to what you had in mind?
",rosshinkley,matthewmueller
301,2015-12-04 06:39:32,"@rosshinkley yep this is exactly what i was looking for:

![img](https://cldup.com/LwkeRajv9Q.png)

even though it's a micro optimization, i don't think using `self` is much worse syntactically. 

closing for now, thanks guys!
",matthewmueller,rosshinkley
300,2015-10-20 21:33:00,"Thanks @antpaw !
",matthewmueller,antpaw
298,2015-10-20 22:33:14,"@matthewmueller i'd recommend #303 instead. you may have more make tasks later but `npm test` is very common (as the shortcut is even there from `npm run-script` / `npm run` test)... so best to support that. i think many CI systems default to this, too.
",tejasmanohar,matthewmueller
298,2015-10-20 23:07:26,"@tejasmanohar yep, i like that more. I think we should keep the makefile, but the other stuff looks good!
",matthewmueller,tejasmanohar
298,2015-12-03 17:04:28,"thanks @LarryBattle this is on master now!
",matthewmueller,LarryBattle
297,2015-10-23 15:04:55,"@CatTail `.evaluate()` internally waits for the `did-finish-load` event before running. So you can replace the `.wait()` with `.evaluate()`, like this:



It's a little bit hacky because the internal implementation can change, but it should work.
",FdezRomero,CatTail
297,2016-02-16 14:49:09,"@CatTail if still relevant, i solved this issue in this ticket https://github.com/segmentio/nightmare/issues/481
",sintanial,CatTail
295,2015-10-21 23:52:03,"@matthewmueller Yes, you should change the example, because you want start try it out and you got this error it's frustrating at the beginning.
",laychopy,matthewmueller
292,2015-10-19 09:13:07,"Thanks @danhalliday for the reply, the issue was something completely different in the code with illegal values, sorry I forgot to remove this issue.
",souly1,danhalliday
289,2015-10-18 23:16:33,"@LarryBattle That was my bad. I tried both of your solutions, but it gives me `undefined`.



I am not sure why exactly it is breaking.
",rahul-desai3,LarryBattle
289,2015-10-19 00:11:31,"@LarryBattle I tried your example but it gave me `undefined` in the console, just like before. Here is my code: https://gist.github.com/rahul-desai3/8ee6f5322e17a34116ba
",rahul-desai3,LarryBattle
289,2015-10-19 18:06:56,"@LarryBattle That works very well on my local. However, when I put this on Heroku, it doesnt. Here is what I get:


",rahul-desai3,LarryBattle
289,2015-10-25 19:44:34,"thanks! gonna close as a duplicate of #224 as @LarryBattle mentioned
",reinpk,LarryBattle
287,2015-10-16 09:29:55,"thanks @LarryBattle - I definitely do not want to use cheerio as I need to fill in forms, click buttons etc. on the remote page before parsing it. I am looking into [SpookyJS](https://github.com/SpookyJS/SpookyJS) as well as into nightmare, but with nightmare I am not able to evaluate s simple value and extract it back into express at this time.
I do understand the purpose of generating values, it just doesn't click with me how to use them for scraping, especially if I have a series of remote tasks with multiple `.evaluate` blocks.
",tmaximini,LarryBattle
285,2015-10-19 05:34:43,"@LarryBattle  Ah, sorry for missing the arguments in evaluate(). However, it still doesn't work.
",FredXue,LarryBattle
285,2015-10-21 02:42:46,"Great!  it works.  I really need to practice JS coding more.  LOL.        Really appreciate your help!  @LarryBattle 
",FredXue,LarryBattle
282,2015-10-19 00:03:12,"@matthewmueller Could you provide a test example?
",LarryBattle,matthewmueller
282,2015-11-11 00:09:22,"@Namek from what I can see there are multiple issues at the same time that also but not _exclusively_ manifest themselves in warnings about  about too many registered `uncaughtException` event listeners:
1. The most obvious one is of course, that the event listeners are registered on `process` (which is _global_) whenever a new Nigthmare instance is created and them not being removed after an instance is shut down.
2. Additionally there is a default maximum for listeners on any `EventEmitter` (10 is the default, as per: https://nodejs.org/api/events.html#events_emitter_setmaxlisteners_n) which can be increased (and depending on the node version queried) as need be. So in the legitimate case where more than 10 instances of Nightmare are created _concurrently_ this number has to be increased with the number of instances. _(as a side note: as there could be more code apart from nightmare that registers handlers on `process` one should also track the globally registered event listeners not created by nightmare)_.

The above points are being handled by the feature branch I posted, with the slight caveat that the meaning of _shutdown_ is a matter of definition, but can be classified as in my previous comment.

The second part of the issue is handling abnormal exits and failure to start the underlying electron process. In these cases one also needs to ensure that none of the actions that are waiting on `continue` will hang forever when the underlying electron and therefore the IPC has shut down and will never emit said event. My proposed solution is to:
1. Return from continue immediately after an abnormal shutdown of electron
2. Set a `failed` state on the instance of nightmare such that failure can be detected
3. Clean up global resources (aka global event listeners in this case)

So coming back to `_evaluate` @Namek: one thing that just occurred to me is that the `_evaluate` function you point to could possibly wait for `javascript` indefinitely if the electron process crashes while handling the inbound `javascript` event. I'd have to review the code again to be sure, though.

In any case, as far as I can see there seem to be no more implications other than the aforementioned leading to the behavior described; but I haven't really had the time to dig any further, which is why I was looking for more input on the branch.

Btw: The `wait(100).wait(100)` problem might very well be another issue that possibly can be fixed with #320 

As a general note: It does seem a bit unsafe to use `once` on the IPC as a control flow structure without handling exceptional cases...
",fr-,Namek
282,2016-02-06 15:32:50,"Still getting this using the latest version. `Emitter.defaultMaxListeners = 0;` in the ipc.js as recommended by @EmiPhil is the only way I could get these errors to stop, even using the latest version. `process.setMaxListeners(0);` did not work. I'm on win 10, node v5.5
",Crazometer,EmiPhil
280,2015-10-11 17:50:21,"@danhalliday , thanks!

Let's mention in docs?
",kuraga,danhalliday
278,2016-04-03 01:23:28,"@jney Is this still an issue?
",rosshinkley,jney
275,2015-10-10 15:53:00,"+1
@riston , any news?
@segmentio , can you help us, please?
",kuraga,riston
275,2015-10-11 18:49:22,"@kuraga did you get the example working, I switched to your suggested `mocha-generators` library which seems to at least output errors. I am not sure why spawning an electron process fails ?


",riston,kuraga
275,2016-07-08 17:19:42,"@nhducit Memory serving, the default Mocha timeout is something like 2s.  The test suite sets this to [10s](https://github.com/segmentio/nightmare/blob/master/test/mocha.opts#L2).

It might be more helpful to put an example mocha command to run with the test options.  Thoughts?
",rosshinkley,nhducit
274,2016-03-30 02:54:22,"@fritx Could you use [`.insert()`](https://github.com/segmentio/nightmare#insertselector-text) instead?  That sends text directly to the specified selector.
",rosshinkley,fritx
274,2016-03-30 03:39:28,"Hey, @rosshinkley, i'm afraid not.
I need to somehow trigger the inputbox to react the action.
""Insert"" does not trigger any event, but ""Paste"" does.
Paste can also bring images too (if copied).


",fritx,rosshinkley
274,2016-04-08 17:09:45,"@fritx Are you thinking of something like [`webContents.paste()`](https://github.com/electron/electron/blob/master/docs/api/web-contents.md#webcontentspaste)?
",rosshinkley,fritx
267,2015-10-05 16:44:34,"@jppope To get an older version back you can do `npm remove nightmare` and then `npm install nightmare@2.0.5 --save`. Replace `2.0.5` with your desired version.

I also had an error like this when using the old syntax with v2, maybe that's the problem.
",FdezRomero,jppope
267,2015-10-13 03:51:10,"I think I figured it out. Looking at this line:
https://github.com/segmentio/nightmare/blob/master/lib/nightmare.js#L162

It looks like the `run` method is expecting a callback, and if you don't pass one in it seems to be causing the error above.

Changing to this fixed it for me, alternatively you should probably pass in a done function from a testing framework for instance, I bet thats the intention with this.



Should I open a pull request to at least throw a more helpful error here? Other people might get tripped up by copying/pasting examples online like I did.. :P (Example: http://weblogs.asp.net/mikaelsoderstrom/writing-end-to-end-tests-with-nightmare-js, a top result for using nightmare for testing)

Hope that fixes it for you @jppope!
",tscanlin,jppope
262,2015-10-01 16:52:12,"Hi @toppetoppe, I was having some issues with the loading of XHR/AJAX calls and using the option `show: true` when creating the Nightmare instance helped me debug, as you can see the window and how the page is loading with the console on the side.



Hope it helps, maybe you just need to wait longer.
",FdezRomero,toppetoppe
262,2015-10-13 14:44:24,"@toppetoppe This has nothing to do with Nightmare, but have you tried running the code directly in the Dev Tools console? Maybe there is another element matching your selector and `querySelector()` is returning only the first one in the DOM.
",FdezRomero,toppetoppe
262,2015-10-25 19:54:54,"@toppetoppe i modified your example slightly and ran it locally:



with the following output:


",reinpk,toppetoppe
256,2015-10-01 15:37:49,"@matthewmueller Sure thing. In the following example, the `debug` message is never shown (using thenables instead of generators):



In this other snippet, both `getTitle` and `.screenshot()` are never executed:



Hope it helps. I'm currently using version 2.0.5 because with 2.0.6 it doesn't even get passed the first `.evaluate()`.

I know you're all putting time and effort into this and I'm thankful, but the lack of documentation and consistency is making the experience to really be a nightmare...
",FdezRomero,matthewmueller
256,2015-10-01 18:26:07,"@FdezRomero – haha isn't nightmare a great name for a software library?

It would be helpful to specify and document the async interface for nightmare. Whether it is consumed by a generator function or some other pattern is outside the scope of nightmare.

Using a `.run` method seems like the simplest solution. You would end up with an API that looks like:



Which could then be consumed in a number of ways:



This would change the examples b/c you would need to end every method chain block with `.run`. Another option is to have every chainable method return a promise. This is how [petecoop/phantasma](https://github.com/petecoop/phantasma) works. The API is maybe prettier, but I think this adds unnecessary complexity. 
",nichoth,FdezRomero
256,2015-10-02 12:18:58,"Hi @matthewmueller,

I think I found the issue I was having with the undocumented use of `.then()`. I was chaining several actions like this (omitting the parameters for clarity):



And saw that the next action didn't hook up with the previous part of the chain. I think this is why the `.then()` after the `.screenshot()` didn't run. Please correct me if I'm wrong as I'm still trying to get the inner workings of Nightmare.
",FdezRomero,matthewmueller
251,2016-04-08 17:08:18,"@FdezRomero @CatTail @kazinov @tjokimie I cannot reproduce this problem.  Has this issue been resolved?
",rosshinkley,kazinov
251,2016-04-08 17:08:18,"@FdezRomero @CatTail @kazinov @tjokimie I cannot reproduce this problem.  Has this issue been resolved?
",rosshinkley,FdezRomero
251,2016-04-08 17:08:18,"@FdezRomero @CatTail @kazinov @tjokimie I cannot reproduce this problem.  Has this issue been resolved?
",rosshinkley,tjokimie
251,2016-04-08 17:08:18,"@FdezRomero @CatTail @kazinov @tjokimie I cannot reproduce this problem.  Has this issue been resolved?
",rosshinkley,CatTail
251,2017-03-10 20:19:02,"@deffwe If you have a minimum repro, post it and I'll reopen this issue to take a look.",rosshinkley,deffwe
250,2015-09-26 02:41:50,"@matthewmueller ok.
- No, forget the missing semicolon. ~~I meant it was I that had [missed a semicolon](https://github.com/segmentio/nightmare/pull/250/files#diff-9dcc65cc4a6c14eb4f81fbe4005301d0R41) in my PR commit, but just leave it ;)~~ (cleaned)
- Yes, with `node-integration` turned off:
  - Electron won't expose node stuff like `module/exports` to the web.
  - So we could correctly load any webpage with many scripts like jquery that depends on a `module/exports` detection.
  - Still, with a `preload` script we can inject anything with node access just like what we do, but only at the very beginning.
  - We have to do so. It's the only way to load normal webpages in electron correctly.
  - And this should get it loads even faster than before, without node integration which is unnecessary around the user webpage itself.
  - As a change, the `preload` script should be the only way that we write things in node to get nightmare page ready.
  - Most importantly, it fixes a **security** bug, as in `node-integration` a webpage can hack into the user system in javascript. eg `require('fs')`.
",fritx,matthewmueller
250,2015-09-26 03:11:42,"@matthewmueller once this problem solved, in #249 i'd suggest we replace `google.com` with `github.com`, and it'd get to work. ;) and my [project](https://github.com/fritx/wxbot) is gonna switch back to nightmare.
",fritx,matthewmueller
250,2015-09-26 05:08:55,"cool, thanks much! @matthewmueller 
",fritx,matthewmueller
249,2015-09-25 16:02:04,"@fritx  以后遇到问题可以交流交流！
",FredXue,fritx
248,2015-10-21 20:42:41,"@edasque you mean if something is happning inside .evaluate() ? there is a `.on('javascript')` callback for js-erros and you can start your script with `DEBUG=nightmare:log` to see the logs.

btw my pr was merged, so this can be closed https://github.com/segmentio/nightmare/pull/300
",antpaw,edasque
248,2015-10-21 21:55:11,"@antpaw are you sure it's DEBUG=nightmare:log ? This does nothing here. Is it just the normal DEBUG=nightmare ?
",edasque,antpaw
247,2015-09-25 16:49:39,"related #242
@Nisthar now you can try with the new version just released
",fritx,Nisthar
242,2015-09-24 21:24:26,"@matthewmueller Thanks for the hint. I've tried to listen to `error` event on `nightmare` on an example very similar to @antpaw's one, but with no luck (didn't see any errors). I was expecting something like `$ is not defined`.
",mpangrazzi,matthewmueller
242,2015-09-24 21:24:26,"@matthewmueller Thanks for the hint. I've tried to listen to `error` event on `nightmare` on an example very similar to @antpaw's one, but with no luck (didn't see any errors). I was expecting something like `$ is not defined`.
",mpangrazzi,antpaw
242,2015-09-25 14:27:28,"@matthewmueller I've created this issue with a testcase #248 please help me :)
",antpaw,matthewmueller
238,2016-04-14 04:01:21,"@ndamjan Are you still experiencing this problem with more recent versions of Nightmare?
",rosshinkley,ndamjan
238,2016-07-12 20:51:34,"@rosshinkley I have this problem with the latest version installed today. Interestingly enough, this happens on an Ubuntu box and a Mac, but on Windows, it's fine. I've come to expect the opposite usually.
",catdad,rosshinkley
235,2016-01-26 15:48:25,"@rosshinkley True... Saw these issues too. :+1: 
",IonicaBizau,rosshinkley
231,2015-09-19 05:18:59,"@quicksilver7 we're seeing the same things, as in, mocha never run the tests. Could you please post the solutions you've found (a jsbin or similar would go a long way)
thank you
",TheSoftwareFarm,quicksilver7
231,2015-09-21 15:51:32,"@TheSoftwareFarm I created [a repository](https://github.com/quicksilver7/nightmarejs-examples). You can clone it an it should work fine. I tried explaining what I had to do to get it working there.
",quicksilver7,TheSoftwareFarm
231,2015-09-22 10:04:39,"thank you @quicksilver7 
",TheSoftwareFarm,quicksilver7
224,2015-09-19 00:15:35,"@richard5mith i'm not very familiar with `xvfb`, by `xvfb-run` do you mean the instructions i provided? or is there a simpler way?

I think it's starting a server (`Xvfb -ac -screen scrn 1280x2000x24 :9.0 &`), which is something I'd like to avoid. or at least have a good way to clean up after we quit.
",matthewmueller,richard5mith
224,2015-09-19 23:30:37,"@richard5mith thanks for that, runs for me now on my build server!
",pastawoua,richard5mith
224,2015-09-20 12:55:51,"@matthewmueller that might help:
https://github.com/shippableImages/minBase/blob/master/ubu1204/01base/containerSetup.sh
https://github.com/shippableImages/minBase/blob/master/ubu1204/01base/xvfb.sh

Using the shippable container to run nightmare and mocha.
",pastawoua,matthewmueller
224,2015-09-21 05:56:47,"@matthewmueller I've narrowed it down to `apt-get update && apt-get install -y xvfb x11-xkb-utils xfonts-100dpi xfonts-75dpi xfonts-scalable xfonts-cyrillic x11-apps clang libdbus-1-dev libgtk2.0-dev libnotify-dev libgnome-keyring-dev libgconf2-dev libasound2-dev libcap-dev libcups2-dev libxtst-dev libxss1 libnss3-dev gcc-multilib g++-multilib`

Hope that helps!
",pastawoua,matthewmueller
224,2015-09-30 05:34:11,"@matthewmueller https://github.com/Rob--W/node-xvfb might be of use for controlling the xvfb server.
",notsentient,matthewmueller
224,2015-09-30 11:53:14,"@notsentient Jabin, Simply Wall St looks outstanding.  Good find on the xvfb module.
",dylanvalade,notsentient
224,2015-10-14 10:39:40,"same issue there.
@dylanvalade did you find out how to make it work ?
",jney,dylanvalade
224,2015-10-14 13:22:50,"@jney Unfortunately, I had to change my plan. Using Phantom now and this explains the setup.
http://stackoverflow.com/questions/22116673/cannot-find-module-phantomjs-in-heroku/32853675#32853675

After this Linux issue gets sorted out I would much rather use Nightmare.
",dylanvalade,jney
224,2015-12-04 18:47:01,"@deinwort which version of CentOS and NodeJS are you using ?
",younes200,deinwort
224,2015-12-10 15:13:56,"For those not familiar with Docker, here is the step by step once you've installed it (it needs a 64 bit modern distro & kernel).

In the nightmare source directory (from this repo), create a file named Dockerfile which has the content at the bottom of this post (@matthewmueller I had to make some edits, including  replacing `FROM node:5` with `FROM node:4.2` for version pinning since 5.x is not LTS) then run:

`docker build -t nightmare-test .`

This takes a little while. Then:

`docker run nightmare-test`

expected result is:



My Dockerfile is:



My index.js for the CNN example (in the root project folder is:



@matthewmueller, if you want me to do a PR with the docker file, an example directory and documentation, let me know.
",edasque,matthewmueller
224,2015-12-10 16:06:41,"@edasque thanks for the detailed instructions! the command i'm just trying to get working is this:



or 



with `xvfb-run --server-args=""-screen 0 1024x768x24""` being an `ENTRYPOINT`

---

_edit:_ though come to think of it, the dockerfile you provided is deployable to heroku/dokku on it's own. just looking for a couple ways to make this as easy to use as possible.
",matthewmueller,edasque
224,2015-12-22 16:12:51,"I have had no problem here. Have you tried the Docker approach @sriducati?
",edasque,sriducati
224,2015-12-22 16:15:17,"@edasque thats the only step left bcos iam new to docker...  I tried almost all steps.. trust me,each and every dependencies i fixed for electron,scanned whole internet to fix this issue... spent 2-3 days.. but still not working...
",sriducati,edasque
224,2015-12-22 16:26:21,"@matthewmueller I am sorry if my comment was offencive .I was very happy with nightmare when working on windows but suddenly all my app stopped working without any error messages... its really very hard...just don't know what to do now...
",sriducati,matthewmueller
224,2015-12-22 16:28:26,"@sriducati did you try using DEBUG=nightmare ? I think there might be a way to alter the verbosity but I can't recall.
",edasque,sriducati
224,2015-12-22 16:31:02,"@edasque  ya i tried debug mode below is the result...

  [root@server ~]# DEBUG=nightmare node --harmony cnn.js
  nightmare queueing action ""goto"" for http://cnn.com +0ms
  nightmare queueing action ""evaluate"" +21ms
  nightmare running +3ms
",sriducati,edasque
224,2015-12-22 16:31:47,"@sriducati  `nightmare` is base on [electron](http://electron.atom.io/) which doesn't have a good support on linux speciality with headlessly window. Best way to debug this on linux is to run first electron :
`./node_modules/nightmare/node_modules/electron-prebuilt/dist/electron` In most case, it's a dep/library missing. 
Docker solution may be a the best way for now.
",younes200,sriducati
224,2015-12-22 16:33:37,"@younes200 thank you, tried your method as well...result is empty ... again the same prob when we try to run nightmare.. no errors.. no output  :(
",sriducati,younes200
224,2015-12-24 11:11:38,"@sriducati could you please post your results here to help others too ;)
",younes200,sriducati
224,2015-12-24 12:49:23,"@matthewmueller , @edasque , @younes200  Thank you all...After changing many operating sys versions... found simple fix Ubuntu 12.04 64-bit ;) 



Its running on OpenVz VPS , No docker used... It would be great if anyone could replay to  https://github.com/segmentio/nightmare/issues/411 ,  I can write a complete help guide to install in VPS ... 
",sriducati,matthewmueller
224,2015-12-24 12:49:23,"@matthewmueller , @edasque , @younes200  Thank you all...After changing many operating sys versions... found simple fix Ubuntu 12.04 64-bit ;) 



Its running on OpenVz VPS , No docker used... It would be great if anyone could replay to  https://github.com/segmentio/nightmare/issues/411 ,  I can write a complete help guide to install in VPS ... 
",sriducati,edasque
224,2015-12-24 12:49:23,"@matthewmueller , @edasque , @younes200  Thank you all...After changing many operating sys versions... found simple fix Ubuntu 12.04 64-bit ;) 



Its running on OpenVz VPS , No docker used... It would be great if anyone could replay to  https://github.com/segmentio/nightmare/issues/411 ,  I can write a complete help guide to install in VPS ... 
",sriducati,younes200
224,2016-01-06 04:57:02,"@matthewmueller 
Why not put the solution/workaround in README ?
",scarletsky,matthewmueller
224,2016-03-07 10:17:51,"I have the same problem as @huemans, I couldn't make PM2, xvfb and Nightmare play well together.

Any ideas?
",FdezRomero,huemans
224,2016-03-18 11:45:40,"@huemans @FdezRomero did you solve that problem? I'm trying to run my nightmare app with PM2 but I can't make it work.
",gabrielperales,FdezRomero
224,2016-03-18 11:45:40,"@huemans @FdezRomero did you solve that problem? I'm trying to run my nightmare app with PM2 but I can't make it work.
",gabrielperales,huemans
224,2016-03-18 12:00:18,"@gabrielperales No, I haven't found a solution yet. The next thing I was planning to try is the [Headless](https://www.npmjs.com/package/headless) module, a wrapper for Xvfb directly from Node. But I don't know if it will play well with Nightmare. Let me know if you try it! 
",FdezRomero,gabrielperales
224,2016-03-18 12:33:55,"@FdezRomero Thank you for your answer. I have tried headless module... but it doesn't seems to work. I'll keep trying
",gabrielperales,FdezRomero
224,2016-03-18 14:46:14,"@FdezRomero @huemans I could do it with this module [node-xvfb](https://github.com/Rob--W/node-xvfb). I have done a test example [here](https://github.com/gabrielperales/nightmareHeadlessTest/blob/master/index.js) .
",gabrielperales,FdezRomero
224,2016-03-18 14:46:14,"@FdezRomero @huemans I could do it with this module [node-xvfb](https://github.com/Rob--W/node-xvfb). I have done a test example [here](https://github.com/gabrielperales/nightmareHeadlessTest/blob/master/index.js) .
",gabrielperales,huemans
224,2016-03-18 14:55:25,"I've got nightmare working in headless mode with code similar to the example from @gabrielperales. However, I do not think the code will work with pm2 (atleast I wasn't able to
",SantoshSrinivas79,gabrielperales
224,2016-03-18 17:08:34,"@SantoshSrinivas79 I have tried my code once... and I think it worked, I'll try it again later to be sure
",gabrielperales,SantoshSrinivas79
224,2016-03-23 10:15:15,"@gabrielperales - works perfectly, thank you!
",sagistrauss,gabrielperales
224,2016-03-28 07:25:39,"@benogle Unfortunately I don't think anyone have made it work on heroku. I tried a lot, but never did make it work. Now I follow this issue to see if anyone does i the future. Maybe when Chromium gets better at running headless.
",freeall,benogle
224,2016-05-16 17:34:34,"hey @benschwarz , how did you make it work with heroku? which dyno size were you using? mine is crashing after a certain (very small) amount of actions queued? I think I'm running into the whole heroku /dev/shm being too small (5 mb in heroku I believe, which is useless).
Also, I'm getting  electron:stderr Xlib:  extension ""RANDR"" missing on display "":99""., not sure if relevant...
",rickmed,benschwarz
224,2016-05-16 18:27:45,"@rickmed I found it to be pretty unstable too (admittedly, on the 512m dyno), I decided to use phantomjs instead. I'd love to have used electron and nightmare, but instead I shipped phantomjs and had no issues since. I'm sure there is a simple reason that this is happening on heroku environments, but I just didn't have the time to spend on it. 
",benschwarz,rickmed
224,2016-06-06 17:00:44,"This is not a nightmare issue but an electron (chromium really) issue. @rosshinkley maybe this should be closed? 

@hhsadiq I'll try to help you via stackoverflow.

EDITED: for anyone interested in the answer: http://stackoverflow.com/questions/37625327/how-to-run-nightmare-js-on-google-appengine-for-node-js/37663861#37663861
",rickmed,hhsadiq
224,2016-06-07 23:57:54,"@rickmed I was planning on closing it with the resolution of #502 (where Nightmare would take care of the framebuffer for you, at least until Chromium's headless features trickle into Electron), but the details of that have proven much more difficult than I had anticipated.  It's not even as simple as ""just use Xvfb"" as [_sometimes_ this causes Chromium to hang](https://github.com/segmentio/nightmare/issues/561).
",rosshinkley,rickmed
224,2016-08-12 00:49:57,"@huemans, @FdezRomero, @gabrielperales, @SantoshSrinivas79 . To get nightmare working headlessly with pm2, you just need to wrap your mind around what Xvfb does, what xvfb-run does, how they interact with your node process, and how this interaction is facilitated.

Going to give you an idea of the basics and then tell you how to get this all going in pm2. Forgive me if I am oversimplifying things:
- Xvfb is a frame buffer which allows us to mock a desktop interface where, in this case, the electron browser can run.
- Xvfb sets a display number (the initial default is ""99""). The application using the desktop must have an idea of this display number to use the frame buffer.
- xvfb-run (which is a shell script) is perfect for single process node applications as what it actually does (as far as I understand) is setup the Xvfb process, set the ""DISPLAY"" environment variable to "":99"", and then spawn the process you specify with access to the environment variable so it can access the display.
- For PM2 to manage processes happily it must spawn all the processes that it controls. I think this is where xvfb-run falls apart with pm2. It creates processes that need to be controlled and then exits and pm2 doesn't like this.
- Instead what we can do is spawn two processes simultaneously (do what xvfb-run does essentially): one being Xvfb and the other being a process for your application, setting the display number and ""DISPLAY"" environment variable explicitly.
- The best way to spawn the two processes is to create a PM2 Process file json as explained [here](http://pm2.keymetrics.io/docs/usage/application-declaration/) in pm2 docs, and then use the pm2 start command.

This is what your process file would look like, substituting for your specific case:



If you place this process file in the same directory as `<your_main.js>`, and feed the process file to  pm2, you're all set. Assuming we call the file `process.json` then you would execute this pm2 command to get the two processes started:



Tested and working on Debian 8.
",mashaalmemon,gabrielperales
224,2016-08-12 00:49:57,"@huemans, @FdezRomero, @gabrielperales, @SantoshSrinivas79 . To get nightmare working headlessly with pm2, you just need to wrap your mind around what Xvfb does, what xvfb-run does, how they interact with your node process, and how this interaction is facilitated.

Going to give you an idea of the basics and then tell you how to get this all going in pm2. Forgive me if I am oversimplifying things:
- Xvfb is a frame buffer which allows us to mock a desktop interface where, in this case, the electron browser can run.
- Xvfb sets a display number (the initial default is ""99""). The application using the desktop must have an idea of this display number to use the frame buffer.
- xvfb-run (which is a shell script) is perfect for single process node applications as what it actually does (as far as I understand) is setup the Xvfb process, set the ""DISPLAY"" environment variable to "":99"", and then spawn the process you specify with access to the environment variable so it can access the display.
- For PM2 to manage processes happily it must spawn all the processes that it controls. I think this is where xvfb-run falls apart with pm2. It creates processes that need to be controlled and then exits and pm2 doesn't like this.
- Instead what we can do is spawn two processes simultaneously (do what xvfb-run does essentially): one being Xvfb and the other being a process for your application, setting the display number and ""DISPLAY"" environment variable explicitly.
- The best way to spawn the two processes is to create a PM2 Process file json as explained [here](http://pm2.keymetrics.io/docs/usage/application-declaration/) in pm2 docs, and then use the pm2 start command.

This is what your process file would look like, substituting for your specific case:



If you place this process file in the same directory as `<your_main.js>`, and feed the process file to  pm2, you're all set. Assuming we call the file `process.json` then you would execute this pm2 command to get the two processes started:



Tested and working on Debian 8.
",mashaalmemon,FdezRomero
224,2016-08-12 00:49:57,"@huemans, @FdezRomero, @gabrielperales, @SantoshSrinivas79 . To get nightmare working headlessly with pm2, you just need to wrap your mind around what Xvfb does, what xvfb-run does, how they interact with your node process, and how this interaction is facilitated.

Going to give you an idea of the basics and then tell you how to get this all going in pm2. Forgive me if I am oversimplifying things:
- Xvfb is a frame buffer which allows us to mock a desktop interface where, in this case, the electron browser can run.
- Xvfb sets a display number (the initial default is ""99""). The application using the desktop must have an idea of this display number to use the frame buffer.
- xvfb-run (which is a shell script) is perfect for single process node applications as what it actually does (as far as I understand) is setup the Xvfb process, set the ""DISPLAY"" environment variable to "":99"", and then spawn the process you specify with access to the environment variable so it can access the display.
- For PM2 to manage processes happily it must spawn all the processes that it controls. I think this is where xvfb-run falls apart with pm2. It creates processes that need to be controlled and then exits and pm2 doesn't like this.
- Instead what we can do is spawn two processes simultaneously (do what xvfb-run does essentially): one being Xvfb and the other being a process for your application, setting the display number and ""DISPLAY"" environment variable explicitly.
- The best way to spawn the two processes is to create a PM2 Process file json as explained [here](http://pm2.keymetrics.io/docs/usage/application-declaration/) in pm2 docs, and then use the pm2 start command.

This is what your process file would look like, substituting for your specific case:



If you place this process file in the same directory as `<your_main.js>`, and feed the process file to  pm2, you're all set. Assuming we call the file `process.json` then you would execute this pm2 command to get the two processes started:



Tested and working on Debian 8.
",mashaalmemon,huemans
224,2016-08-12 00:49:57,"@huemans, @FdezRomero, @gabrielperales, @SantoshSrinivas79 . To get nightmare working headlessly with pm2, you just need to wrap your mind around what Xvfb does, what xvfb-run does, how they interact with your node process, and how this interaction is facilitated.

Going to give you an idea of the basics and then tell you how to get this all going in pm2. Forgive me if I am oversimplifying things:
- Xvfb is a frame buffer which allows us to mock a desktop interface where, in this case, the electron browser can run.
- Xvfb sets a display number (the initial default is ""99""). The application using the desktop must have an idea of this display number to use the frame buffer.
- xvfb-run (which is a shell script) is perfect for single process node applications as what it actually does (as far as I understand) is setup the Xvfb process, set the ""DISPLAY"" environment variable to "":99"", and then spawn the process you specify with access to the environment variable so it can access the display.
- For PM2 to manage processes happily it must spawn all the processes that it controls. I think this is where xvfb-run falls apart with pm2. It creates processes that need to be controlled and then exits and pm2 doesn't like this.
- Instead what we can do is spawn two processes simultaneously (do what xvfb-run does essentially): one being Xvfb and the other being a process for your application, setting the display number and ""DISPLAY"" environment variable explicitly.
- The best way to spawn the two processes is to create a PM2 Process file json as explained [here](http://pm2.keymetrics.io/docs/usage/application-declaration/) in pm2 docs, and then use the pm2 start command.

This is what your process file would look like, substituting for your specific case:



If you place this process file in the same directory as `<your_main.js>`, and feed the process file to  pm2, you're all set. Assuming we call the file `process.json` then you would execute this pm2 command to get the two processes started:



Tested and working on Debian 8.
",mashaalmemon,SantoshSrinivas79
223,2016-01-04 20:33:52,"@felixcrive the fix I referenced above should be fixed in electron 0.36.0 - does it work if you use the `electronPath` option with that newer electron?
",yoz,felixcrive
223,2016-01-05 14:34:09,"@yoz I doesn't work I have electron-prebuilt@0.36.2 and Nightmare@2.1.2 pointing to electronPath.
",felixcrive,yoz
222,2015-09-19 00:20:10,"@matthewmueller can this be merged in please?
",pastawoua,matthewmueller
222,2015-10-06 03:07:45,"@matthewmueller @reinpk is there an issue with the code, anything you want me to change, would be helpful to merge so I don't use my forked version in production.
",pastawoua,matthewmueller
222,2015-10-06 10:57:29,"@pastawoua at least the `input` or `change` event you dispatch is missing some properties like `keyCode`, etc? it's not certain, and it might probably make something broken
",fritx,pastawoua
222,2015-10-06 11:50:16,"@fritx keyCode is not fired on `input` or on `change` events.

fyi, casperjs implementation: https://github.com/n1k0/casperjs/blob/master/modules/clientutils.js#L899

similar code than on the `check` method, not as robust as #244 but an easy fix for now.
",pastawoua,fritx
222,2015-10-06 15:00:56,"@pastawoua wrote a nice solution that works for me. But if you want to follow the code style, then check this:  



So, focus() and blur() are unnecessary. At least while you're implementing the real cool things (sendKeys or simkey and a lot of more) please accept the pull request so we can use nightmare for testing. Thanks
",rianby64,pastawoua
222,2015-10-13 08:19:35,"@zerkalica I can confirm that `evaluate()` function works for Angular 2 forms as well.
",danhalliday,zerkalica
222,2015-10-13 08:42:18,"@zerkalica nice that info! Have you tried to type some text in a field? I know that $digest in Angular 1.4\* listens only events. So, the current version indeed types something but this is not enough. A change event should be fired. The solution given by @pastawoua is enough for me.
",rianby64,zerkalica
222,2015-10-13 08:42:18,"@zerkalica nice that info! Have you tried to type some text in a field? I know that $digest in Angular 1.4\* listens only events. So, the current version indeed types something but this is not enough. A change event should be fired. The solution given by @pastawoua is enough for me.
",rianby64,pastawoua
222,2015-10-13 08:49:21,"@zerkalica Yes, I have a full end-to-end test for my Angular 2 app working using Nightmare. I work around the digest/diffing by `wait()`ing for DOM elements. It works surprisingly well (much easier than setting up Protractor, and less tightly coupled to Angular, too). Eg:


",danhalliday,zerkalica
222,2015-10-13 09:00:17,"@danhalliday Thanks a lot! I hope this kind of workarounds will be temporary. Soon we'll be able to call type(...) and go ahead with the next step.
",rianby64,danhalliday
222,2015-10-13 09:07:08,"@zerkalica Cool!
",rianby64,zerkalica
220,2015-09-14 22:05:59,"![](https://cloudup.com/ciR3atmYpAp+)

:dancer: 

Amazing work on V2 @matthewmueller!
",sperand-io,matthewmueller
219,2015-09-26 22:45:12,"Hi, @idrakimuhamad.

It seems that we could achieve this using ""--ignore-certificate-errors"" switch, passing it through app.commandLine.appendSwitch in runner.js. I suggest new feature request in nightmare to provide such api for setting more advance options for electron. Associated electron issue: https://github.com/atom/electron/issues/1221

Also your example is a bit unclear – for me it looks like it wont compile.

Here is mine:



this is what i do



and this is the output (then it just got stuck).
OSX 10.10 / iojs v3.2.0 / nightmare v2.0.6.

---

Yup, just tried it. I've added the line `app.commandLine.appendSwitch('ignore-certificate-errors', 'true');` just right after imports in `runner.js` module. New output: 


",yura415,idrakimuhamad
219,2015-09-29 02:18:27,"Hey thanks @yura415 I'll try that out. My example of course, aren't complete. I've only showing the important part of the code, excluding the `module.exports` etc
",idrakimuhamad,yura415
218,2015-09-14 01:31:18,"Hi @matthewmueller thanks for the reply and for the example.  Ultimately, I would like to use the nightmare api to interface with new windows.

Regardless of whether this repo decides to support this, the fact is some websites may spawn new windows on their own. When this happens, the windows are shown (instead of running headless) which is not the desired effect...

Like you said, we may need to open an issue on the electron repo. Instead of monkey patching window.open we may need to monkey patch browser-window function so it defaults to `{show: false}`.
",bchr02,matthewmueller
209,2015-08-31 03:25:35,"awesome thanks @danielstjules! we're working on v2 #200 and will try to pull this in there as well to accelerate tests :)
",reinpk,danielstjules
207,2015-08-19 23:15:36,"@mattyhead I'm currently in PhantomJS 1.9.0. I've wanted to upgrade to 2.0 but haven't yet. 
And yes, I have been able to make selection with `.select`. You can play with it [here](https://ide.c9.io/shriek/nightmare).(had to scour the Internet to find classic dropdown) (just let me know your username and I'll give you access to write as well). Anyway, often times your selector might return an array of DOM objects when nightmare only expects one. I easily forget that part many times. Not sure if it's the same with you but just a note.
",shri3k,mattyhead
203,2015-08-11 16:48:41,"Where would this be added @rclai please?
",molinto,rclai
203,2015-09-08 01:16:19,"Thanks @rclai I've created a plugin from your code: https://www.npmjs.com/package/nightmare-iframe
",avioli,rclai
203,2016-08-04 14:18:25,"@RichardJECooke here's the summary.
- The first approach commented here doesn't work anymore with the latest versions. 
- I wrote the PR, it got rejected. 
- @rosshinkley used parts of that PR to create an improved version of the functionality as an external plug-in.

Right now, the best you can do is use @rosshinkley's https://github.com/rosshinkley/nightmare-iframe-manager. Go there and check his documentation. That's what I'm doing.

The Nightmare team (Segmentio) don't like the approach taken in the PR and the plug-in (not even Ross, the plug-in's writer). They dislike it so much that didn't wan to publish it to NPM, you have to install it from GitHub. Feel yourself hyper-warned. No warranties anywhere, use at your own risk, etc.

Given that, for non-mission critical problems (to emphasize the warnings) the plug-in works pretty good.

I use it to extract my credit card transactions in my bank's website.

---

Here's what you would do (excessively detailed):
- Create a directory for your project and enter it:


- Initiate your Node / Nightmare project with npm filling the package data:


- Install Ross's plug-in from the GitHub repo (`npm` does it automatically for you, but you probably need to have `git` installed):


- In your main project file, `require` Nightmare and the plug-in and pass the `Nightmare` object to the plug-in:


- And then you can use it. The plug-in extends Nightmare itself. So you have additional methods in your Nightmare instance. Follow the documentation:
  https://github.com/rosshinkley/nightmare-iframe-manager
",tiangolo,RichardJECooke
200,2015-08-15 05:33:27,"Just pushed up a branch for `v2`. I could use some help finishing up some of the remaining tasks:
- [x] port over the remaining actions
- [ ] add some examples
- [x] write some tests

Unfortunately, I cannot create a PR because the commit history is completely different. I could just write on top of all the old files though.

cc/ @reinpk @amillet89 
",matthewmueller,reinpk
200,2015-08-15 19:27:59,"awesome @matthewmueller just pushed some updates with a structure for testing based on the old tests, as well as circleci setup, and adding the `.back()` action... will push it a bit further this afternoon
",reinpk,matthewmueller
200,2015-08-17 01:20:03,"Nice work @reinpk! Can't wait to see this release in the wild.
",matthewmueller,reinpk
199,2015-08-17 06:14:26,"thanks @li-xinyang in v2 we're moving to electron and testing so far shows that it's significantly faster, see #200.
",reinpk,li-xinyang
198,2015-07-31 19:24:52,"@rclai are you sure? I don't think `use()` gets a chance to modify the nightmare task queue after `run()` has started.
@fpinzn I had the same issue. I monkey-patched [`Nightmare.prototype.run`](https://github.com/segmentio/nightmare/blob/master/lib/index.js#L59-L76) to take an additional suppressTeardown param and additionally to not call this.setup if this.page was defined.
",abe-winter,fpinzn
198,2015-07-31 19:24:52,"@rclai are you sure? I don't think `use()` gets a chance to modify the nightmare task queue after `run()` has started.
@fpinzn I had the same issue. I monkey-patched [`Nightmare.prototype.run`](https://github.com/segmentio/nightmare/blob/master/lib/index.js#L59-L76) to take an additional suppressTeardown param and additionally to not call this.setup if this.page was defined.
",abe-winter,rclai
198,2015-07-31 20:16:27,"@rclai It doesn't
@abe-winter I think that's pretty useful if you check there's an open pull request for exactly that https://github.com/segmentio/nightmare/pull/59 

The same guy that did the pull request created this https://github.com/johntitus/node-horseman which seems like a substantial improvement over nightmare.

At the end I just went the trivial way: no flow control login inside the nightmare instance.
",fpinzn,abe-winter
198,2015-07-31 20:16:27,"@rclai It doesn't
@abe-winter I think that's pretty useful if you check there's an open pull request for exactly that https://github.com/segmentio/nightmare/pull/59 

The same guy that did the pull request created this https://github.com/johntitus/node-horseman which seems like a substantial improvement over nightmare.

At the end I just went the trivial way: no flow control login inside the nightmare instance.
",fpinzn,rclai
198,2015-08-17 06:15:27,"@abe-winter @fpinzn in v2 we're moving to using generators and an explicit `.end()` method, which should bring the benefit of stronger flow control.
",reinpk,fpinzn
198,2015-08-17 06:15:27,"@abe-winter @fpinzn in v2 we're moving to using generators and an explicit `.end()` method, which should bring the benefit of stronger flow control.
",reinpk,abe-winter
184,2016-03-30 02:47:01,"@fritx @a7madgamal @luatnd Is this still an issue since the move to Electron?
",rosshinkley,luatnd
184,2016-03-30 02:47:01,"@fritx @a7madgamal @luatnd Is this still an issue since the move to Electron?
",rosshinkley,a7madgamal
184,2016-03-30 02:47:01,"@fritx @a7madgamal @luatnd Is this still an issue since the move to Electron?
",rosshinkley,fritx
182,2015-06-11 16:55:49,"@rclai Definitely! When the `wait` function times out, it emits a `timeout` event that can be handled using the [`Nightmare.on` method](https://github.com/segmentio/nightmare#onevent-callback).  All `.on()` calls must happen before the first `.goto()` so consider it more of a configuration step.

Here's a brief example using `on` to handle a `wait(selector)` timeout. Note the default timeout for `wait(selector)` can be configured in the [Nightmare options](https://github.com/segmentio/nightmare#new-nightmareoptions).


",maxshenfield,rclai
178,2016-04-08 14:05:21,"@lvyachao You could use [`.inject()`](https://github.com/segmentio/nightmare#injecttype-file) to add jQuery to a page and then use `.evaluate()` to execute DOM actions.  There's a [unit test](https://github.com/segmentio/nightmare/blob/master/test/index.js#L231-L247) that injects jQuery to get specific tags, as a reference.

You could even go a step further and use [`.action()`](https://github.com/segmentio/nightmare#extending-nightmare) to add custom commands to wrap the jQuery functionality you want.

I don't think including jQuery out of the box is in scope for Nightmare.  If you have any more questions, feel free to reopen or file a new issue.
",rosshinkley,lvyachao
177,2015-08-17 06:12:42,"thanks @Zirak! sorry for the delay... this pull request and others like it were influential in the work that @matthewmueller put into v2... which uses generators and an explicit `.end()` method. should solve the same problem in a slightly different way. thanks!
",reinpk,Zirak
176,2015-05-05 11:17:49,"@nylen Thanks for your feedback. After a couple of days I came up with a conclusion that this project is not actively maintained. FWIW we decided to switch to [navit](https://github.com/nodeca/navit) which is designed for testing right from the start.
",inca,nylen
175,2015-04-29 21:24:57,"@nylen Thanks! I've also included a [small test in PR](https://github.com/inca/nightmare/blob/56d3bb262d0a887f232c297ac587741c065a0c8a/test/index.js#L743) to illustrate a potential use case with `localStorage`, but it could really be anything.
",inca,nylen
171,2016-03-30 02:43:53,"@shri3k @rauchg Is this still an issue?
",rosshinkley,rauchg
171,2016-03-30 02:43:53,"@shri3k @rauchg Is this still an issue?
",rosshinkley,shri3k
171,2016-04-08 13:57:23,"Taking a closer look at this: `.wait(selector)` now will time out after some period of time.

@shri3k's example is problematic, at least with the Electron implementation: a single Nightmare instance wraps one Electron instance, meaning in general you should not try to do parallel operations on the same instance.  Those actions will enter into a race condition and (probably) behave poorly.

Due to the age of this issue and lack of response, and that there is a viable solution baked in, I'm going to close this issue.  If you have any more problems, feel free to reopen or file a new issue.
",rosshinkley,shri3k
163,2015-03-13 03:48:06,"@puzrin hey, I'll try out your suggestions this weekend. Thanks. 
",shri3k,puzrin
162,2015-03-12 04:02:06,"@petecoop, I'm not sure if there's a plugin for `NoScript` like `YSlow` for `phantomjs` but if OP can find that plugin then s/he should be able to load it just like [`YSlow`](http://yslow.org/phantomjs/)
",shri3k,petecoop
162,2015-03-14 06:10:12,"@petecoop, That's in fact quite possible in `nightmare`. Just did a quick test and seems to me that it's working. 

@MakoMakox, plug the following lines in `/lib/actions.js` and see if that helps. This is just a quick test to see if it's working and if everyone agrees with this, I or anyone can send a PR.



The usage of this would be:-


",shri3k,petecoop
162,2015-03-14 06:10:12,"@petecoop, That's in fact quite possible in `nightmare`. Just did a quick test and seems to me that it's working. 

@MakoMakox, plug the following lines in `/lib/actions.js` and see if that helps. This is just a quick test to see if it's working and if everyone agrees with this, I or anyone can send a PR.



The usage of this would be:-


",shri3k,MakoMakox
154,2015-03-23 11:54:09,"@reinpk  Thanks, i have setup default to what it is in production now.
",ravisuhag,reinpk
153,2015-08-17 06:07:18,"thanks @rrrene but the page seems a bit simplistic without restructuring our inline docs to match the way it picks up headers as methods. happy to reconsider down the road, but not a priority right now, sorry!
",reinpk,rrrene
151,2015-06-11 16:23:27,"@jfrumar How did you extract the cookie header information?
",rclai,jfrumar
151,2015-06-11 16:26:27,"@azurelogic how would you do the same thing you did but on a asp.net web form page where there are different submit buttons (and the entire page is a form, that's how asp.net pages are)? One of those submit buttons submits the form and serves you the file. What I'm trying to figure out is how to do the `XMLHttpRequest` but when that specific submit button was clicked.

**Edit**: Figured it out, when you click on a specific submit button, the `POST` body will have that button's `name`s in this format:



And the other buttons' names will be excluded from the `POST` body
",rclai,azurelogic
149,2015-08-17 06:36:31,"hey @serv unfortunately no idea here :/ if you have an example where we could repro that would be awesome though... ideally we can verify that the switch to electron in v2 eliminates the problem.
",reinpk,serv
148,2015-08-25 18:51:24,"@reinpk Can the feature to interact with new window be added to v2?
",bchr02,reinpk
148,2015-09-13 19:02:40,"@reinpk that's too bad. I was hoping for this feature to come now with v2 out. 

I wish I understood more on how you are using electron in place of phantomjs. Maybe then I would understand why you say that you don't think it's possible. 

Any chance you can explain at a high level how you are using electron? It's my understanding that electron is used to package applications... 
",bchr02,reinpk
148,2015-09-14 04:12:17,"@reinpk BrowserWindow.getAllWindows() returns an array of all the BrowserWindow object references. Surely this could be used to incorporate some sort of interaction with newly generated windows.

cc @matthewmueller
",bchr02,reinpk
142,2015-03-09 09:14:37,"For me, it was an app that would not register for the click events after registering for touch.  @RainerAtSpirit: If it really is the same issue, you could do one of the following:
1. Register for click events instead of touch on the application side or
2. Actually create touch events via nightmares JS injection into the browser or
3. Trigger the click hanlders programatically w/o true browser events

It appears you resorted to (3). The other approaches might feel less hacky for you, especially (1).

@johntitus Haven't tried 2.0 yet, I'll give it a shot. The above example was fixed in the original app for me though and now also works w/ 1.9.
",apfelfabrik,johntitus
142,2015-03-09 09:14:37,"For me, it was an app that would not register for the click events after registering for touch.  @RainerAtSpirit: If it really is the same issue, you could do one of the following:
1. Register for click events instead of touch on the application side or
2. Actually create touch events via nightmares JS injection into the browser or
3. Trigger the click hanlders programatically w/o true browser events

It appears you resorted to (3). The other approaches might feel less hacky for you, especially (1).

@johntitus Haven't tried 2.0 yet, I'll give it a shot. The above example was fixed in the original app for me though and now also works w/ 1.9.
",apfelfabrik,RainerAtSpirit
140,2015-01-26 00:39:46,"@reinpk it seems a little preemptive to not respond to a ticket for almost a month and then close it without giving the opener any chance to post sample code, just putting it out there. This is an old issue and I've since found an alternate solution so I don't have any sample code for you anymore, but I would have about a month ago =). Thanks for your work!
",zachfeldman,reinpk
135,2014-12-12 03:15:40,"@lambtron LGTM! Why is it failing though?
",stevenmiller888,lambtron
126,2014-12-08 18:07:01,"@Quentin01 while that may fix the immediate problem, it doesn't trigger the ""real"" UI event.
",imsky,Quentin01
126,2015-01-26 03:36:10,"@reinpk Gist available here: https://gist.github.com/kytwb/de153003ef2c211774b9
",kytwb,reinpk
126,2015-02-18 13:15:01,"More experiments:
- I experienced a very slow (> 20s) `type()` (and maybe `wait()`) on Linux as well with _any_ version of Phantomjs (tested 1.9.0, 1.9.2, 1.9.7, 1.9.8, 2.0.1-devel)
- I confirm that reverting back to nightmare 1.6.1 made the performance be acceptable again, and starting from 1.6.2 it starts to be slow as hell (which may confirm @Quentin01's bisect)

Fwiw here's the problematic part of a debug output, don't know if it can help:


",jbbarth,Quentin01
126,2015-02-25 09:14:25,"Going to use @jbbarth fork while waiting for a fix.
",kytwb,jbbarth
126,2015-02-26 04:05:02,"@johntitus That fixed it for me. Problem is shoe is a dependence of phantom so would require to fork nightmare, fork phantom, fork shoe, fix, then cascade reference all the patched forks in each package.json. Good find though!
",kytwb,johntitus
126,2015-04-03 20:54:33,":+1:  can confirm @johntitus's solution worked.
",nickmerwin,johntitus
126,2015-04-03 21:08:48,"@johntitus solution did work, but it stinks for us because I'd have to go in manually update all the node_modules on my production server...and then once they refresh with a `npm install` I'd have to do it again :frowning: 
",sean-hill,johntitus
123,2014-11-29 17:50:33,"hey @ybak i just tested your script locally and it executes for me in about 4 seconds... since i have two-factor auth enabled i end up on the two-factor auth code page, but it successfully passes the first step of the login process with my own credentials in about 4 seconds.

could you try running it as `DEBUG=* node test.js` so that we see more internal output? and then also add the timeout handler:



to get more visibility. 
",reinpk,ybak
123,2015-02-26 15:47:47,"I am experiencing the same issues on windows with the slowness. 

@johntitus I tried your suggestion at it worked! much faster now. Hopefully this can be addressed, so this wont be necessary, though.
",bchr02,johntitus
121,2014-11-29 04:03:41,"Hey @UnclaimedPants,

Thanks for contributing. Just out of curiosity, how did you plan to use `.post()` and Nightmare in general?
",lambtron,UnclaimedPants
121,2014-11-29 06:34:48,"@lambtron I use `.post()` to use the http post method, for example, when posting data to a server.

At the moment I'm using Nightmare for testing, and validating a web application (that requires posting data).
",UnclaimedPants,lambtron
121,2014-12-03 18:52:08,"@lambtron Further, I use it to submit forms, and also post data to web applications. Nightmare is great for integration testing, and also for testing the availability of applications, by scripting login tests, and feature testing.
",UnclaimedPants,lambtron
120,2015-03-23 03:47:42,"@reinpk Any news on this, or should we file an issue elsewhere? I've had my Nightmare version constrained for far too long, and there have been many updates in `node phantom` module. I'm also working to switch to PhantomJS 2.0.0 which surprising worked fine if I was on Nightmare 1.6.0 but upgraded old Nightmare package.json to 0.7.2 of https://github.com/sgentle/phantomjs-node. Even the simple Optimizely signin form fails (and this has no dynamic validation, only on form submit), as you can see the email and password get entered in the same input:

![screen shot 2015-03-22 at 11 49 50 pm](https://cloud.githubusercontent.com/assets/4656726/6773885/d36c2de8-d0ed-11e4-82c9-a121ef1972af.png)
",dtothefp,reinpk
120,2015-03-23 14:32:53,"@reinpk I've actually pinpointed the problem to this PR https://github.com/segmentio/nightmare/pull/100/files that switches the `type` action to implement the `sendEvent` Phantom method. I'm not sure if this is a problem with `phantomjs-node`'s implementation of `sendEvent` or a problem in PhantomJS itself, but for now would you consider reverting as it doesn't seem worthwhile to have such a small change potentially effecting users?

When I get some time later in the week I can put together some tests to pinpoint the problem more acuratelly and determine if I should submit an issue with `phantomjs-node` or PhantomJS

@rosslavery If you are still having this problem revert the `exports.type` method



You can pull this from my github if you'd like


",dtothefp,reinpk
120,2015-03-23 14:32:53,"@reinpk I've actually pinpointed the problem to this PR https://github.com/segmentio/nightmare/pull/100/files that switches the `type` action to implement the `sendEvent` Phantom method. I'm not sure if this is a problem with `phantomjs-node`'s implementation of `sendEvent` or a problem in PhantomJS itself, but for now would you consider reverting as it doesn't seem worthwhile to have such a small change potentially effecting users?

When I get some time later in the week I can put together some tests to pinpoint the problem more acuratelly and determine if I should submit an issue with `phantomjs-node` or PhantomJS

@rosslavery If you are still having this problem revert the `exports.type` method



You can pull this from my github if you'd like


",dtothefp,rosslavery
120,2015-05-27 14:51:29,"@reinpk do I need to contribute something to revert this change, or would you like to do it? I'm tired of pulling from a fork of Nightmare just because of this small issue
",dtothefp,reinpk
120,2015-06-26 18:00:43,"@reinpk addressed it here https://github.com/segmentio/nightmare/pull/195. Sorry ended up having a bit of a ""gitmare"" and screwed up a couple PR's which I had to close. Would be great to get this merged as soon as you have a change.
",dtothefp,reinpk
117,2014-11-26 19:23:50,"Hey @mickaelandrieu, I'm Andy and I'm helping maintain this library.

We built Nightmare with the intention of automating browser tasks, so we aim to keep the exposed methods simple and few. However, it appears that many people are using Nightmare for browser testing. We're considering building a nightmare-testing library that will do just that, while keeping this library simple and for building APIs and plugins.

Let us know what you think of a nightmare-testing library and if you'd like to contribute to it!
",lambtron,mickaelandrieu
117,2014-11-26 19:47:46,"Hi @lambtron,

I think we don't need to make another testing library (casperjs'one was a mistake from his creator opinion) but maybe we can work on how to ease the use of major testing libraries (mocha/chai/jasmine/jest) with nigthmarejs.

Then specials plugins/helpers dedicated to use cases like REST consuming/testing can be developped (and I will give a hand).

Like you, I don't want a big API but many useful middlewares: if nightmare offer same features as casperjs I think we wont release after the 1.1.x anymore /c @n1k0

What do you think ?
",mickaelandrieu,lambtron
117,2014-11-29 00:08:54,"Hey @mickaelandrieu,

Good points. There are many people using Nightmare for user testing and I think there can be more work done in making it easier for them to do so. Targeting the big testing libraries is a great start. Maybe we can spec out the interface of how users would use Nightmare with Mocha or Jasmine and work from there?

Agree to keep Nightmare simple with many useful middlewares that people can pick and choose. Eventually, I'd also like to see an ecosystem of plugins of automated browser tasks, such as https://github.com/segmentio/nightmare-swiftly
",lambtron,mickaelandrieu
114,2015-10-09 15:11:32,"Thanks @reinpk :+1: 
",brunowego,reinpk
109,2014-12-10 05:51:52,"@reinpk @sperand-io ?
",kytwb,reinpk
109,2014-12-10 05:51:52,"@reinpk @sperand-io ?
",kytwb,sperand-io
107,2014-11-10 11:08:08,"Hey! 

I needed this too, so I just forked it and built it. I'm planning to create pull request but am still figuring out how to test the `clipRect` method in my spare time. 

If you want to build it yourself, @reinpk, you may find this helpful: https://github.com/bahlo/nightmare/compare/zoom-factor
",bahlo,reinpk
107,2014-11-11 09:41:56,"@johntitus The thing is, that we may need to crop again after zooming. So we'd need at least an own option (maybe both?)

As I said, my fork is almost done. I just need to test the `clipRect` method.
",bahlo,johntitus
107,2014-11-11 13:33:45,"@bahlo I don't see what's the problem with testing the clipRect method.
use .getBoundingClientRect() to get the rect options from an dom element.
ex: document.querySelector('selector').getBoundingClientRect() .

Or maybe I didn't understood correctly why you can't finish your fork.
Let me know. Thanks.
",MakoMakox,bahlo
107,2014-11-11 14:09:37,"@bahlo Oh great can't wait to use it xoxo. Sorry if I sounded rude and for my impatience . 
",MakoMakox,bahlo
104,2014-11-10 00:18:17,"Thanks @reinpk.  You da boss! :thumbsup:
",gwintrob,reinpk
104,2014-11-11 06:44:40,"fixed that test is passing now :) thanks @pdelanauze shipped with nightmare@1.6.5
",reinpk,pdelanauze
102,2014-11-15 22:37:28,"@reinpk sorry for the delay.  Here is an example repo.  It actually doesn't demonstrate this behavior because something you have merged in recently has fixed the problem:

https://github.com/dtothefp/nightmare-timeout-test-example/tree/master

If you switch to an older version of Nightmare you will see the behavior I'm talking about:

If you previously ran `npm i` be sure to 



https://github.com/dtothefp/nightmare-timeout-test-example/tree/dfoxpowell/nightmare-v1.6.0

This is also referenced here:
https://github.com/segmentio/nightmare/issues/120
",dtothefp,reinpk
101,2014-11-05 01:18:41,"@kevva you know what the problem is, when I installed Nightmare, my version of node-phantom was 0.6.6.  Therefore, that line with path isn't in my version, must be a new update.  Think it has to do with Nightmare's package.json having a tilde instead of a carrot, so if we want this PR to work for all users either we should send a PR fixing the package.json or merge this PR http://stackoverflow.com/questions/22343224/difference-between-tilde-and-caret-in-package-json

![screen shot 2014-11-04 at 8 17 14 pm](https://cloud.githubusercontent.com/assets/4656726/4911150/677c2fdc-6489-11e4-9d1b-60aa56fa4929.png)
",dtothefp,kevva
99,2014-11-11 17:01:18,"@reinpk I don't think that wikipedia has transparent or `visibility: hidden;` elements on the page, so I'm not sure how to test these cases. Also, yahoo supports i18n, so when I go to yahoo from Canada I get 'Yahoo Canada' in the title, and because of that some tests fail. 
It would be nice to have less 'real-world' testing environment. Some local page would work. It would also speed up testing (it takes forever with my current internet connection).
",Hermanya,reinpk
84,2015-08-17 06:11:14,"thanks @Max93! sorry i never got to this with v1... it looks like an interesting abstraction for other events... what events were you interested in? closing for now but may bring the idea into v2 with more info here. thanks!
",reinpk,Max93
82,2014-11-02 00:41:26,"@leesei added :)
",reinpk,leesei
76,2014-10-22 08:17:43,"@fbm-static It is inconvenient when we must pass similar arguments to different engines.
",execmd,fbm-static
76,2014-10-22 08:39:46,"@execmd Right.
",fbm-static,execmd
76,2014-10-22 14:39:54,"@fbm-static that wouldn't be a good abstraction though, that just reveals all the underlying complexity

@johntitus that sounds reasonable, updated with both of those added
",reinpk,fbm-static
76,2014-10-22 14:39:54,"@fbm-static that wouldn't be a good abstraction though, that just reveals all the underlying complexity

@johntitus that sounds reasonable, updated with both of those added
",reinpk,johntitus
62,2014-10-22 04:31:29,"@reinpk what exactly do you want to happen. I think they look better that way.
",fbm-static,reinpk
62,2014-10-22 06:09:06,"@reinpk options and arguments have different purposes. Each arguments element must be passed as string to the phantomjs, but options - as whole object. 
",execmd,reinpk
60,2014-11-12 11:04:14,"@ryanmcdermott this is just ""wrong"".
CasperJS is the first and the _only_ testing tool that supports both phantomJS and SlimerJS, and TrifleJS has been developped using the CasperJS testsuite.

So, at this point this is a missing feature of nightmareJS that is already implemented in CasperJS ;)

Then, :+1: nightmareJS is a very promising project !
",mickaelandrieu,ryanmcdermott
55,2014-10-15 18:28:42,"@johntitus thanks for clearing that up. That's what I thought. I copied that from the example, and I couldn't figure out why ""page"" is being passed into that first function.
",lumberj,johntitus
54,2014-10-20 06:02:22,"thanks @securingsincity and @fearphage 
",reinpk,securingsincity
50,2014-10-22 05:53:35,"`phantom-node` seems only offer `phantom.addCookie: (name, value, domain, cb=->)` , not `page.addCookie`
1. maybe had to modify `index.js` to set `this.ph=instance`
2. `self.ph.addCookie('test', 'testValue', cookies[0].domain, callback)` seems need `async` to iterator

so wait for @reinpk  ~
",atian25,reinpk
47,2014-10-14 16:57:13,"@johntitus if I run `make test` at the directory-- I get a response from my GNU make:
`make: *** No rule to make target 'test'.  Stop.`
I believe I need a Makefile, but again: what command should it run?
",bfagundez,johntitus
42,2014-10-15 06:07:27,"@reinpk What's the outlook on supporting PhantomJS 2.0.0?  Do you have any idea how much effort would be involved, and how much the Phantom devs have actually been changing the interfaces?  1.9.7 does a pretty terrible job of rendering interactive D3.js, and my attempts at bridging the gap in my app between what D3 wants and what 1.9.7 supports haven't worked out so far.  So far interactive D3.js looks great in PhantomJS 2.0.0.
",bprodoehl,reinpk
42,2014-10-20 13:01:00,"@mariodu The problem lies in a package that nightmare depends on.  I have created a ticket under that project here: https://github.com/sgentle/phantomjs-node/issues/208

@fernandopasik are you sure the problem isn't in your code?  I'm not finding ""x.options"" anywhere in nightmare or phantomjs-node.
",bprodoehl,fernandopasik
42,2014-10-20 13:01:00,"@mariodu The problem lies in a package that nightmare depends on.  I have created a ticket under that project here: https://github.com/sgentle/phantomjs-node/issues/208

@fernandopasik are you sure the problem isn't in your code?  I'm not finding ""x.options"" anywhere in nightmare or phantomjs-node.
",bprodoehl,mariodu
42,2015-03-23 03:11:54,"I've forked [Node PhantomJS](https://github.com/Medium/phantomjs) and hacked around with it to install the only ""stable"" version for Mac of Phantom 2.0.0 I could find:

Version I'm using: https://github.com/eugene1g/phantomjs/releases/download/2.0.0-bin/phantomjs-2.0.0-macosx.zip
Fork: https://github.com/dtothefp/phantomjs

So, you could just `require` the binary path



@bprodoehl it looks like you have shimmed the `phantomjs-node` package and the binary works fine with it. I just tried using the binary with Nightmare and it seems to work fine.

Also, I saw in your PR that the previous `phantom.args` are defined on `system.args`. Is this the syntax moving forward with PhantomJS 2.0.0?
",dtothefp,bprodoehl
36,2015-03-08 10:00:50,"Thanks @jfrumar, will do! I've created a [v1.0 milestone](https://github.com/petecoop/phantasma/milestones/v1.0.0) with the issues I aim to complete before going 1.0
",petecoop,jfrumar
36,2015-03-12 00:29:26,"Hey @jfrumar, I've just released v1.0 as I've met my original goals - check it out https://github.com/petecoop/phantasma

Open an issue if you've got any feedback 
",petecoop,jfrumar
35,2014-10-20 10:35:59,"Actually using PhantomJS is the better solution for webscraping since merely parsing the HTML returned by the server won't work but for the most simple web applications. You want the JS to run and to contribute to building the page. There are many web applications you cannot web scrape without such a solution. I have been using CasperJS to do just that before finding Nightmare (all my code is still in CasperJS at this time). @jwmarshall, I wouldn't call the following a complete web scraping example but it does run a function in phantomJS, accessing jQuery on the page and returning the results for the server side to process: https://gist.github.com/edasque/df1a8f48f3e0528ae3f8
",edasque,jwmarshall
34,2014-10-13 01:00:54,"this is looking sweet other than a few nits. could you rebase and squash the commits as well? thanks @johntitus!
",reinpk,johntitus
34,2014-10-15 07:21:15,"thanks @johntitus!
",reinpk,johntitus
15,2014-05-11 00:46:44,"thanks @queckezz! good idea here, going to eliminate the `done` parameter and just internalize that into the `.use()` method.
",reinpk,queckezz
4,2014-04-07 16:44:14,"thanks @queckezz! just noticed that while i made the changes yesterday i forgot to push (also added `.agent()`) i'll close now that i've pushed/published.
",reinpk,queckezz
1044,2017-03-14 19:56:16,"So, I know why it actually doesn't fire one after the other but I can't find how to make it work this way :L
 
I would like to: 
- get data from the page (evaluate)
- do some calculations (with external node libs)
- act on the the scroll for ex (window.scrollTo()) // I know this feature exists, just an example

I've seen many examples from @rosshinkley, read the source code and also read a lot of issues but I'm still missing something.



And the call :



The behavior with the code above is the following:
- go to duckduckgo.com
- wait 2000ms
- fire the first test()
- display scrollHeight
- fire the second test()
- display scrollHeight
- display ""It worked. Maybe"" fomr the then()

If you're able to take a little bit of time to give me some clues, it would be amazing ;)",gahabeen,rosshinkley
1044,2017-03-16 16:45:59,"Ok so, after some long hours of frustration and a couple of days, I just needed a couple of words from @rosshinkley to see what was wrong with my code.

Let me explain how to extend Nightmare's features using co generator and even directly through Nightmare.prototypes.

Standard way, using **nighmare.action(actionName, fn [, fn])**


Seems pretty neat and simple and it is - when you finally get out it works. As Nightmare is then-abled, it simply needs to get returned the **co promise**. And to specify that your action is done, simply call **done()** (and remember to add it to your arguments, at the end).

Now, if you're like me and want to extend Nightmare by inheritance, you might want to includes new methods right into the class. To do so, it's actually pretty similar than previously. We actually do manually what the **Nightmare.action()** method does => queue our action when called.



To do so, I simply **created an action() function** inside my method with the script and then add it to the queue and **return Nightmare** via **this**.

Oh well, this looks so easy once you get it :2

Hope this helps you!",gahabeen,rosshinkley
965,2017-03-02 06:51:37,"@novoxudonoser See issue ""Multiple processes: windows open and hang"" #1021 & @louisscruz Project [hub-crawl](https://github.com/louisscruz/hub-crawl)

",LeMoussel,louisscruz
964,2017-01-20 20:04:32,"This is (kind of) by design - using `highlightRect` as opposed to touching the DOM directly solves a _lot_ more problems than it creates (see #927 and the issues referenced there).

I wonder if the `HIGHLIGHT_STYLE` could be determined at runtime to mimic the top left pixel, or if this is a case where the highlighted pixel isn't fully rendered at screenshot time?  Might be worth some experimentation.

/cc @Mr0grog, as he is way closer to this than I am, and might have more ideas.",rosshinkley,Mr0grog
959,2017-03-27 03:39:41,"**IMPORTANT** I hope I can help - spend some hours on it now.
- the action registration must be **BEFORE** you create your nightmare instance.
- if you access for example the  property you must call the plugin after a page is loaded (means for example **AFTER** the ) - @entrptaher in your code this could be the problem how I see on the screen shot. The problem is that it fails silently because exceptions are not reported which are throwed electron side. (see below to improve this)

To this package to improve:

-  calls in ""children function"" (which run on electron children process) should be redirected also to the main process output - it's hard to debug otherwise if you don't know that  exists, also it depends on the DEBUG var - don't forget it ()
- Exceptions on electron side should be catched and redirected to the client and throwed there again with a note that it happened on electron side. Currently it crashes without infos.
- The  interface to register action is weird because of it's (name[, childFn], parentFn) signature. It must be clarified what the ""child"" and ""parent"" process are - and the optional value should be at the end - I can imagine the reason was the order, whyever - it's really more confusing. I just say:



- The API documentation has following flaws:
   - definitely missing of an overview - a simply TOC could help so much for orientation
   - document the rest of the members of the nightmare object
- I saw that  is currently on version 1.6, older than 2 years. This package has over 11k stars. No TS users here? I wrote the whole definition, very neat and complete. I will spend some time to prepare and publish it on @types if there are people who are interested for it, but if there are 12k js only users its okey.
",aight8,types
959,2017-03-27 21:50:54,">Custom actions worked if I used it after a goto, but sometimes you need actions to do before going to any url.

I think I understand what the problem is now after seeing your example.  When `Nightmare.action()` (on the prototype) is called, there's an action put on the prototypal queue to execute action methods on all created instances.  Looking at your gist, it occurs to me there might be a bug when immediately calling a plugin method.  Poking around in the unit tests for Nightmare, I don't think this particular case is tested for and is probably worth adding to at least prove out that's not the problem.

> Exceptions on electron side should be catched and redirected to the client and throwed there again with a note that it happened on electron side. Currently it crashes without infos.

This is a somewhat complicated topic.  See #646.

> ...and the optional value should be at the end - I can imagine the reason was the order, whyever...

This is because `.action()` already existed, and I wanted to have as much backwards compatibility with previous versions as possible.

> The API documentation has following flaws:

You missed a few. ;)  Kidding aside, this has been on my backburner for a long time - it's why [`nightmare-examples`](https://github.com/rosshinkley/nightmare-examples) exists.  I'd _like_ for this to all be wrapped up on github pages, but I haven't made it that far yet.

>I saw that @types/nightmare is currently on version 1.6, older than 2 years.

PR DefinitelyTyped?

> If you create custom actions, almost same kind of error happens no matter the callback.

I don't think that's true as there are a _lot_ of plugin libraries that use this.  That said, I'm _almost positive_ you've hit a bug with either how caching works in Electron and/or with how actions are created on the instance after Electron is started.



",rosshinkley,types
955,2017-01-12 05:28:51,"In a recent Nightmare script, I was consistently getting timeouts occurring and wound up writing #945 to resolve timeouts not cleaning up after themselves properly. This issue is mostly for @Mr0grog so they can debug issues on triggering frames in the said script. I made a minimal example here:

https://gist.github.com/twolfson/b666177b87ae339f3ab2183c2be77690

Things I noticed:

- Removing the `wait(100)` will cause it to start passing
- Removing 1 screenshot call will cause it to start passing
- Moving from `getbootstrap.com` to `google.com` will cause it to start passing

Best of luck on your debugging!

/cc @Mr0grog ",twolfson,Mr0grog
945,2017-01-09 10:26:16,Thanks for the feedback @Mr0grog =) I left :+1: on comments I will definitely take care of and feedback on other ones for longer discussions. I'm going to wait until repo owners leave comments until I take care of the :+1:'d comments though (saves me time with less context switching),twolfson,Mr0grog
945,2017-01-10 01:28:16,"@Mr0grog On a tangent, did we ever explore using `requestAnimationFrame` instead of trying to force a DOM redraw?",twolfson,Mr0grog
945,2017-01-10 01:30:40,"> @Mr0grog On a tangent, did we ever explore using requestAnimationFrame instead of trying to force a DOM redraw?

Yes. It turned out not to trigger anything—it only schedules things for the next time a frame is prepared (before drawing).",Mr0grog,Mr0grog
945,2017-03-23 16:57:10,"@cscanlin I don’t think anybody who has commented here has any commit rights, so I dunno. It doesn’t seem like there should be any roadblocks here and I would *think* this should be high priority since it’s really easy to trigger it and hang Nightmare.

_Paging @rosshinkley…_",Mr0grog,rosshinkley
944,2017-01-06 04:48:06,"@anthnyprschka the return of document.querySelector and document.querySelectorAll are not serializable.

You have to do seomthing like


recommended for closing @rosshinkley ",jekku,rosshinkley
942,2017-01-04 04:58:55,"I don't know why @urlysses deleted his answer, but using the css selector is a way better option than my initial answer",jekku,urlysses
942,2017-01-05 03:46:22,"like @urlysses said, you can use css3 styled selectors.


not sure why he deleted his answer.",jekku,urlysses
942,2017-01-05 03:50:46,"@jekku - @urlysses' answer would only work if the HREF attribute contained the text in question, not the text element under the anchor.  In other words, the answer - while useful - didn't address the question.

From here, @pfftdammitchris, I think you have two options off the top of my head.  One: you could use `.evaluate()` and try to issue clicks directly.  Something like:



This clicks directly on the first element that matches text in the anchor's text, in this case, `information`.  This approach doesn't _always_ work, it depends on the JS framework you're using - in your case it looks like Angular, so your mileage may vary.

Option two: add a class to the anchor you want to click, then use the existing `.click()` machinery to issue your click.  This may work better in your situation, especially if you decide you'd rather use something like [`nightmare-real-mouse`](https://www.npmjs.com/package/nightmare-real-mouse) instead of the internal click events to Nightmare:

",rosshinkley,urlysses
937,2016-12-29 09:59:02,"Understood. In the CI containers, I think they install Xfce / X server - something that has display capabilities. Try installing them to the shell OS and then run the nightmare script. This is called 'headless running'

You can also check:

https://github.com/segmentio/nightmare/issues/224

I suggest this issue to be closed @rosshinkley ",jekku,rosshinkley
922,2016-12-19 11:15:11,"I will try with `DEBUG=nightmare*,electron*`.
I already tried setting a random partition name for each instance (following @Mr0grog advice here : https://github.com/segmentio/nightmare/issues/493#issuecomment-265684086)
But it doesn't change anything. 
I come back to you by the end of the week ! Thanks @rosshinkley 
",GautierT,Mr0grog
902,2016-12-07 08:08:09,@reinpk @rosshinkley the failing test comes from a different feature.,jekku,rosshinkley
887,2016-12-28 01:57:28,"I'd also like to be able to access the webContents of the BrowserWindow instance if this is possible? I need it for the same purpose as @zatziky (simulating real keyboard inputs).

And also simulating real pasting (but this also requires access to electron clipboard object):


**Edit:** Ahh, thank you @rosshinkley - I thought `.action()` only allowed javascript evaluation, but taking a proper look at the documentation I see that @zatziky and I should be able to do something like this:

(Haven't tested yet, based it on an example in #379 - thanks @shadowmint!)

**Edit 2:** Hmm, not working. Can anyone spot where I've went wrong? Will update this comment if I find the correct way to do this. I've also tried adding a `setTimeout` with a `keyUp` in it after the `keyDown`, but that doesn't seem to work either.

**Edit 3:** Fixed! Turns out you need to focus a window before you can `sendInputEvent` - so I've added it to the code above (my window wasn't focused because dev tools opens up after it). Reported  this need for `focus` to the [electron repo](https://github.com/electron/electron/issues/8299). Also added `keyUp` after the `keyDown` (in my actual code I put the `keyUp` in an 50ms `setTimeout` to hopefully make the simulation more accurate).",josephrocca,shadowmint
865,2017-01-02 17:37:00,"Yeah I fixed whole merging ;)

On Mon, Jan 2, 2017 at 2:25 AM Rico Sta. Cruz <notifications@github.com>
wrote:

> *@rstacruz* commented on this pull request.
>
>
>
>
> ------------------------------
>
>
>
>
> In Readme.md
> <https://github.com/segmentio/nightmare/pull/865#pullrequestreview-14833628>
> :
>
>
> > @@ -30,16 +30,13 @@ Many thanks to [@matthewmueller](https://github.com/matthewmueller) and [@rosshi
>
>  Let's search on Yahoo:
>
>
>
> oops, haha, this needs to change too
>
>
>
>
> ------------------------------
>
>
>
>
> In Readme.md
> <https://github.com/segmentio/nightmare/pull/865#pullrequestreview-14833628>
> :
>
>
> > @@ -30,16 +30,13 @@ Many thanks to [@matthewmueller](https://github.com/matthewmueller) and [@rosshi
>
>  Let's search on Yahoo:
>
>
>
> but i think someone already edited that
>
>
>
>
> —
> You are receiving this because you modified the open/close state.
> Reply to this email directly, view it on GitHub
> <https://github.com/segmentio/nightmare/pull/865#pullrequestreview-14833628>,
> or mute the thread
> <https://github.com/notifications/unsubscribe-auth/AAoMcSpFOqLKtAFCKH5favWMdstoVwpqks5rONC1gaJpZM4Kmveu>
> .
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
",reinpk,matthewmueller
865,2017-01-02 17:37:00,"Yeah I fixed whole merging ;)

On Mon, Jan 2, 2017 at 2:25 AM Rico Sta. Cruz <notifications@github.com>
wrote:

> *@rstacruz* commented on this pull request.
>
>
>
>
> ------------------------------
>
>
>
>
> In Readme.md
> <https://github.com/segmentio/nightmare/pull/865#pullrequestreview-14833628>
> :
>
>
> > @@ -30,16 +30,13 @@ Many thanks to [@matthewmueller](https://github.com/matthewmueller) and [@rosshi
>
>  Let's search on Yahoo:
>
>
>
> oops, haha, this needs to change too
>
>
>
>
> ------------------------------
>
>
>
>
> In Readme.md
> <https://github.com/segmentio/nightmare/pull/865#pullrequestreview-14833628>
> :
>
>
> > @@ -30,16 +30,13 @@ Many thanks to [@matthewmueller](https://github.com/matthewmueller) and [@rosshi
>
>  Let's search on Yahoo:
>
>
>
> but i think someone already edited that
>
>
>
>
> —
> You are receiving this because you modified the open/close state.
> Reply to this email directly, view it on GitHub
> <https://github.com/segmentio/nightmare/pull/865#pullrequestreview-14833628>,
> or mute the thread
> <https://github.com/notifications/unsubscribe-auth/AAoMcSpFOqLKtAFCKH5favWMdstoVwpqks5rONC1gaJpZM4Kmveu>
> .
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
",reinpk,rosshi
844,2016-10-21 13:17:10,"@rosshinkley please how to run nightmare by pm2 or something like that on the server because nightmare use the electron and electron need graphic now i'm using `xvfb-run npm start` but this sol° needs that i stay connected by ssh to the server have you any suggest?
",neutron92,rosshinkley
836,2016-10-20 03:28:37,"I [found the original conversation](https://gitter.im/rosshinkley/nightmare?at=574b580aa78d5a256e38f3cd), and I _thought_ there was an outline on logs/testing for verifying that was the problem, but it's not jumping out at me.

The dyno sizes don't affect the size of shared memory - that setting is locked by Heroku.  Furthermore, memory serving, you don't have root access to change the shared memory partition.  

Re confirming the issue, you might be able to get away with using something like [`df`](http://man7.org/linux/man-pages/man1/df.1.html) to look at `/dev/shm` usage while your script is running.  (Something like `watch ""df | grep /dev/shm""` or `watch ""df -h | grep /dev/shm""`, maybe?)  I _think_ that's doable with `heroku run bash` on a one-off dyno, but my experience with Heroku is limited.

/cc @rickmed - any light to shed on this topic?
",rosshinkley,rickmed
815,2016-10-14 14:41:57,"@rosshinkley what's the state of this PR? 

Do you plan to merge it or you are afraid it will be breaking change?
",ligaz,rosshinkley
784,2017-02-10 03:50:30,"For what it's worth, you could also capture it from preload using something like (from @nickstanish):

",rosshinkley,nickstanish
783,2016-09-07 08:08:31,"Hello @reinpk ,
I am the member of [cdnjs](https://github.com/cdnjs/cdnjs) project.
We want to host this library.
But there is a question want to ask.
I want to confirm which file is needed to be grab.
I think the main file is `lib/nightmare.js` on [npm](https://www.npmjs.com/package/nightmare).
And are there any other dependency file also needed under `lib/` on npm?
Please help me confirm that.
Thanks for your help!

https://github.com/cdnjs/cdnjs/issues/8570
",kennynaoh,reinpk
780,2016-09-13 17:20:10,"Hi @rosshinkley,

Can you help me on this? I'm receiving the method `cssLookup` is not defined and I'm pretty sure I'm missing something obvious. An outside eye could help me a  lot.
",gjmveloso,rosshinkley
762,2016-10-04 16:32:46,"I did some digging with Chrome/Electron specifically: if you remove the active element from the DOM, the active element will point to the `body`.  The only way to get the active element to refer to null (at least in my experimentation) is to delete the `body` from the `html` tag.  (I sincerely doubt you're doing that.)

@willclarktech pointed out in [this issue](https://github.com/willclarktech/elm-boilerplate/issues/3) that the element could be removed between `.type()`/`.insert()` and `.blur()`, which would cause a similar problem, but those are getting the specific selectors, not the (somewhat nonspecific) active element.
",rosshinkley,willclarktech
747,2016-08-03 00:42:53,"@rosshinkley Whatever you did in https://github.com/segmentio/nightmare/pull/653/commits/03f43fc0b63640d1d05f46434545fcb82c9b2c6a seems to have stopped working for Node 6 :(
(must be that libnotify no longer depends on Node 6?)

Would it be better to `nvm install` in the `pre` scripts?
",Mr0grog,rosshinkley
737,2016-07-29 01:28:19,"Thanks @johnferro. An internal chain of steps worked, but it doesn't seem right (`wait` won't be queued etc):



Hopefully @rosshinkley or someone with a better understanding of Nightmare can confirm the validity and object disposal.
",voidmonk,rosshinkley
729,2016-07-18 12:19:54,"Hi there! Apologies if this is the wrong place to put this, wasn't sure whether to do so here (due to the README) or segmentio/nightmarejs.org (where the site code lives).

I use Nightmare lots and it's the first thing I recommend to journalists wanting a resilient tool for scraping poorly-built websites. That said, the documentation tends to throw people — the syntax on nightmarejs.org uses generators while the README is functional. Regardless, it's honestly one of the best browser automation tools out there at the moment and I feel it could achieve a wider audience if the documentation was improved a bit.

Any chance you'd be interested in me helping to improve the documentation website? I'd add a bunch more examples covering a wider selection of use cases, allow the examples to be displayed using callbacks, generator, or await/async syntax and pull the doc comments into an online documentation viewer (or, in cases where the README is more detailed than the doc comments, open PRs migrating those into the codebase). I'd also try to migrate in some of @rosshinkley's excellent examples/documentation (which I just noticed and is somewhat buried in the README). I'm anticipating a 2-3 month timeline for such a project.

Thanks!
",aendrew,rosshinkley
729,2017-03-17 11:07:09,"or at least put the link for the @rosshinkley's examples into the official readme: 
https://github.com/rosshinkley/nightmare-examples

it would have saved me few headaches :)",vagnerj,rosshinkley
710,2016-07-08 17:43:23,"@diverse-soles Out of curiosity, what library were you using?
",rosshinkley,diverse-soles
677,2016-07-26 22:57:35,"It would be ideal to add the timeout duration as a attribute.

Kind Regards

_Kyle Welsby - MeKyle Ltd_

mobile: +44 (0) 7575 790 552
email: kyle@mekyle.com
twitter: @halfcube http://twitter.com/halfcube
site: mekyle.com
skype: halfcubeuk

On 26 July 2016 at 22:32, coyotte508 notifications@github.com wrote:

> Well this introduces problems when the page doesn't expect things to be
> typed instantly (like when filling card expiry in paypal's interface)
> 
> —
> You are receiving this because you authored the thread.
> Reply to this email directly, view it on GitHub
> https://github.com/segmentio/nightmare/pull/677#issuecomment-235410621,
> or mute the thread
> https://github.com/notifications/unsubscribe-auth/AAGvhWWCHRYdiNqa8zcTzRg4gowRh-ZJks5qZnzYgaJpZM4IxDTl
> .
",kylewelsby,halfcube
658,2016-05-23 19:12:26,"Fixes #350:  Ensures extra event listeners are removed when done/error is called, also allows for >1 log event per `javascript` call.

All credit should go to @s0m3on3 for the original fix.

(Also, I _thought_ this had already been submitted, but I can't find the original.)
",rosshinkley,s0m3on3
656,2016-05-22 16:03:51,"Thank you Ross, You are genius. At moment, everything is OK.
BTW, this is my Repo using nightmare.js https://github.com/kuyoonjo/google-auto-oauth2

On May 22, 2016, at 4:50 PM, Ross Hinkley <notifications@github.com<mailto:notifications@github.com>> wrote:

@kuyoonjohttps://github.com/kuyoonjo also, if you have a more complete example, I'd like to see it. I might be able to help more that way.

—
You are receiving this because you were mentioned.
Reply to this email directly or view it on GitHubhttps://github.com/segmentio/nightmare/issues/656#issuecomment-220839559
",kuyoonjo,kuyoonjohttps
650,2016-05-20 01:16:05,"@Mr0grog @rosshinkley,

Thanks for encouraging me to contribute.  I hope I got it right this time.  I closed #643 and created this one based on the latest.

Let me know if I did it wrong or if you have questions.
Olivier
",oliviervaillancourt,rosshinkley
650,2016-05-20 01:16:05,"@Mr0grog @rosshinkley,

Thanks for encouraging me to contribute.  I hope I got it right this time.  I closed #643 and created this one based on the latest.

Let me know if I did it wrong or if you have questions.
Olivier
",oliviervaillancourt,Mr0grog
650,2016-05-20 15:28:18,"@oliviervaillancourt Part one looks great, thanks for fixing that.  Part two I'd _probably_ leave as simply `example.js`.  The example is in the root of the project directory and is (I think) fairly obvious which example we're referring to.  The only remaining thing I can think of is possibly changing the README to say `example.js` instead of `yahoo.js` under the Examples heading on line 55 (which isn't your fault, I think it's been that way for quite a while).

@Mr0grog Thoughts?
",rosshinkley,Mr0grog
645,2016-05-18 16:40:15,"Fixes #642.

Ultimately, I think it would be better to reject with an instance of `TypeError` (with the same message), but that requires properly serializing and deserializing errors over IPC, which is a non-trivial task (would love to hear your thoughts on this, @rosshinkley). I wanted to get the immediate problem solved first.
",Mr0grog,rosshinkley
641,2016-05-18 13:09:52,"Ping @Mr0grog 😃 
",albinekb,Mr0grog
640,2016-05-17 00:12:44,"This helps to alleviate the problems noted in #612 (and hinted at in other issues as well), but does not solve the core problem (deadlocking on a disk cache shared between Electron processes).

This turned out to require a much bigger change than one might expect—Nightmare checks whether the window is ready to receive actions (i.e. whether it is loading) between every action, but since we can now be in a state where we are ok to continue but loading is still going on, we have to track for ourselves whether is OK to perform the next action instead of simply asking Electron whether resources are loading. This is accomplished by way of a method named `isReady()` that returns a boolean and `setIsReady(newValue)` that takes a boolean and fires an event on the `BrowserWindow` instance called `did-change-is-ready`.

The actual timeout value can be customized at construction time (via an option called `gotoTimeout`, analagous to `waitTimeout`) and at method time with a third argument `goto(url, headers, timeout)`.

@rosshinkley I’m not 100% providing _both_ those methods for overriding is best—maybe it should just follow the example of `wait` and only support the constructor option?

I also wonder if, based on this, certain actions should be exempted from the `continue` check (e.g. `goto`, `viewport`, `wait(number)`), since it’s not really relevant for everything. I think that’s definitely out of scope for this PR, though.
",Mr0grog,rosshinkley
632,2016-06-07 09:45:28,"ping @rosshinkley @matthewmueller 
",albinekb,matthewmueller
622,2016-05-05 18:43:03,"Arising from a conversation over #595, there should be a better test beyond mere construction for `switches`.  One possibility that @Mr0grog suggested is a test-only plugin that hooks into the Electron machinery to ensure the switches are set.
",rosshinkley,Mr0grog
619,2016-05-19 01:15:58,"> Given that it seems to be causing enough problems, I'd be open to moving it into core. Thoughts?

Well, it sounds like there are either some bugs with it or it is not solving the problem: https://github.com/segmentio/nightmare/issues/639#issuecomment-219953581 It needs feedback from @timotgl or I or someone should do some testing w/ React. I wouldn’t want to change this part of core if it doesn’t actually solve the issues people are encountering.

It also might be worth postponing to v3—it won’t work on elements that aren’t being displayed (the current implementation does) and it will work differently than the current implementation on elements with children or that are obscured/overlapped by other elements (the events will go to the element at the click location, not necessarily to the element identified by the selector). Most of the time this should be a non-issue, but it’ll almost certainly bite someone.
",Mr0grog,timotgl
612,2016-05-11 00:24:43,"More diggin’: I believe the issue is related to caching/sessions/user data:
- I occasionally get the exact same crash in Chromium’s disk cache backend creating an entry when running this (specifically, in `disk_cache::BackendImpl::CreateEntryImpl`) and
- The hanging requests appear to be exclusively requests Chromium is attempting to serve from cache. 

Treehouse happens to use ETags and set relatively long expire headers, which may be causing/exacerbating the issue.

I’m going to guess (based on very little data) that this is probably a result of so many separate Electron processes using the same persistent (disk-based) session by virtue of their sessions having the same name (the default session) and sharing the same user data directory. @inversion suspected something along these lines quite a while back, too: https://github.com/segmentio/nightmare/issues/238#issuecomment-155024950 So:
1. I still think the above approach (timeout, succeed w/ DOM ready) is a good practice regardless and it will alleviate the symptoms of this issue, so I will see about writing a PR for it.
2. Eventually moving to a 1 electron process, N browser windows model will probably alleviate this.
3. Other methods for “fixing” the problem include randomizing the partition name (or keeping it in memory) or randomizing the user data directory (only do those if they aren’t explicitly specified by the user).

I’m a little hesitant on (3) since it changes caching drastically and I don’t really have _hard_ evidence of the problem. _If_ we did some version of it, I think I’d go for in-memory partitions unless the user specifies a partition name. I think (?) (2) is still probably something we want to do—in which case, I think that’s the best long term solution.
",Mr0grog,inversion
602,2016-04-26 20:49:15,"> xvfb is installed and the newest version

Is it running? _Generally_ you want to start Xvfb as a daemon process. Alternatively, you can `xvfb-run [xvfb args] node your-nightmare-script.js`

Additionally, if you don’t have a system well-configured for running headlessly, there are a bunch of other things you’ll want to ensure are configured and running properly. Check out the scripts in `nightmare/test` or bug @rosshinkley over on Gitter for more—he knows the ins-and-outs of the headless Linux issues much better than I.

Note also, if you are on Node v4+ (which is kind of a requirement now…?) you don’t need the `--harmony` flag anymore. (Though using it doesn’t hurt anything.)
",Mr0grog,rosshinkley
599,2016-04-25 21:41:01,"A quick note on this: getting the versions for Electron/Chromium requires running Electron, so this either needs to be an async call or it will be a potentially slow, blocking call (the first time; we can cache it after that). Any thoughts on which approach is better, @rosshinkley?
",Mr0grog,rosshinkley
596,2016-04-25 14:44:55,"For the double size: this has to do with high-resolution display.  Viewport dimensions are in browser pixels, not device pixels (thanks to @Mr0grog for pointing out the difference).  For more information, read  [the bottom of #498](https://github.com/segmentio/nightmare/issues/498#issuecomment-189156529).

For the proportional scaling, I'm not sure.  It might be symptoms of the same quirk.
",rosshinkley,Mr0grog
589,2016-04-22 17:20:39,"This is one of several issues @fr- noted in #282. It is also important because the registered listener could cause the Nightmare instance to be retained even if there are no other references to it, which means instances can never be garbage collected.

This also removes the uncaught exception listener on the parent process, as mentioned in https://github.com/segmentio/nightmare/issues/586#issuecomment-212681749.

Finally, ensure the instance gets marked as ended even if the child process connection has already died (e.g. it crashed).

Other notes:
- This adds a “private” variable to nightmare instances named `_endNow`. I’d like not to do that, but nightmare already stores several private variables this way and I didn’t want to either totally rearrange the code by bringing `run` inside a closure or introduce a whole new pattern of using `WeakMap` to store references to private data.
- This still installs lots of listeners (the primary issue at hand in #282). It slightly reduces the trouble by cleaning up listeners when an instance is done with, but it’s not perfect. Another approach would be to have a central registry of instances that handles telling each of them to end when relevant process events happen, which would mean we only add one listener per event instead of one per event per instance. If we move to a single electron process model, we’ll probably have to have that central registry to do other things anyway.
",Mr0grog,fr-
586,2016-04-20 17:56:46,"This came up in #558, and I'll quote @Mr0grog:

> So… it would be a very bad idea not to exit the process at this point. Electron’s underlying IPC machinery is now in a bad state, so further communication between the your node.js process and the “browser” is not reliable.

I'm wondering now is if instead of exiting, the Nightmare instance should be put into an error state where any further calls would cause exceptions as the IPC parts are no longer reliable.

All of that being said: uncaught exceptions are bad.  Why not add handling for the exception?
",rosshinkley,Mr0grog
579,2016-04-18 03:23:57,"This addresses one aspect of #493. It should make IPC between the user’s process and the Electron process a) “safe” in that simultaneous calls can’t cause incorrect results and b) simpler. It’s based on discussion with @rosshinkley in issue #493.

The main idea here is that Nightmare’s IPC objects gain two methods, each to be used in opposite processes:
- `ipc.respondTo(name, responder)` Registers a function that can respond to calls from another process. The `name` is a handle by which other processes call it. The responder takes any number of arguments, where the last one is a callback. This callback should be called when the responder’s work is complete. Any arguments will be passed back to the caller in the other process. In addition, the callback has a method named `progress` that can be called to emit `data` events in the other process.
  
  
- `ipc.call(name, [arg, [arg, [...]]], [callback])` Calls a responder with the given `name` in another process. Any arguments between the `name` and `callback` are passed as arguments to the responder. The callback will be called when the responder’s work is finished. In addition, this returns an event emitter than can be used to handle `data` events indicating progress from the responder or a single `end` event, which will be called with the same arguments as and immediately prior to `callback`.
  
  

Under the hood this is accomplished by having three special IPC messages:
- `CALL` indicates that a responder should be called. Sent from the parent, to the child. It has at least 2 arguments:
  1. A unique ID identifying the call. This is used to ensure responses don’t get tied up with other calls to the same responder.
  2. The name of the responder to call
  3. Arguments to pass to the responder.
- `CALL_DATA_{ID}` indicates progress data related to a call is being sent. Sent from the child to the parent. The ID in the name is the unique ID that was sent with the initial call above.
- `CALL_RESULT_{ID}` indicates that this is the final result of the call. Sent from the child to the parent. The ID in the name is the unique ID that was sent with the initial call above.

The above set of messages can be used in either direction, but they are probably only relevant now in terms of calls from the parent to the child. Maybe worth noting: a very similar (but more heavily built out and robust) mechanism is used internally in Electron’s `remote` module. This one is more minimal and light-weight, but sacrifices a lot of nice features that one has (support for circular references, complex types like dates, functions, promises, errors, and placeholder objects instead of string names).
## Notes and open questions
1. This doesn’t convert all calls yet. It just does `evaluate_now` and `useragent` as demo cases. A later commit will have to do the rest.
2. In implementing this, I noticed that we can wind up with multiple IPC objects for a single process. It doesn’t actively cause problems, but depending on the order things are registered in, it could, so I made sure there could only be one IPC instance per process.
3. This implementation differs slightly from the initial proposal in #493—it is intended to be backwards-compatible (so it doesn’t break plugins). I’m not sure if that a virtue or unnecessary, since plugins that can run in the Electron process are pretty new. The method names are also slightly different; I thought these were clearer.
4. The progress capability is neat, but it incurs a lot of additional complexity and I’m not sure how much real value it adds. No existing actions use anything like it. The situations where it would be useful might be just as well handled with more judicious debug messages, error throwing, or simple events. We could easily remove the progress support and add it again later.
   - If we keep it, should be a stream instead of a simple emitter? Like the progress capability itself, its benefits are primarily theoretical and it probably comes with a more complex implementation.
5. This implementation sits atop the existing `ipc.emit()` and `ipc.on()` methods. That means the special `CALL*` messages can be pretty easily observed. I’m not sure that’s a big deal, but we could call the appropriate methods on the `process` instead to make intercepting things harder.
6. My initial implementation relied heavily on the spread operator, which made things much simpler. However, spread isn’t available in Node v4.x without the `--harmony` flag (it’s 👍 in v5.x), so I removed it in favor of lots of `apply()` calls.
   - `--harmony` is still mentioned in the README (only down at the bottom), but not actually required in practice on Node 4+. I think it’s good that it’s not required.
   - In hindsight, a lot of the `apply()` noise (not all) could be avoided by just sending arguments as an array through IPC instead of spreading them into the message arguments.
7. Some action implementations in the Electron process will get more complex (only slightly) because of this. Several actions are fire-and-forget, but in this implementation, they _have_ to call a callback. Because arguments are so dynamic in Nightmare, I can’t think of a good way to detect whether an action (on the Electron side) actually uses the callback. Probably not a big deal, but I just wanted to call it out.
8. You only get to have one responder for a given name. I think that’s reasonable (what would you do with more??), but not sure if it’s worth adding some logging or throw errors if `respondTo` is called with the same `name` more than once.
9. There’s no way to unregister a responder. I’m not sure we need it, but maybe?

I’d love feedback from anybody on this. Ideally this is a safe, backwards-compatible change (see (3) above), but it’s still a major (and deep) API change. We should be more 👍 than ¯\_(ツ)_/¯ in order to accept it.
",Mr0grog,rosshinkley
575,2016-04-15 16:52:24,"This is spawned from discussion on #501. @rosshinkley notes:

> `.run()` is really intended for internal use and usage isn't directly supported. Should it be?
1. `run` is not documented, it’s not the “official” API, and nothing internal ever calls it except `end`, which could just as easily call `then` instead. If `run` isn’t intended for external usage, it should be removed (or at least deprecated by logging warnings to the console when called until v3 is released).
2. On the other hand, even though it’s not documented, “official,” or public, I get the impression that it _is_ widely used. It comes up in issues a lot. Does that mean it should _become_ documented and official?

I can see a lot of value in simply canonizing a thing lots of people seem to be using. That said I personally like a smaller API surface, so I think I lean towards deprecating `run`. In the end, though, I’m not sure I have a real horse in the race here. I’d love to hear others’ thoughts.
",Mr0grog,rosshinkley
571,2016-04-23 23:04:12,"@mxmz- Are you still having this issue?
",rosshinkley,mxmz-
571,2016-08-08 16:53:23,"@mxmz- Did you get this resolved?
",rosshinkley,mxmz-
571,2016-08-08 17:02:44,"Hey Ross, I didnt get that resolved at the time and now do not work on the
project anymore. But if no-one else is having it maybe it can be closed for
now

On Monday, 8 August 2016, Ross Hinkley notifications@github.com wrote:

> @mxmz- https://github.com/mxmz- Did you get this resolved?
> 
> —
> You are receiving this because you were mentioned.
> Reply to this email directly, view it on GitHub
> https://github.com/segmentio/nightmare/issues/571#issuecomment-238298838,
> or mute the thread
> https://github.com/notifications/unsubscribe-auth/AHXcH4ynizSaTOnj_XSSgJHQ8AhHUZRtks5qd18IgaJpZM4IIE-W
> .

## 

Maksim Luzik
+358 50 574 8025
maksim.luzik@gmail.com
",maksimluzik,mxmz-
565,2016-04-12 22:01:21,"Changes the makefile to run tests under an `xfvb` wrapper called `bb-xvfb` under one or more the following conditions:
- `make test` is executed on CircleCI.
- `make test` is executed on a box where `xvfb` is running.
- `make test` is executed in an environment where the `HEADLESS` variable is set and not equal to `1`.

(Disclaimer: my ability with GNU Make is pitiful, any pointers on how to make the Makefile better would be appreciated.)

The wrapper enforces starting `xvfb`, waiting for an X server to be ready, followed by starting `dbus` for IPC messaging, followed by your command.  In the case of `make test`, the unit tests are executed.

The original problem is explained in [Chromium bug 309093](https://bugs.chromium.org/p/chromium/issues/detail?id=309093), and I found that the [Protractor](http://angular.github.io/protractor/#/) project (an Angular test automation suite that uses a Chrome WebDriver to run tests) already had hit this problem.  The scripts used are ~~plagiarised~~ borrowed from [angular/protractor#2419](https://github.com/angular/protractor/issues/2419#issuecomment-156527809).  (Thanks to @tullmann for providing the fix.)

This PR should fix #561.

Thoughts?
",rosshinkley,tullmann
564,2016-05-20 09:03:15,"Hi @misbach. Not yet, no, but in my other issue (#612) @rosshinkley and @Mr0grog seemed to be onto something and there is a pull request (#640) that might solve this.
",JWMarchant,Mr0grog
554,2016-04-11 14:44:51,"I'm not a committer, so that's above my pay grade. @matthewmueller’s your man (or maybe @rosshinkley; it seems like he might have the commit bit now and is much more active).
",Mr0grog,matthewmueller
554,2016-04-11 14:44:51,"I'm not a committer, so that's above my pay grade. @matthewmueller’s your man (or maybe @rosshinkley; it seems like he might have the commit bit now and is much more active).
",Mr0grog,rosshinkley
546,2016-04-09 10:17:01,"@rosshinkley @Mr0grog your explanations are very helpful but you confuse `t.end()` and `window.end()`. I won't check your code snippets but this works, @wcjohnson11 :


",kuraga,wcjohnson11
544,2016-03-24 23:36:36,"- [ ] @reinpk 
- [ ] @matthewmueller
- [ ] @rosshinkley 

This works very similar to the screenshot or pdf actions, except it saves the page as html to disk. Its a pretty straight forward pass through to the corresponding electron api.
",justinmchase,reinpk
544,2016-03-24 23:36:36,"- [ ] @reinpk 
- [ ] @matthewmueller
- [ ] @rosshinkley 

This works very similar to the screenshot or pdf actions, except it saves the page as html to disk. Its a pretty straight forward pass through to the corresponding electron api.
",justinmchase,matthewmueller
544,2016-03-24 23:36:36,"- [ ] @reinpk 
- [ ] @matthewmueller
- [ ] @rosshinkley 

This works very similar to the screenshot or pdf actions, except it saves the page as html to disk. Its a pretty straight forward pass through to the corresponding electron api.
",justinmchase,rosshinkley
527,2016-03-03 03:28:38,"In attempting to explain the behavior of `run` and `then` for #516, I realized the details of how Nightmare’s `then` method works means you can’t just say “works like `promise.then`.” The difference is minor and the likelihood of it tripping someone up is probably low, but it could still happen, especially given the promise-y expectations the method’s name sets up. Since `then` is now the preferred API, it should really be documented and, in doing so, the details of `then` should be made clear.

In the spirit of @rosshinkley’s comments on #491:

> I am certain it's going to come up in questions again and I wanted to have a reference to point at.

It might be helpful to understand _why_ Nightmare’s `then` method does not behave in accordance with a promise’s `then` (or any Promises/A+ compliant thenable) in order to better document it.

Specifically, _if an error occurs in the success callback that is passed as the first argument to `then` (or if that callback returns a promise that rejects), the error callback passed as the second argument to `then` will handle it instead of it bubbling up the promise chain._

Is this difference intentional? If so, what was the intent behind that decision? What was it meant to enable or prevent, if anything? If not, is this a bug to be fixed?
",Mr0grog,rosshinkley
527,2016-03-05 07:53:47,"> Looking over my original notes and sandbox, I'm not entirely sure how I got to the ""eats exceptions"" conclusion.

I’m betting that might be at least partially my fault; I think I said something to that effect in my description on #516. _In fact,_ that is exactly what I thought was happening at the time, before I sat down to really think about it when writing this very issue. The original title was “difference**s** between…” before I realized that wasn’t actually happening :P

> Is there something I'm not thinking of? More to the point, would there be a reason for Nightmare's .then() not to behave like Promise's .then()?

Not that I can think of; that’s why I raised the issue! Hopefully @matthewmueller will fill us in at some point.

> I'd prefer to err on the side of compliance over not. Thoughts?

I would generally agree. But since @matthewmueller didn’t write any docs and didn’t invite any discussion or review of the feature, I didn’t want to make an assumption about whether the non-compliant behavior was intended or just a bug. So I asked by way of this issue :)
",Mr0grog,matthewmueller
527,2016-04-18 05:04:37,"> > I'd prefer to err on the side of compliance over not. Thoughts?
> 
> I would generally agree. But since @matthewmueller didn’t write any docs and didn’t invite any discussion or review of the feature, I didn’t want to make an assumption about whether the non-compliant behavior was intended or just a bug.

Since this has sat for more than a month with no feedback from @matthewmueller , I’m going to go ahead and just transform it from a question to a statement and call it a bug:

`then()` **should** act like Promises/A+ `then()` and ES6 Promise `then()`. The second argument should not be called because of an exception while running the first argument.

If that’s cool with you, @rosshinkley. The implications are minor and, I think, an improvement.
",Mr0grog,matthewmueller
524,2016-03-01 20:08:50,"Fixes #523 (if #476 is also included).

I'm not _real_ clear on why the injection was done twice to begin with, and perhaps @reinpk could shed some light on that?

On top of fixing that, I went through every version of jQuery core to determine which work with `.inject()` and which don't.  This may help address #323.  The following versions of jQuery _are not_ injectable with Nightmare (most throw syntax errors):
- 1.0.1
- 1.0.2
- 1.0.3
- 1.0.4
- 1.1.1
- 1.1.2
- 1.1.3
- 1.11.0 beta 1 min
- 1.9.0 min
- 2.1.0 beta 1 min

Other versions seem to work with basic queries.
",rosshinkley,reinpk
495,2016-02-19 07:53:46,"I added the [`webRequest` API](https://github.com/atom/electron/blob/master/docs/api/session.md#seswebrequest) feature which is related to #461.

Please consider the way of working except name of api.

Still, I prefer to make this as a plugin like the way of @rosshinkley [made](https://github.com/rosshinkley/nightmare-load-filter).
",kyungw00k,rosshinkley
491,2016-02-17 14:59:34,"Fixes #490, addresses @Mr0grog's comments from #482.  Also removes `vo` from the CNN example based on [@matthewmueller's comment](https://github.com/segmentio/nightmare/pull/482#issuecomment-184525044).

That being said: why the move to excise `vo`?  Is it to remove the external dependency?  I still think showing an example of using `vo` or `co` with `yield` is helpful.  Thoughts?
",rosshinkley,matthewmueller
491,2016-02-17 14:59:34,"Fixes #490, addresses @Mr0grog's comments from #482.  Also removes `vo` from the CNN example based on [@matthewmueller's comment](https://github.com/segmentio/nightmare/pull/482#issuecomment-184525044).

That being said: why the move to excise `vo`?  Is it to remove the external dependency?  I still think showing an example of using `vo` or `co` with `yield` is helpful.  Thoughts?
",rosshinkley,Mr0grog
491,2016-02-17 17:45:51,"Thanks! Wasn't sure if any maintainers (is that just @matthewmueller?) were going to do anything about that since nobody replied on that thread.

My 2¢: I think it's good to have the main examples rely on as few third-party libraries (like vo) as possible—there's a surpising amount of friction added to getting started when you have to learn a second tool in order to learn the once you want to use. (Of course I'm biased: I'm not really using vo in my own work w/ Nightmare.)

That said, libraries like vo are great tools that make the async nature of this stuff a little easier in some cases. Those who don't know about them might never find out if not for the examples. I think it would be great to have a section that talks about how Nightmare pairs well with and gives examples of:
- ES-next `async/await` (maybe with a note about how to set it up with Babel?)
- Tools for generators: vo, co, Bluebird's `Promise.coroutine()`, etc.
- Mocha-generators, Jasmine-co, etc. (for testing)
",Mr0grog,matthewmueller
491,2016-02-17 23:59:25,"@rosshinkley Oh, no, you didn't zap any of my efforts at all; no worries! I held off on making any changes in that area since it sounded like @matthewmueller was making a bunch ideological changes that aren't written down anywhere, so I figured I'd wait to hear back or see what he did before _I_ tried to actually do anything more.

> Recommending using .then(), though? Always? That makes me ... uncomfortable. It's hard for me to articulate why outside of aesthetic reasons.

Well… we could focus on `run` or `end` instead. Then you have the ""callback API"" and the ""promise API."" To be honest, though, I'm not sure I have the same aesthetic concerns with `then`—I kind of like it ;)

The biggest thing I'm concerned with about moving away from generator-based examples is that several things are buggy in Nightmare if you ask it to handle multiple queues at once—and that's easy/inviting to do if you focus on the run/end/then API. See, for example, #465. On the other hand, I'd bet those issues exist because early authors focused on using generators and so rarely tripped over bugs that happen when multiple operations are going on simultaneously. But all that is a big discussion that is somewhat separate from how things are documented! So I'll shut up on that for now.

> I think adding examples for common usecases and popular libraries would be wildly helpful - something along the lines of Including an examples directory with documentation for each example.

Ooh, definitely! I think the documentation, in general, could be vastly improved. Several of the issues and questions in #472 are ones I ran into when I first started looking at Nightmare, too (I also think it would be great if all methods returned a promise or thunk—there's no reason a nightmare instance can't actually be one of those things, but that's _way_ out of scope here).

_[Rant warning:]_ Anyway, I'd _would_ love to volunteer to help with that, but… I'm personally a bit wary of diving into major changes to docs (or other changes of similar scope). There's no documentation here relating to direction or process for the project. I'm not sure whether there are people at Segment (or outside it) who are acting as maintainers other than @matthewmueller. And when he makes a sudden change in project direction and only announces that change in a comment on a random issue/PR, as happened in #482, or makes surprising API changes with nary a PR or even a comment in an issue (like making `then` act more like a promise after much discussion against or not very in favor of it in #256), or even when issues and PRs can sit for months (e.g. #222) with no maintainer feedback at all (even just a ""no thanks""), I don't have much confidence that big contributions will be well respected.

That's especially true for docs. It's hard to do a good job with them when you don't know what direction the project is headed. What parts should be focused on? What things should be downplayed because owners/contributors don't feel great about them? What's deprecated and going away? What are the known gotchas? And so on. #482, again, is a great example here: in previous issues, @matthewmueller talks about `then()` as a private API, only there to make vo behave properly. Now, with no other discussion in between, it's suddenly the primary front-and-center way to use Nightmare.

Anyway, I know you weren't necessarily asking for my help and sorry for the sudden rant there. I hate to heap on a lot of criticism when I've only been observing the goings-on here for a couple weeks. I hope there's not a mailing list or something I'm totally missing out on. It felt like it needed to be said somewhere, though.
",Mr0grog,matthewmueller
468,2016-02-09 18:05:44,"In trying to use Nightmare for doing some screen captures of highly dynamic web pages, I've discovered that the screenshots are often out-of-sync with the state of the web page being captured. After a lot of investigation, it turns out that this is actually an underlying issue in Electron—it generates a screenshot by simply copying from Chrome's backing store, which is not actually guaranteed to be up-to-date (see [Electron issue 1049](https://github.com/atom/electron/issues/1049) and [this Chromium-dev discussion](https://groups.google.com/a/chromium.org/forum/#!topic/chromium-dev/o2aUtFAIlyQ)).

I believe this is probably the underlying issue behind a few other nightmare bugs, such as: https://github.com/segmentio/nightmare/issues/33, https://github.com/segmentio/nightmare/issues/129, the long wait @rosshinkley suggests adding in his solution to https://github.com/segmentio/nightmare/issues/328

But! It turns out there is a way to address this. In Electron's `BrowserWindow.webContents`, you can call `beginFrameSubscription(callback)`, which seems (in my testing) to guarantee that the backing store is up-to-date when your callback is called. So if you changed [line 252 of `lib/runner.js`](https://github.com/segmentio/nightmare/blob/master/lib/runner.js#L252) to:



You ought to have a much more deterministic result when calling `.screenshot()`.

Unfortunately, I don't have a great reduced test case for this, but I'm more than happy to submit a patch if desired.
",Mr0grog,rosshinkley
464,2016-02-05 16:46:33,"This pull is like #84 
I creating another pull request because i deleted the oldest one(don't ask me why please).
Past the response from @reinpk 

""thanks @Max93! sorry i never got to this with v1... it looks like an interesting abstraction for other events... what events were you interested in? closing for now but may bring the idea into v2 with more info here. thanks!""

Thanks again @reinpk 
",Max93,reinpk
464,2016-02-05 16:46:33,"This pull is like #84 
I creating another pull request because i deleted the oldest one(don't ask me why please).
Past the response from @reinpk 

""thanks @Max93! sorry i never got to this with v1... it looks like an interesting abstraction for other events... what events were you interested in? closing for now but may bring the idea into v2 with more info here. thanks!""

Thanks again @reinpk 
",Max93,Max93
452,2016-01-28 05:57:57,"thanks!

@MiguelOller can you test this in your environment?
",matthewmueller,MiguelOller
425,2016-01-18 22:57:23,"@matthewmueller I went ahead and added the debug, and also went ahead and merged in the recent changes.  Special thanks to @emars for fixing the build, something I just hadn't had time to do. :)
",rosshinkley,emars
414,2016-01-28 05:47:59,"hey guys, sorry for the delay on this, i know this is not in a great state right now.

I tested out `sendInput` and it looks like `sendInput` will not work as I was hoping. it will send `input` events, but not `keydown`, `keyup` and `keypress` events. You can read more about it here: https://github.com/atom/electron/issues/3930#issuecomment-172671004

The goal is to make it as much like pressing keys as we can. Unfortunately, there's no way to send keyboard events serially, so I think the approach I will try next is:

**typing ""hi"":**



the delay will be used to mimic human typing behavior, but more importantly it should ensure that the events are done in order.

Let me know if you have anything thoughts on this otherwise I plan to fix this over the weekend.

/cc @zcbenz in case he has any other ideas :-D
",matthewmueller,zcbenz
405,2016-08-08 16:41:02,"@contra To cut out networking issues, I propped up a server locally to issue requests to (responding with plaintext), then issued 100k sequential requests to that service with a single Nightmare instance.  Nightmare did not hang.  I'm thinking about propping up a minimal HTML payload, then adding javascript and/or HTML and running requests against that to see if it's a caching issue or a memory issue or... something.  If you've got ideas, I'd love to hear them.

@LikeJasper I don't think I've ever seen `debug` behave like that... I wonder if it's interpreting a backspace or non-character escape?  If you could put together a minimum case that reproduces that behavior, I'd love to see that too.
",rosshinkley,LikeJasper
382,2015-12-23 18:29:01,"@AspireToCodeBetter TL;DR: At present, you'd have to fork Nightmare and roll your own.

There is currently work being done to add extensions to the Electron process that Nightmare wraps (#391), one of the benefits of this being the ability to attach a handler to `will-download`.  The reason this PR was ultimately closed is because there are several use-cases for `will-download`, leading me to believe they should be broken out into plugins to be used with (as of this writing, incomplete) extending Electron.

When #391 is complete, I'll see to it that the download plugins are completed and put on NPM, and  certainly post a link on this thread and possibly on a few others (#151 and #371 come to mind).
",rosshinkley,AspireToCodeBetter
375,2016-04-16 17:49:26,"@Mr0grog set me straight: it does have to do with iframes and timing.  Quote:

> If you call WebContents’s executeJavaScript() method after the main frame finishes loading, but while a subframe is loading, the JS will never get executed and the call will never complete (unless you navigate the main frame to some new page).

See electron/electron#5183 for details.
",rosshinkley,Mr0grog
374,2015-12-07 18:15:12,"This takes care of @yoz's question from PR #365 regarding `confirm` and `prompt`: by default, they will both emit their respective events and throw an exception.  This prevents unwanted behavior on the page (eg, by prompt/confirm returning default values), as well as prevents Nightmare from hanging on modal dialogs.

This also is a partial answer to my question #366.  Rather than overriding the Nightmare preload, the internal preload script can now be added to with the same `options['web-preferences'].preload` option.  This allows for overriding the above exception behavior if it is not desirable, as well as opens up user-defined preload actions should they be needed.

Thoughts?
",rosshinkley,yoz
374,2015-12-09 18:55:56,"@matthewmueller Ah, yeah, grouping them makes a lot of sense.  I'll pull that together as time permits.

As for overwriting the preload: the template-generated preload would be overwritten every time.  The template is internal to Nightmare.  As such, the internal changes to preload should be picked up if any are made.  Ultimately, what I am reaching for is the default exception behavior for prompt and confirm may be (probably is?) undesirable, and there should be a way to override it.  Maybe I'm not following what you're asking?

As for specific use cases: the only one I know of offhand is what @yoz ran into with `alert` - if you have a prompt or confirm an event that fires _before_ an `inject`/`evaluate` can run.  This gets back to overriding the default exception behavior - I'd imagine you'd want to overwrite it to handle dialogs with valid responses.  Does this make sense?
",rosshinkley,yoz
371,2015-12-05 20:16:28,"@fmaruki, @darthcloud and myself touched on this in #332.  I didn't pull together a PR because I wasn't too keen on polluting options with download rules and I was/I am _pretty_ certain my implementation and approach were not good.  Since then, I haven't set aside time to take a second (hopefully longer) look.

Adding an event handler in this way might work.  It side-steps the immediate action problem, and offloads responsibility for cleanup and multiple downloads to the user, which simplifies things.

Thoughts?
",rosshinkley,fmaruki
371,2015-12-05 20:16:28,"@fmaruki, @darthcloud and myself touched on this in #332.  I didn't pull together a PR because I wasn't too keen on polluting options with download rules and I was/I am _pretty_ certain my implementation and approach were not good.  Since then, I haven't set aside time to take a second (hopefully longer) look.

Adding an event handler in this way might work.  It side-steps the immediate action problem, and offloads responsibility for cleanup and multiple downloads to the user, which simplifies things.

Thoughts?
",rosshinkley,darthcloud
366,2015-12-04 16:53:36,"@yoz asked a good question about overriding preload functionality in #359, and as an extension, I have a question of my own: Is there a use case for adding custom parts inside of Nightmare's preload?

Preload could be a template, but I think this would require writing the compiled preload script to disk (Electron expects a file path for preload, at least in my read of the documentation).  Electron exposes the default paths for user data, and changes made in #338 allows for custom paths.  Both could be used to determine a place to save the compiled preload.

Thoughts?

_Edit:_ Bah, a second look at the mentioned PR and at Electron's documentation, I saw `.getPath(name)` almost right away.  Edited commentary.
",rosshinkley,yoz
365,2015-12-04 02:10:19,"Sets up the `page-alert` event for alerts, preventing alerts from blocking the process.  Should fix #359.  Thoughts? /cc @yoz 
",rosshinkley,yoz
363,2016-09-09 20:36:34,"Dear, @rosshinkley just wondering is there any reason for this PR's to still be awaiting merge?

Thanks you! :)
",highvoltag3,rosshinkley
360,2015-12-01 23:15:18,"Adds support for getting and setting cookies. Originally, I wanted to just export `.cookie(...)` (as discussed in #241), but electron has a lot of power to query all the cookies or query for certain cookies on urls. I didn't want to intentionally limit their API. 

I decided to use sub-properties because it's going to get messy if we have a ton of top-level methods, so instead of:



It looks like:



This should allow for more powerful namespacing for things like `sessions`, `cache`, `proxy`, etc.

---

Additionally, while putting this together, I improved error handling. If the main electron process encounters an uncaughtException, it will propagate to the node process instead of popping up an electron window and not cleaning up after itself. It's not full-proof (doesn't work for syntax errors), but those should only happen while hacking on nightmare.

/cc @reinpk 
",matthewmueller,reinpk
358,2015-12-05 10:14:09,"@matthewmueller, I think you can merge this now if you don't have any suggestions.
After making ""path"" parameter optional it became impossible to overload original ""screenshot"" function by checking parameter type as I mentioned in our discussion in #363. So I think this PR is ready to be merged.
",Kreozot,matthewmueller
353,2015-12-03 18:48:41,"thanks @atonparker !
",matthewmueller,atonparker
348,2015-12-02 17:22:49,"@drippsj For the sake of completeness, this was fixed with 2.0.8, which was released about a week ago.
",rosshinkley,drippsj
346,2015-11-18 19:30:11,"For what's worth, I hastily threw together a `rightClick` action on [my fork](https://github.com/rosshinkley/nightmare/blob/rightclick/lib/actions.js#L84-L132).  It _technically_ works, at least in my local sandboxes.  I'm not super-comfortable with issuing a PR, as I'm not sure `contextmenu` is really the correct way for client-side javascript to generate/handle right-click events.

Thoughts? /cc @reinpk 
",rosshinkley,reinpk
345,2015-11-16 00:06:54,"Ping top 3 contributors @reinpk @matthewmueller @johntitus
",alfonsomga,reinpk
345,2015-11-16 00:06:54,"Ping top 3 contributors @reinpk @matthewmueller @johntitus
",alfonsomga,matthewmueller
345,2015-11-16 00:06:54,"Ping top 3 contributors @reinpk @matthewmueller @johntitus
",alfonsomga,johntitus
334,2015-11-09 11:31:59,"Cheers @ThibWeb 
",inversion,ThibWeb
333,2015-11-05 00:47:44,"I'm happy that you made it work!

Yield is like a return that can continue after the asynchronous operation is done. There must be someone wrapping the function to call it again as a callback once the result is set, so it can continue execution.

I usually use Co for this job, a library that I learned while programming with Koa.js. Vo looks like an sophisticated alternative to Co, I still don't know what it can do better for me.

Asynchronous callbacks, promisses, thunks and generators are all intimately related. It is a complex and fun topic, that I am still trying to fully understand.

Interesting links, I was trying to find another one, but can remember where it is:
https://www.promisejs.org/generators/
http://colintoh.com/blog/staying-sane-with-asynchronous-programming-promises-and-generators
https://medium.com/@rdsubhas/es6-from-callbacks-to-promises-to-generators-87f1c0cd8f2e
",fmaruki,rdsubhas
332,2015-11-20 18:25:25,"The new will-download functionality in Electron is really interesting, in Issue #151 @fritx provided some example of using it.

Adding support for download would be important in Nightmare IMHO it's something missing in most headless browser automation solution.
",darthcloud,fritx
320,2015-10-27 19:11:10,"Wow. This would explain a lot of the inconsistencies.

I _think_ we should be good on the onload stuff since we're injecting JS at the bottom of the page, but can you think of any case where not waiting for the `onload` event could break things?

/cc @reinpk 
",matthewmueller,reinpk
309,2015-11-03 13:30:11,"I've got a feature branch that implements passing options to goto. With this you can add headers to your request. @reinpk if you think this is an appropriate pull request, let me know. Here's the branch: https://github.com/fr-/nightmare/commit/21fb1eb597ad85981333583ec7dc33098ea309e2  
",fr-,reinpk
304,2016-04-08 17:16:09,"@nicolekanderson Did you get this sorted out?  If not, have a look at [Nightmare's test suite](https://github.com/segmentio/nightmare/blob/master/test/index.js).

@miaomi Hm, the errors look like `electron-prebuilt` is either not installed or didn't install properly.  Try wiping `node_modules` and running `npm install` again.

@WMeldon It's best practice to end the Nightmare instance when you're done.  Otherwise, the child process will remain running forever and you will (rightfully) get Mocha timeouts.
",rosshinkley,nicolekanderson
298,2015-10-20 20:05:53,"personally like having the makefile for `make test`, but it's kind of frivolous for this case anyway. thoughts @reinpk ?
",matthewmueller,reinpk
295,2015-10-19 21:02:26,"You have to wrap it in `co` or `vo`



@reinpk maybe we should change this to avoid confusion
",matthewmueller,reinpk
282,2015-11-10 17:16:13,"My research: as @fr stated it's about a long test run but I believe it's related to number of tests rather than physical time (to be specific). In my case commenting one `.click(..., ...)` or `.type()` made it work without warning, but uncommenting any one of these made the warning occur again - tested many times. Adding `.wait(100)` doesn't bring the warning. What's more interesting (another bug probably), doing `.wait(100).wait(100)` hangs up.

By looking into https://github.com/segmentio/nightmare/blob/master/lib/actions.js I can see there's one common thing between `click()` and `type()` and not for `wait()` - it's a call to `this._evaluate` which can be found here: https://github.com/segmentio/nightmare/blob/master/lib/nightmare.js I can see only a call to `once` in there. Not sure what's to be cleaned here, do you have some ideas about it, @fr?
",Namek,fr
275,2015-10-10 15:53:00,"+1
@riston , any news?
@segmentio , can you help us, please?
",kuraga,segmentio
249,2015-09-25 15:59:02,"@FredXue 嗨，我哭了
",fritx,FredXue
240,2015-09-22 17:05:58,"no worries man, we were all new to this stuff at one time

1) vo uses a technique called [currying](https://medium.com/@kbrainwave/currying-in-javascript-ce6da2d324fe). Comes from functional programming, and allows you to progressively build up functions before executing. The reason this is useful is that it allows for you to easily compose pipelines together: `vo(vo(...), [vo(...), vo(...)])(done)` for example.

Truth be told, I wasn't planning on keeping `vo(...)` in here, it's just a library that I like. You can easily use nightmare in other ways, using `co`, `promises` or callback functions. What I'd like to avoid is like what's going on in the react community, where it's just expected you know ES6, JSX, React and Flux to get started on just about any documentation, so let me know if this is preventing you from understanding nightmare better.

2) Nightmare stores cookies across requests, but not across processes. This means that when your node program ends, the cookies are gone. We may add a way to load cookies, but I think it's actually more resilient to go though the login logic each time as opposed to loading temporary cookies each time. Downside of course is that it's slower and might be suspicious that you're logging into the same account many times.
",matthewmueller,kbrainwave
240,2015-09-22 17:20:22,"Thanks so much Matt. I'm happy to say that after digging way down into the
previous issues you guys have already responded to and reading over the
test material I have a working version of my script!! I'm so excited :) I'd
be happy to submit some of the learning process I went through to get up
and running if you think it would help your other novice users! Thanks
again. Dan.
On Sep 22, 2015 10:06 AM, ""Matthew Mueller"" notifications@github.com
wrote:

> no worries man, we were all new to this stuff at one time
> 
> 1) vo uses a technique called currying
> https://medium.com/@kbrainwave/currying-in-javascript-ce6da2d324fe.
> Comes from a functional programming, and allows you to progressively build
> up functions before executing. The reason this is useful is that it allows
> for you to easily compose pipelines together: vo(vo(...), [vo(...),
> vo(...)]) for example.
> 
> Truth be told, I wasn't planning on keeping vo(...) in here, it's just a
> library that I like. You can easily use nightmare in other ways, using co,
> promises or callback functions. What I'd like to avoid is like what's
> going on in the react community, where it's just expected you know ES6,
> JSX, React and Flux to get started on just about any documentation, so let
> me know if this is preventing you from understanding nightmare better.
> 
> 2) Nightmare stores cookies across requests, but not across processes.
> This means that when your node program ends, the cookies are gone. We may
> add a way to load cookies, but I think it's actually more resilient to
> build in the login logic each time as opposed to loading temporary cookie
> files every time. Downside of course is that it's slower and might be
> suspicious that you're logging into the same account many times.
> 
> —
> Reply to this email directly or view it on GitHub
> https://github.com/segmentio/nightmare/issues/240#issuecomment-142350807
> .
",kanethal,kbrainwave
224,2016-06-06 17:00:44,"This is not a nightmare issue but an electron (chromium really) issue. @rosshinkley maybe this should be closed? 

@hhsadiq I'll try to help you via stackoverflow.

EDITED: for anyone interested in the answer: http://stackoverflow.com/questions/37625327/how-to-run-nightmare-js-on-google-appengine-for-node-js/37663861#37663861
",rickmed,rosshinkley
222,2015-10-06 03:07:45,"@matthewmueller @reinpk is there an issue with the code, anything you want me to change, would be helpful to merge so I don't use my forked version in production.
",pastawoua,reinpk
220,2015-09-14 22:04:39,"![img](https://cldup.com/tabP9ckSa6.png)

^ Update description @reinpk when you have a chance :-D
",matthewmueller,reinpk
218,2015-09-14 00:30:32,"@reinpk While trying to find a way to accomplish https://github.com/segmentio/nightmare/issues/148 even though you closed it here: https://github.com/segmentio/nightmare/issues/148#issuecomment-139900939 I was reading the electron [window-open.md api documentation](https://github.com/atom/electron/blob/master/docs/api/window-open.md) and noticed that it said:

> When window.open is called to create a new window in a web page, **a new instance of BrowserWindow will be created** for the url and a proxy will be returned to window.open to let the page have limited control over it.

and thought this might cause the windows to be shown because I remember reading in [runner.js](https://github.com/segmentio/nightmare/blob/master/lib/runner.js#L33) that you hard code the options.show to false for the main instance of BrowserWindow.

Running the following code causes the spawned window to be shown for the duration of script. I left `nightmare.end();` out to exaggerate the issue.



We should probably hard code the show option within the browser-window function to false so that this doesn't happen.
",bchr02,reinpk
207,2015-08-24 20:28:49,"@sinkingshriek Thanks!  I'll downgrade a bit and see what I get.
",mattyhead,sinkingshriek
203,2016-08-04 14:18:25,"@RichardJECooke here's the summary.
- The first approach commented here doesn't work anymore with the latest versions. 
- I wrote the PR, it got rejected. 
- @rosshinkley used parts of that PR to create an improved version of the functionality as an external plug-in.

Right now, the best you can do is use @rosshinkley's https://github.com/rosshinkley/nightmare-iframe-manager. Go there and check his documentation. That's what I'm doing.

The Nightmare team (Segmentio) don't like the approach taken in the PR and the plug-in (not even Ross, the plug-in's writer). They dislike it so much that didn't wan to publish it to NPM, you have to install it from GitHub. Feel yourself hyper-warned. No warranties anywhere, use at your own risk, etc.

Given that, for non-mission critical problems (to emphasize the warnings) the plug-in works pretty good.

I use it to extract my credit card transactions in my bank's website.

---

Here's what you would do (excessively detailed):
- Create a directory for your project and enter it:


- Initiate your Node / Nightmare project with npm filling the package data:


- Install Ross's plug-in from the GitHub repo (`npm` does it automatically for you, but you probably need to have `git` installed):


- In your main project file, `require` Nightmare and the plug-in and pass the `Nightmare` object to the plug-in:


- And then you can use it. The plug-in extends Nightmare itself. So you have additional methods in your Nightmare instance. Follow the documentation:
  https://github.com/rosshinkley/nightmare-iframe-manager
",tiangolo,rosshinkley
200,2015-07-26 18:32:12,"we're starting to consider major improvements that could be made in v2 of nightmare. the proposal is to move from phantomjs to electron, and move the api to use generators.
## speed

some of the most vexing issues with nightmare (e.g. #199 and #192) _seem_ to boil down to underlying issues in phantomjs. @matthewmueller has done some experimentation with [atom/electron](https://github.com/atom/electron) and sees 2-3x speed improvements loading and getting the title of the page:

| Site | Phantom | Electron | Speedup |
| --- | --- | --- | --- |
| Google | 2064ms | 866ms | 2.4x |
| Yahoo | 4059ms | 1862ms | 2.2x |
| CNN | 8658ms | 2729ms | 3.2x |
## generators

one of nightmare's original goals was to eliminate the callback hell of raw phantomjs. with [generators](https://strongloop.com/strongblog/how-to-generators-node-js-yield-use-cases/) now on node stable, it makes sense to take the api one step closer to eliminating callbacks using generators. this should also make the execution more linear, understandable and controllable. ideally this is a solution to requests like #177, #176, #160 and #59.



---

if you have other feedback or frustrations at this deeper level, please let us know!
",reinpk,matthewmueller
200,2015-08-15 05:33:27,"Just pushed up a branch for `v2`. I could use some help finishing up some of the remaining tasks:
- [x] port over the remaining actions
- [ ] add some examples
- [x] write some tests

Unfortunately, I cannot create a PR because the commit history is completely different. I could just write on top of all the old files though.

cc/ @reinpk @amillet89 
",matthewmueller,amillet89
183,2015-05-27 18:23:20,"@t-suwa proposed this fix in #179, just creating a PR for easy merging.

I'm running into this problem on CircleCI. Their artifacts directories have extra periods in them, and this currently breaks any use of `screenshot()` when trying to save to them.
",af,t-suwa
177,2015-08-17 06:12:42,"thanks @Zirak! sorry for the delay... this pull request and others like it were influential in the work that @matthewmueller put into v2... which uses generators and an explicit `.end()` method. should solve the same problem in a slightly different way. thanks!
",reinpk,matthewmueller
176,2015-04-29 21:05:29,"As explained in #175, I extracted the `exec` method which runs the queue on already initialized Nightmare instance. I also took the liberty of removing `@api private` from `setup` and `teardownInstance`, since these methods should now be exposed for this style of working with Nightmare.

I'd also rename `teardownInstance` into `teardown`, but I decided to leave this one up to the core team.

I'd also be happy if someone could reflect this in docs (I'm not so confident about my English).

Thanks again for an awesome tool!
",inca,api
175,2015-04-29 20:58:50,"Opening an issue to explain upcoming PR.

It would be handy to be able to work with a single PhantomJS instance multiple times (queue some things, run them, do some stuff, queue some more things, run again, etc.). For example in a typical BDD-style spec someone would want to do this:



The funny thing is that it's super-easy to support this flow, all we have to do is:
- extract a method which actually runs a queue from `run` (I called it `exec`)
- make `setup` and `teardownInstance` methods public (document them, remove `@api private`)
- (optionally) rename `teardownInstance` into `teardown`

Implementing this would also solve #36 and other similar issues. Although it does not introduce control explicit flow helpers, it becomes kinda doable with explicit `exec` calls (callback pyramid can be optimized/eliminated in numerous ways).

As for automated tests (with Mocha), this solution fits the bill ideally: async tests work like a charm and you also gain a significant performance boost by instantiating PhantomJS only once per `describe` or even per entire spec.
",inca,api
173,2015-04-29 18:34:17,"@reinpk thoughts?  Error handling seems like an important feature that nightmare lacks.
",nylen,reinpk
148,2015-09-14 04:12:17,"@reinpk BrowserWindow.getAllWindows() returns an array of all the BrowserWindow object references. Surely this could be used to incorporate some sort of interaction with newly generated windows.

cc @matthewmueller
",bchr02,matthewmueller
135,2014-12-12 01:50:32,"- add documentation stating that file extension is required in `path`
- add error handling for supported file types:
  http://phantomjs.org/api/webpage/method/render.html

/cc @sperand-io @stevenmiller888 
",lambtron,sperand-io
135,2014-12-12 01:50:32,"- add documentation stating that file extension is required in `path`
- add error handling for supported file types:
  http://phantomjs.org/api/webpage/method/render.html

/cc @sperand-io @stevenmiller888 
",lambtron,stevenmiller888
133,2014-12-07 23:14:02,"lgtm! @reinpk @lambtron @stevenmiller888 
",sperand-io,reinpk
133,2014-12-07 23:14:02,"lgtm! @reinpk @lambtron @stevenmiller888 
",sperand-io,stevenmiller888
133,2014-12-07 23:14:02,"lgtm! @reinpk @lambtron @stevenmiller888 
",sperand-io,lambtron
129,2014-12-03 14:29:04,"Hello @reinpk,

I'm trying a very simple test but the result is not what I've expected.

var Nightmare = require('nightmare');
new Nightmare()
.goto('http://www.mypage.com/login')
.type('input[name=username]', 'myusername')
.type('input[name=password]', 'mypassword')
.click('input.button')
.wait()
.screenshot('test.jpg') 
.run(function(err, Nightmare){
    console.log('Done.');
});

I suppose that the generated screenshot should be of the page after login. Instead I only get the Done message and a screenshot of the login page.
I've tried using wait with selector (div from the landing page after login process) but the result is the same.
Any advice?

Thank you!
",paulsez,reinpk
123,2014-11-25 13:07:09,"Hi, @reinpk:
    I'm using nightmare do integration tests, but I find out it's really slow to do page navigation, especially when there are muliple ""click and wait"" combinations. for example, this codes here failed sometimes for timeout reason on my computer.
   By using casperjs, the same logic spend less than 15 seonds.
   Maybe it's the internal nodule:phantmjs's problem.
   Hope you can solve this problem.
   Thanks for your great work!


",ybak,reinpk
118,2014-11-16 21:50:24,"Total agreement from the folks here at [Segment](http://segment.com). @stevenmiller888 and I are going to dive into this starting this week. 
",sperand-io,stevenmiller888
118,2015-08-17 06:23:54,"fixed a while ago by the indomitable @dominicbarnes 
",reinpk,dominicbarnes
117,2014-11-12 15:20:58,"Hi @reinpk,

I'm part of casperjs team and I look at your project since months.
As you may notice, casperjs project is a little bit inactive... we don't have time to realy maitain it for now.

Imo, casperjs has some cons:
- not realy nodejs supported
- testing api / exporter is so coupled to the main/casper api
- a lot of weird behaviors

casperjs have also some pros:
- the best docs ever (realy, I contribute to a lot of projects including big frameworks like Symfony2, and casperjs has the best docs and a lot of samples)
- easy to use, easy to learn
- fast, realy fast / Selenenium
- fully tested, used by major companies
- (subjective) I like it, because I contribute to

I see that nightmare is actively maintained and I have a lot of ideas to suggest, probably to add fonctionnalities which I have on casper to nightmare.

You said the goal of nightmare is to expose only ""few"" methods, is there any chance that you change your mind on that ?

Regards,
",mickaelandrieu,reinpk
117,2014-11-26 19:47:46,"Hi @lambtron,

I think we don't need to make another testing library (casperjs'one was a mistake from his creator opinion) but maybe we can work on how to ease the use of major testing libraries (mocha/chai/jasmine/jest) with nigthmarejs.

Then specials plugins/helpers dedicated to use cases like REST consuming/testing can be developped (and I will give a hand).

Like you, I don't want a big API but many useful middlewares: if nightmare offer same features as casperjs I think we wont release after the 1.1.x anymore /c @n1k0

What do you think ?
",mickaelandrieu,n1k0
114,2014-11-10 11:13:00,"Hey,

I want to make a screenshot from a website which embeds its fonts via `@font-face`, but they're not loaded. I will set up a demonstration and post it here.

Have a great day and keep up the good work! :octocat: 
",bahlo,font-face
113,2014-11-29 18:47:37,"@dzignus what are the specific parts of the API you're missing?
",reinpk,dzignus
113,2014-11-29 22:51:42,"@dzignus if you need all the CasperJS API, the best way will be to use ... CasperJS.

Anyway, I think nightmare can provide more plugins, inspirated by CasperJS API.
",mickaelandrieu,dzignus
109,2014-11-09 23:00:15,"@reinpk :)
",sperand-io,reinpk
101,2014-11-04 23:01:06,"This PR addresses issue https://github.com/segmentio/nightmare/issues/92 and PR https://github.com/segmentio/nightmare/pull/94.

@kevva @reinpk 

I agree that it would be nice to specify the phantom binary path rather than globally installing Phantom via Homebrew or some other method.  @kevva I tested out your solution and believe I found a problem in that the `path` property in the `options` should actually be `binary`, which corresponds to the same property in the node-phantom module.  

Therefore, you would

`var phantomPath = require('phantomjs').path;`

and instantiate nightmare the same way

`new Nightmare({phantomPath: phantomPath})`

@kevva if I use your solution I will continuously get the ""phantomjs-node: You don't have 'phantomjs' installed"" error message from node-phantom.
",dtothefp,reinpk
101,2014-11-04 23:01:06,"This PR addresses issue https://github.com/segmentio/nightmare/issues/92 and PR https://github.com/segmentio/nightmare/pull/94.

@kevva @reinpk 

I agree that it would be nice to specify the phantom binary path rather than globally installing Phantom via Homebrew or some other method.  @kevva I tested out your solution and believe I found a problem in that the `path` property in the `options` should actually be `binary`, which corresponds to the same property in the node-phantom module.  

Therefore, you would

`var phantomPath = require('phantomjs').path;`

and instantiate nightmare the same way

`new Nightmare({phantomPath: phantomPath})`

@kevva if I use your solution I will continuously get the ""phantomjs-node: You don't have 'phantomjs' installed"" error message from node-phantom.
",dtothefp,kevva
95,2014-11-01 23:51:41,"split out from the other changes in #78, thanks @johntitus
",reinpk,johntitus
92,2014-11-04 23:10:25,"@kevva @reinpk  this doesn't work.  See https://github.com/segmentio/nightmare/pull/101

phantomPath: specify a different custom path to PhantomJS, default not set.
",dtothefp,reinpk
92,2014-11-04 23:10:25,"@kevva @reinpk  this doesn't work.  See https://github.com/segmentio/nightmare/pull/101

phantomPath: specify a different custom path to PhantomJS, default not set.
",dtothefp,kevva
87,2014-10-27 02:48:28,"cc @woohoowebs https://developer.mozilla.org/en-US/docs/Web/API/event.initEvent
",reinpk,woohoowebs
76,2014-10-22 06:55:16,"@execmd @fbm-static does this take on the same idea solve the use case as #62? i think it will be easier to abstract engines down the road #60, and hides the specifics of phantomjs for people who find nightmare before they ever try to use phantom :)
",reinpk,fbm-static
76,2014-10-22 06:55:16,"@execmd @fbm-static does this take on the same idea solve the use case as #62? i think it will be easier to abstract engines down the road #60, and hides the specifics of phantomjs for people who find nightmare before they ever try to use phantom :)
",reinpk,execmd
59,2014-11-29 04:06:25,"Seems like a valid use case. @reinpk Thoughts?
",lambtron,reinpk
54,2014-10-20 06:02:22,"thanks @securingsincity and @fearphage 
",reinpk,fearphage
27,2014-10-05 20:53:08,"cc @lambtron 
",reinpk,lambtron
22,2014-07-24 18:32:57,"@visionmedia what processes are still running, phantomjs processes?
",reinpk,visionmedia
15,2014-04-20 18:04:24,"I tried to fix https://github.com/segmentio/nightmare/issues/10. Not really sure if this is the right way but it's the simplest I have come up with. Basically we just run each plugin seperate and call the next function in the main queue when the given plugin is done.



Would love to hear what you think and if it makes sense to `.run()` each plugin. @reinpk
",queckezz,reinpk
7,2014-04-08 05:22:05,"good suggestions @ianstormtaylor, just released those changes, thanks!
",reinpk,ianstormtaylor
